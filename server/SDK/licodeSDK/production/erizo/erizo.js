/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 https://mths.be/utf8js v2.1.2 by @mathias */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(n,k,g){n!=Array.prototype&&n!=Object.prototype&&(n[k]=g.value)};$jscomp.getGlobal=function(n){return"undefined"!=typeof window&&window===n?n:"undefined"!=typeof global&&null!=global?global:n};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(n){return $jscomp.SYMBOL_PREFIX+(n||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var n=$jscomp.global.Symbol.iterator;n||(n=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[n]&&$jscomp.defineProperty(Array.prototype,n,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(n){var k=0;return $jscomp.iteratorPrototype(function(){return k<n.length?{done:!1,value:n[k++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(n){$jscomp.initSymbolIterator();n={next:n};n[$jscomp.global.Symbol.iterator]=function(){return this};return n};$jscomp.makeIterator=function(n){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var k=n[Symbol.iterator];return k?k.call(n):$jscomp.arrayIterator(n)};
$jscomp.polyfill=function(n,k,g,f){if(k){g=$jscomp.global;n=n.split(".");for(f=0;f<n.length-1;f++){var q=n[f];q in g||(g[q]={});g=g[q]}n=n[n.length-1];f=g[n];k=k(f);k!=f&&null!=k&&$jscomp.defineProperty(g,n,{configurable:!0,writable:!0,value:k})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(n){function k(){this.batch_=null}function g(a){return a instanceof q?a:new q(function(e,l){e(a)})}if(n&&!$jscomp.FORCE_POLYFILL_PROMISE)return n;k.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};k.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var f=$jscomp.global.setTimeout;k.prototype.asyncExecuteFunction=function(a){f(a,
0)};k.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var e=0;e<a.length;++e){var l=a[e];delete a[e];try{l()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};k.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var q=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var e=this.createResolveAndReject_();try{a(e.resolve,e.reject)}catch(l){e.reject(l)}};q.prototype.createResolveAndReject_=
function(){function a(a){return function(d){l||(l=!0,a.call(e,d))}}var e=this,l=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};q.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof q)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var e=null!=a;break a;case "function":e=!0;break a;default:e=!1}e?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};q.prototype.resolveToNonPromiseObj_=function(a){var e=
void 0;try{e=a.then}catch(l){this.reject_(l);return}"function"==typeof e?this.settleSameAsThenable_(e,a):this.fulfill_(a)};q.prototype.reject_=function(a){this.settle_(2,a)};q.prototype.fulfill_=function(a){this.settle_(1,a)};q.prototype.settle_=function(a,e){if(0!=this.state_)throw Error("Cannot settle("+a+", "+e|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=e;this.executeOnSettledCallbacks_()};q.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,e=0;e<a.length;++e)a[e].call(),a[e]=null;this.onSettledCallbacks_=null}};var h=new k;q.prototype.settleSameAsPromise_=function(a){var e=this.createResolveAndReject_();a.callWhenSettled_(e.resolve,e.reject)};q.prototype.settleSameAsThenable_=function(a,e){var l=this.createResolveAndReject_();try{a.call(e,l.resolve,l.reject)}catch(p){l.reject(p)}};q.prototype.then=function(a,e){function l(a,b){return"function"==typeof a?function(b){try{p(a(b))}catch(v){d(v)}}:b}var p,d,c=new q(function(a,
b){p=a;d=b});this.callWhenSettled_(l(a,p),l(e,d));return c};q.prototype.catch=function(a){return this.then(void 0,a)};q.prototype.callWhenSettled_=function(a,e){function l(){switch(p.state_){case 1:a(p.result_);break;case 2:e(p.result_);break;default:throw Error("Unexpected state: "+p.state_);}}var p=this;null==this.onSettledCallbacks_?h.asyncExecute(l):this.onSettledCallbacks_.push(function(){h.asyncExecute(l)})};q.resolve=g;q.reject=function(a){return new q(function(e,l){l(a)})};q.race=function(a){return new q(function(e,
l){for(var p=$jscomp.makeIterator(a),d=p.next();!d.done;d=p.next())g(d.value).callWhenSettled_(e,l)})};q.all=function(a){var e=$jscomp.makeIterator(a),l=e.next();return l.done?g([]):new q(function(a,d){function c(c){return function(d){m[c]=d;b--;0==b&&a(m)}}var m=[],b=0;do m.push(void 0),b++,g(l.value).callWhenSettled_(c(m.length-1),d),l=e.next();while(!l.done)})};return q},"es6-impl","es3");
$jscomp.executeAsyncGenerator=function(n){function k(f){return n.next(f)}function g(f){return n.throw(f)}return new Promise(function(f,q){function h(a){a.done?f(a.value):Promise.resolve(a.value).then(k,g).then(h,q)}h(n.next())})};$jscomp.inherits=function(n,k){function g(){}g.prototype=k.prototype;n.superClass_=k.prototype;n.prototype=new g;n.prototype.constructor=n;for(var f in k)if(Object.defineProperties){var q=Object.getOwnPropertyDescriptor(k,f);q&&Object.defineProperty(n,f,q)}else n[f]=k[f]};
$jscomp.arrayFromIterator=function(n){for(var k,g=[];!(k=n.next()).done;)g.push(k.value);return g};$jscomp.arrayFromIterable=function(n){return n instanceof Array?n:$jscomp.arrayFromIterator($jscomp.makeIterator(n))};$jscomp.owns=function(n,k){return Object.prototype.hasOwnProperty.call(n,k)};
$jscomp.polyfill("WeakMap",function(n){function k(a){$jscomp.owns(a,f)||$jscomp.defineProperty(a,f,{value:{}})}function g(a){var e=Object[a];e&&(Object[a]=function(a){k(a);return e(a)})}if(function(){if(!n||!Object.seal)return!1;try{var a=Object.seal({}),e=Object.seal({}),l=new n([[a,2],[e,3]]);if(2!=l.get(a)||3!=l.get(e))return!1;l.delete(a);l.set(e,4);return!l.has(a)&&4==l.get(e)}catch(p){return!1}}())return n;var f="$jscomp_hidden_"+Math.random().toString().substring(2);g("freeze");g("preventExtensions");
g("seal");var q=0,h=function(a){this.id_=(q+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)e=e.value,this.set(e[0],e[1])}};h.prototype.set=function(a,e){k(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=e;return this};h.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};h.prototype.has=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};h.prototype.delete=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return h},"es6-impl","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(n){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!n||!n.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),l=new n($jscomp.makeIterator([[a,"s"]]));if("s"!=l.get(a)||1!=l.size||l.get({x:4})||l.set({x:4},"t")!=l||2!=l.size)return!1;var p=l.entries(),d=p.next();if(d.done||d.value[0]!=a||"s"!=d.value[1])return!1;d=p.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!p.next().done?!1:!0}catch(c){return!1}}())return n;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var k=new WeakMap,g=function(a){this.data_={};this.head_=h();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)e=e.value,this.set(e[0],e[1])}};g.prototype.set=function(a,l){var e=f(this,a);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=l:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:l},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};g.prototype.delete=
function(a){a=f(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};g.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=h();this.size=0};g.prototype.has=function(a){return!!f(this,a).entry};g.prototype.get=function(a){return(a=f(this,a).entry)&&a.value};g.prototype.entries=function(){return q(this,function(a){return[a.key,
a.value]})};g.prototype.keys=function(){return q(this,function(a){return a.key})};g.prototype.values=function(){return q(this,function(a){return a.value})};g.prototype.forEach=function(a,l){for(var e=this.entries(),d;!(d=e.next()).done;)d=d.value,a.call(l,d[1],d[0],this)};g.prototype[Symbol.iterator]=g.prototype.entries;var f=function(e,l){var p=l&&typeof l;"object"==p||"function"==p?k.has(l)?p=k.get(l):(p=""+ ++a,k.set(l,p)):p="p_"+l;var d=e.data_[p];if(d&&$jscomp.owns(e.data_,p))for(e=0;e<d.length;e++){var c=
d[e];if(l!==l&&c.key!==c.key||l===c.key)return{id:p,list:d,index:e,entry:c}}return{id:p,list:d,index:-1,entry:void 0}},q=function(a,l){var e=a.head_;return $jscomp.iteratorPrototype(function(){if(e){for(;e.head!=a.head_;)e=e.previous;for(;e.next!=e.head;)return e=e.next,{done:!1,value:l(e)};e=null}return{done:!0,value:void 0}})},h=function(){var a={};return a.previous=a.next=a.head=a},a=0;return g},"es6-impl","es3");
$jscomp.iteratorFromArray=function(n,k){$jscomp.initSymbolIterator();n instanceof String&&(n+="");var g=0,f={next:function(){if(g<n.length){var q=g++;return{value:k(q,n[q]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};$jscomp.polyfill("Array.prototype.keys",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(k){return k})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(n){return n?n:function(k,g,f){var q=this.length||0;0>g&&(g=Math.max(0,q+g));if(null==f||f>q)f=q;f=Number(f);0>f&&(f=Math.max(0,q+f));for(g=Number(g||0);g<f;g++)this[g]=k;return this}},"es6-impl","es3");$jscomp.polyfill("Object.assign",function(n){return n?n:function(k,g){for(var f=1;f<arguments.length;f++){var q=arguments[f];if(q)for(var h in q)$jscomp.owns(q,h)&&(k[h]=q[h])}return k}},"es6-impl","es3");
$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6-impl","es3");$jscomp.checkStringArgs=function(n,k,g){if(null==n)throw new TypeError("The 'this' value for String.prototype."+g+" must not be null or undefined");if(k instanceof RegExp)throw new TypeError("First argument to String.prototype."+g+" must not be a regular expression");return n+""};
$jscomp.polyfill("String.prototype.startsWith",function(n){return n?n:function(k,g){var f=$jscomp.checkStringArgs(this,k,"startsWith");k+="";var q=f.length,h=k.length;g=Math.max(0,Math.min(g|0,f.length));for(var a=0;a<h&&g<q;)if(f[g++]!=k[a++])return!1;return a>=h}},"es6-impl","es3");$jscomp.findInternal=function(n,k,g){n instanceof String&&(n=String(n));for(var f=n.length,q=0;q<f;q++){var h=n[q];if(k.call(g,h,q,n))return{i:q,v:h}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(n){return n?n:function(k,g){return $jscomp.findInternal(this,k,g).v}},"es6-impl","es3");$jscomp.polyfill("Object.is",function(n){return n?n:function(k,g){return k===g?0!==k||1/k===1/g:k!==k&&g!==g}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.includes",function(n){return n?n:function(k,g){var f=this;f instanceof String&&(f=String(f));var q=f.length;for(g=g||0;g<q;g++)if(f[g]==k||Object.is(f[g],k))return!0;return!1}},"es7","es3");
$jscomp.polyfill("String.prototype.includes",function(n){return n?n:function(k,g){return-1!==$jscomp.checkStringArgs(this,k,"includes").indexOf(k,g||0)}},"es6-impl","es3");$jscomp.polyfill("String.prototype.endsWith",function(n){return n?n:function(k,g){var f=$jscomp.checkStringArgs(this,k,"endsWith");k+="";void 0===g&&(g=f.length);g=Math.max(0,Math.min(g|0,f.length));for(var q=k.length;0<q&&0<g;)if(f[--g]!=k[--q])return!1;return 0>=q}},"es6-impl","es3");
var Erizo=function(n){function k(f){if(g[f])return g[f].exports;var q=g[f]={i:f,l:!1,exports:{}};n[f].call(q.exports,q,q.exports,k);q.l=!0;return q.exports}var g={};k.m=n;k.c=g;k.d=function(f,q,h){k.o(f,q)||Object.defineProperty(f,q,{configurable:!1,enumerable:!0,get:h})};k.n=function(f){var q=f&&f.__esModule?function(){return f["default"]}:function(){return f};k.d(q,"a",q);return q};k.o=function(f,q){return Object.prototype.hasOwnProperty.call(f,q)};k.p="";return k(k.s=37)}([function(n,k,g){var f=
function(){var q="";var h=function(a){console.log.apply(console,[].concat($jscomp.arrayFromIterable(a)))};var a=function(a,c){for(var d=[],b=1;b<arguments.length;++b)d[b-1]=arguments[b];b=q;a===f.DEBUG?b+="DEBUG":a===f.TRACE?b+="TRACE":a===f.INFO?b+="INFO":a===f.WARNING?b+="WARNING":a===f.ERROR&&(b+="ERROR");d=[b+": "].concat(d);if(void 0!==f.panel){for(var b="",e=0;e<d.length;e+=1)b+=d[e];f.panel.value=f.panel.value+"\n"+b}else h.apply(f,[d])},e=function(d,c,e,b){for(var m=[],l=3;l<arguments.length;++l)m[l-
3]=arguments[l];void 0===c&&e>=f.logLevel?a.apply(null,[].concat([e,"("+d+")"],$jscomp.arrayFromIterable(m))):e>=c&&a.apply(null,[].concat([e,"("+d+")"],$jscomp.arrayFromIterable(m)))},l=function(a){this.name=a};l.prototype.setLogLevel=function(a){this.level=a};l.prototype.debug=function(a){for(var c=[],d=0;d<arguments.length;++d)c[d-0]=arguments[d];e.apply(null,[].concat([this.name,this.level,f.DEBUG],$jscomp.arrayFromIterable(c)))};l.prototype.trace=function(a){for(var c=[],d=0;d<arguments.length;++d)c[d-
0]=arguments[d];e.apply(null,[].concat([this.name,this.level,f.TRACE],$jscomp.arrayFromIterable(c)))};l.prototype.info=function(a){for(var c=[],d=0;d<arguments.length;++d)c[d-0]=arguments[d];e.apply(null,[].concat([this.name,this.level,f.INFO],$jscomp.arrayFromIterable(c)))};l.prototype.warning=function(a){for(var c=[],d=0;d<arguments.length;++d)c[d-0]=arguments[d];e.apply(null,[].concat([this.name,this.level,f.WARNING],$jscomp.arrayFromIterable(c)))};l.prototype.error=function(a){for(var c=[],d=
0;d<arguments.length;++d)c[d-0]=arguments[d];e.apply(null,[].concat([this.name,this.level,f.ERROR],$jscomp.arrayFromIterable(c)))};var p=new Map;return{logLevel:0,DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(a){var c=a;a>f.NONE?c=f.NONE:a<f.DEBUG&&(c=f.DEBUG);f.logLevel=c},setOutputFunction:function(a){h=a},setLogPrefix:function(a){q=a},module:function(a){if(p.has(a))return p.get(a);var c=new l(a);p.set(a,c);return c}}}();k.a=f},function(n,k,g){g.d(k,"b",function(){return q});
g.d(k,"c",function(){return h});g.d(k,"d",function(){return a});g.d(k,"e",function(){return l});g.d(k,"f",function(){return p});g.d(k,"a",function(){return e});var f=g(0).a.module("EventDispatcher"),q=function(){var a={},c={};a.addEventListener=function(a,b){void 0===c[a]&&(c[a]=[]);c[a].push(b)};a.removeEventListener=function(a,b){c[a]&&(b=c[a].indexOf(b),-1!==b&&c[a].splice(b,1))};a.removeAllListeners=function(){c={}};a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");for(var b=
c[a.type]||[],b=b.slice(0),d=0;d<b.length;d+=1)try{b[d](a)}catch(v){f.info("Error triggering event: "+a.type+", error: "+v)}};a.on=a.addEventListener;a.off=a.removeEventListener;a.emit=a.dispatchEvent;return a},h=function(){this.emitter=q()};h.prototype.addEventListener=function(a,c){this.emitter.addEventListener(a,c)};h.prototype.removeEventListener=function(a,c){this.emitter.removeEventListener(a,c)};h.prototype.dispatchEvent=function(a){this.emitter.dispatchEvent(a)};h.prototype.on=function(a,
c){this.addEventListener(a,c)};h.prototype.off=function(a,c){this.removeEventListener(a,c)};h.prototype.emit=function(a){this.dispatchEvent(a)};var a=function(a){var c={};c.type=a.type;return c},e=function(d){var c=a(d);c.stream=d.stream;c.connection=d.connection;c.state=d.state;c.message=d.message;c.wasAbleToConnect=d.wasAbleToConnect;return c},l=function(d){var c=a(d);c.streams=d.streams;c.message=d.message;return c},p=function(d){var c=a(d);c.stream=d.stream;c.msg=d.msg;c.origin=d.origin;c.bandwidth=
d.bandwidth;c.attrs=d.attrs;c.wasAbleToConnect=d.wasAbleToConnect;return c}},function(n,k,g){function f(q){if(q){for(var h in f.prototype)q[h]=f.prototype[h];return q}}n.exports=f;f.prototype.on=f.prototype.addEventListener=function(f,h){this._callbacks=this._callbacks||{};(this._callbacks["$"+f]=this._callbacks["$"+f]||[]).push(h);return this};f.prototype.once=function(f,h){function a(){this.off(f,a);h.apply(this,arguments)}a.fn=h;this.on(f,a);return this};f.prototype.off=f.prototype.removeListener=
f.prototype.removeAllListeners=f.prototype.removeEventListener=function(f,h){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var a=this._callbacks["$"+f];if(!a)return this;if(1==arguments.length)return delete this._callbacks["$"+f],this;for(var e,l=0;l<a.length;l++)if(e=a[l],e===h||e.fn===h){a.splice(l,1);break}0===a.length&&delete this._callbacks["$"+f];return this};f.prototype.emit=function(f){this._callbacks=this._callbacks||{};for(var h=Array(arguments.length-
1),a=this._callbacks["$"+f],e=1;e<arguments.length;e++)h[e-1]=arguments[e];if(a)for(var a=a.slice(0),e=0,l=a.length;e<l;++e)a[e].apply(this,h);return this};f.prototype.listeners=function(f){this._callbacks=this._callbacks||{};return this._callbacks["$"+f]||[]};f.prototype.hasListeners=function(f){return!!this.listeners(f).length}},function(n,k,g){function f(a,b,c){if(!b)return k.encodeBase64Packet(a,c);var d=new FileReader;d.onload=function(){k.encodePacket({type:a.type,data:d.result},b,!0,c)};return d.readAsArrayBuffer(a.data)}
function q(a,b,c){var d=Array(a.length);c=e(a.length,c);for(var m=function(a,c,e){b(c,function(b,c){d[a]=c;e(b,d)})},l=0;l<a.length;l++)m(l,a[l],c)}n=g(56);var h=g(28),a=g(58),e=g(59),l=g(60),p;"undefined"!==typeof ArrayBuffer&&(p=g(61));var d="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),c="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),m=d||c;k.protocol=3;var b=k.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},u=n(b),v={type:"error",
data:"parser error"},r=g(62);k.encodePacket=function(a,c,d,e){"function"===typeof c&&(e=c,c=!1);"function"===typeof d&&(e=d,d=null);var p=void 0===a.data?void 0:a.data.buffer||a.data;if("undefined"!==typeof ArrayBuffer&&p instanceof ArrayBuffer){if(c){d=a.data;c=new Uint8Array(d);d=new Uint8Array(1+d.byteLength);d[0]=b[a.type];for(a=0;a<c.length;a++)d[a+1]=c[a];a=e(d.buffer)}else a=k.encodeBase64Packet(a,e);return a}if("undefined"!==typeof r&&p instanceof r)return c?m?a=f(a,c,e):(c=new Uint8Array(1),
c[0]=b[a.type],a=new r([c.buffer,a.data]),a=e(a)):a=k.encodeBase64Packet(a,e),a;if(p&&p.base64)return e("b"+k.packets[a.type]+a.data.data);c=b[a.type];void 0!==a.data&&(c+=d?l.encode(String(a.data),{strict:!1}):String(a.data));return e(""+c)};k.encodeBase64Packet=function(a,b){var c="b"+k.packets[a.type];if("undefined"!==typeof r&&a.data instanceof r){var d=new FileReader;d.onload=function(){var a=d.result.split(",")[1];b(c+a)};return d.readAsDataURL(a.data)}try{var e=String.fromCharCode.apply(null,
new Uint8Array(a.data))}catch(D){a=new Uint8Array(a.data);e=Array(a.length);for(var l=0;l<a.length;l++)e[l]=a[l];e=String.fromCharCode.apply(null,e)}c+=btoa(e);return b(c)};k.decodePacket=function(b,c,d){if(void 0===b)return v;if("string"===typeof b){if("b"===b.charAt(0))return k.decodeBase64Packet(b.substr(1),c);if(d){a:{c=b;try{c=l.decode(c,{strict:!1})}catch(t){b=!1;break a}b=c}if(!1===b)return v}d=b.charAt(0);return Number(d)==d&&u[d]?1<b.length?{type:u[d],data:b.substring(1)}:{type:u[d]}:v}d=
(new Uint8Array(b))[0];b=a(b,1);r&&"blob"===c&&(b=new r([b]));return{type:u[d],data:b}};k.decodeBase64Packet=function(a,b){var c=u[a.charAt(0)];if(!p)return{type:c,data:{base64:!0,data:a.substr(1)}};a=p.decode(a.substr(1));"blob"===b&&r&&(a=new r([a]));return{type:c,data:a}};k.encodePayload=function(a,b,c){"function"===typeof b&&(c=b,b=null);var d=h(a);if(b&&d)return r&&!m?k.encodePayloadAsBlob(a,c):k.encodePayloadAsArrayBuffer(a,c);if(!a.length)return c("0:");q(a,function(a,c){k.encodePacket(a,d?
b:!1,!1,function(a){c(null,a.length+":"+a)})},function(a,b){return c(b.join(""))})};k.decodePayload=function(a,b,c){if("string"!==typeof a)return k.decodePayloadAsBinary(a,b,c);"function"===typeof b&&(c=b,b=null);if(""===a)return c(v,0,1);var d="";for(var e,l,m=0,p=a.length;m<p;m++)if(l=a.charAt(m),":"!==l)d+=l;else{if(""===d||d!=(e=Number(d)))return c(v,0,1);l=a.substr(m+1,e);if(d!=l.length)return c(v,0,1);if(l.length){d=k.decodePacket(l,b,!1);if(v.type===d.type&&v.data===d.data)return c(v,0,1);
if(!1===c(d,m+e,p))return}m+=e;d=""}if(""!==d)return c(v,0,1)};k.encodePayloadAsArrayBuffer=function(a,b){if(!a.length)return b(new ArrayBuffer(0));q(a,function(a,b){k.encodePacket(a,!0,!0,function(a){return b(null,a)})},function(a,c){a=c.reduce(function(a,b){b="string"===typeof b?b.length:b.byteLength;return a+b.toString().length+b+2},0);var d=new Uint8Array(a),e=0;c.forEach(function(a){var b="string"===typeof a;var c=a;if(b){c=new Uint8Array(a.length);for(var l=0;l<a.length;l++)c[l]=a.charCodeAt(l);
c=c.buffer}b?d[e++]=0:d[e++]=1;a=c.byteLength.toString();for(l=0;l<a.length;l++)d[e++]=parseInt(a[l]);d[e++]=255;c=new Uint8Array(c);for(l=0;l<c.length;l++)d[e++]=c[l]});return b(d.buffer)})};k.encodePayloadAsBlob=function(a,b){q(a,function(a,b){k.encodePacket(a,!0,!0,function(a){var c=new Uint8Array(1);c[0]=1;if("string"===typeof a){for(var d=new Uint8Array(a.length),e=0;e<a.length;e++)d[e]=a.charCodeAt(e);a=d.buffer;c[0]=0}for(var d=(a instanceof ArrayBuffer?a.byteLength:a.size).toString(),l=new Uint8Array(d.length+
1),e=0;e<d.length;e++)l[e]=parseInt(d[e]);l[d.length]=255;r&&(a=new r([c.buffer,l.buffer,a]),b(null,a))})},function(a,c){return b(new r(c))})};k.decodePayloadAsBinary=function(b,c,d){"function"===typeof c&&(d=c,c=null);for(var e=[];0<b.byteLength;){for(var l=new Uint8Array(b),m=0===l[0],p="",f=1;255!==l[f];f++){if(310<p.length)return d(v,0,1);p+=l[f]}b=a(b,2+p.length);p=parseInt(p);l=a(b,0,p);if(m)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(F){for(m=new Uint8Array(l),l="",f=0;f<
m.length;f++)l+=String.fromCharCode(m[f])}e.push(l);b=a(b,p)}var h=e.length;e.forEach(function(a,b){d(k.decodePacket(a,c,!0),b,h)})}},function(n,k,g){(function(f){function q(){try{var a=k.storage.debug}catch(l){}!a&&"undefined"!==typeof f&&"env"in f&&(a=f.env.DEBUG);return a}k=n.exports=g(47);k.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};k.formatArgs=function(a){var e=this.useColors;a[0]=(e?"%c":"")+this.namespace+(e?" %c":
" ")+a[0]+(e?"%c ":" ")+"+"+k.humanize(this.diff);if(e){e="color: "+this.color;a.splice(1,0,e,"color: inherit");var p=0,d=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(p++,"%c"===a&&(d=p))});a.splice(d,0,e)}};k.save=function(a){try{null==a?k.storage.removeItem("debug"):k.storage.debug=a}catch(l){}};k.load=q;k.useColors=function(){return"undefined"!==typeof window&&window.process&&"renderer"===window.process.type?!0:"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?
!1:"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};
var h=k;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var a=chrome.storage.local;else a:{try{a=window.localStorage;break a}catch(e){}a=void 0}h.storage=a;k.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
k.formatters.j=function(a){try{return JSON.stringify(a)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}};k.enable(q())}).call(k,g(20))},function(n,k){k.encode=function(g){var f="",q;for(q in g)g.hasOwnProperty(q)&&(f.length&&(f+="\x26"),f+=encodeURIComponent(q)+"\x3d"+encodeURIComponent(g[q]));return f};k.decode=function(g){var f={};g=g.split("\x26");for(var q=0,h=g.length;q<h;q++){var a=g[q].split("\x3d");f[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return f}},function(n,k){n.exports=
function(g,f){var q=function(){};q.prototype=f.prototype;g.prototype=new q;g.prototype.constructor=g}},function(n,k,g){(function(f){function q(){try{var a=k.storage.debug}catch(l){}!a&&"undefined"!==typeof f&&"env"in f&&(a=f.env.DEBUG);return a}k=n.exports=g(63);k.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};k.formatArgs=function(a){var e=this.useColors;a[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+a[0]+(e?"%c ":" ")+"+"+
k.humanize(this.diff);if(e){e="color: "+this.color;a.splice(1,0,e,"color: inherit");var p=0,d=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(p++,"%c"===a&&(d=p))});a.splice(d,0,e)}};k.save=function(a){try{null==a?k.storage.removeItem("debug"):k.storage.debug=a}catch(l){}};k.load=q;k.useColors=function(){return"undefined"!==typeof window&&window.process&&"renderer"===window.process.type?!0:"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?
!1:"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};
var h=k;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var a=chrome.storage.local;else a:{try{a=window.localStorage;break a}catch(e){}a=void 0}h.storage=a;k.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
k.formatters.j=function(a){try{return JSON.stringify(a)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}};k.enable(q())}).call(k,g(20))},function(n,k,g){var f=g(1);k.a=function(){var q=Object(f.b)({});q.url="";return q}},function(n,k,g){k.a=function(){var f={},q={};f.add=function(f,a){q[f]=a};f.get=function(f){return q[f]};f.has=function(f){return void 0!==q[f]};f.size=function(){return Object.keys(q).length};f.forEach=function(f){for(var a=Object.keys(q),e=0;e<a.length;e+=1){var l=a[e];f(q[l],
l)}};f.keys=function(){return Object.keys(q)};f.remove=function(f){delete q[f]};f.clear=function(){q={}};return f}},function(n,k,g){(function(f){var q=g(0).a.module("ConnectionHelpers"),h=function(){var a="none";"undefined"!==typeof f&&f.exports?a="fake":null!==window.navigator.userAgent.match("Firefox")?a="mozilla":null!==window.navigator.userAgent.match("Chrome")?(a="chrome-stable",null!==window.navigator.userAgent.match("Electron")&&(a="electron")):null!==window.navigator.userAgent.match("Safari")?
a="safari":null!==window.navigator.userAgent.match("AppleWebKit")&&(a="safari");return a};k.a={GetUserMedia:function(a,e,l){e=void 0===e?function(){}:e;l=void 0===l?function(){}:l;var p,d=function(a,c,d){navigator.mediaDevices.getUserMedia(a).then(c).catch(d)},c=function(a,c,d){navigator.mediaDevices.getDisplayMedia(a).then(c).catch(d)},m=function(){switch(h()){case "electron":q.debug("message: Screen sharing in Electron");p={};p.video=a.video||{};p.video.mandatory=a.video.mandatory||{};p.video.mandatory.chromeMediaSource=
"desktop";p.video.mandatory.chromeMediaSourceId=a.desktopStreamId;d(p,e,l);break;case "mozilla":q.debug("message: Screen sharing in Firefox");p={};void 0!==a.video?(p.video=a.video,p.video.mediaSource||(p.video.mediaSource="window")):p={audio:a.audio,video:{mediaSource:"window"}};d(p,e,l);break;case "chrome-stable":q.debug("message: Screen sharing in Chrome");p={};if(a.desktopStreamId)p.video=a.video||{mandatory:{}},p.video.mandatory=p.video.mandatory||{},p.video.mandatory.chromeMediaSource="desktop",
p.video.mandatory.chromeMediaSourceId=a.desktopStreamId,d(p,e,l);else{var b="okeephmleflklcdebijnponpabbmmgeo";a.extensionId&&(q.debug("message: extensionId supplied, extensionId: "+a.extensionId),b=a.extensionId);q.debug("message: Screen access on chrome stable looking for extension");try{chrome.runtime.sendMessage(b,{getStream:!0},function(b){void 0===b?(q.error("message: Access to screen denied"),l({code:"Access to screen denied"})):(b=b.streamId,void 0!==a.video.mandatory?(p.video=a.video||{mandatory:{}},
p.video.mandatory.chromeMediaSource="desktop",p.video.mandatory.chromeMediaSourceId=b):p={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b}}},d(p,e,l))})}catch(u){q.debug("message: Screensharing plugin is not accessible"),l({code:"no_plugin_present"})}}break;default:q.error("message: This browser does not support ScreenSharing")}};a.screen?a.desktopStreamId||a.extensionId?(q.debug("message: Screen access requested using GetUserMedia"),m()):(q.debug("message: Screen access requested using GetDisplayMedia"),
c(a,e,l)):"undefined"!==typeof f&&f.exports?q.error("message: Video/audio streams not supported in erizofc yet"):(q.debug("message: Calling getUserMedia, config: "+JSON.stringify(a)),d(a,e,l))},getBrowser:h}}).call(k,g(43)(n))},function(n,k,g){function f(){}function q(a){var b=""+a.type;if(k.BINARY_EVENT===a.type||k.BINARY_ACK===a.type)b+=a.attachments+"-";a.nsp&&"/"!==a.nsp&&(b+=a.nsp+",");null!=a.id&&(b+=a.id);if(null!=a.data){try{var c=JSON.stringify(a.data)}catch(r){c=!1}if(!1!==c)b+=c;else return m}l("encoded %j as %s",
a,b);return b}function h(a,c){p.removeBlobs(a,function(a){var b=p.deconstructPacket(a);a=q(b.packet);b=b.buffers;b.unshift(a);c(b)})}function a(){this.reconstructor=null}function e(a){this.reconPack=a;this.buffers=[]}var l=g(4)("socket.io-parser");n=g(2);var p=g(48),d=g(22),c=g(23);k.protocol=4;k.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");k.CONNECT=0;k.DISCONNECT=1;k.EVENT=2;k.ACK=3;k.ERROR=4;k.BINARY_EVENT=5;k.BINARY_ACK=6;k.Encoder=f;k.Decoder=a;var m=k.ERROR+
'"encode error"';f.prototype.encode=function(a,c){l("encoding packet %j",a);k.BINARY_EVENT===a.type||k.BINARY_ACK===a.type?h(a,c):(a=q(a),c([a]))};n(a.prototype);a.prototype.add=function(a){if("string"===typeof a){a:{var b,m=0,p={type:Number(a.charAt(0))};if(null==k.types[p.type])a={type:k.ERROR,data:"parser error: unknown packet type "+p.type};else{if(k.BINARY_EVENT===p.type||k.BINARY_ACK===p.type){for(b=m+1;"-"!==a.charAt(++m)&&m!=a.length;);var f=a.substring(b,m);if(f!=Number(f)||"-"!==a.charAt(m))throw Error("Illegal attachments");
p.attachments=Number(f)}if("/"===a.charAt(m+1)){for(b=m+1;++m;){f=a.charAt(m);if(","===f)break;if(m===a.length)break}p.nsp=a.substring(b,m)}else p.nsp="/";f=a.charAt(m+1);if(""!==f&&Number(f)==f){for(b=m+1;++m;){f=a.charAt(m);if(null==f||Number(f)!=f){--m;break}if(m===a.length)break}p.id=Number(a.substring(b,m+1))}if(a.charAt(++m)){m=a.substr(m);try{var h=JSON.parse(m)}catch(x){h=!1}if(!1===h||p.type!==k.ERROR&&!d(h)){a={type:k.ERROR,data:"parser error: invalid payload"};break a}else p.data=h}l("decoded %s as %j",
a,p);a=p}}k.BINARY_EVENT===a.type||k.BINARY_ACK===a.type?(this.reconstructor=new e(a),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",a)):this.emit("decoded",a)}else if(c(a)||a.base64)if(this.reconstructor){if(a=this.reconstructor.takeBinaryData(a))this.reconstructor=null,this.emit("decoded",a)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+a);};a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};
e.prototype.takeBinaryData=function(a){this.buffers.push(a);return this.buffers.length===this.reconPack.attachments?(a=p.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),a):null};e.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},function(n,k,g){(function(f){function q(){try{var a=new Uint8Array(1);a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===a.foo()&&"function"===typeof a.subarray&&0===a.subarray(1,
1).byteLength}catch(L){return!1}}function h(b,c){if((a.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<c)throw new RangeError("Invalid typed array length");a.TYPED_ARRAY_SUPPORT?(b=new Uint8Array(c),b.__proto__=a.prototype):(null===b&&(b=new a(c)),b.length=c);return b}function a(b,c,d){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(b,c,d);if("number"===typeof b){if("string"===typeof c)throw Error("If encoding is specified then the first argument must be a string");return p(this,b)}return e(this,
b,c,d)}function e(e,m,l,p){if("number"===typeof m)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&m instanceof ArrayBuffer){m.byteLength;if(0>l||m.byteLength<l)throw new RangeError("'offset' is out of bounds");if(m.byteLength<l+(p||0))throw new RangeError("'length' is out of bounds");m=void 0===l&&void 0===p?new Uint8Array(m):void 0===p?new Uint8Array(m,l):new Uint8Array(m,l,p);a.TYPED_ARRAY_SUPPORT?(e=m,e.__proto__=a.prototype):e=d(e,m);return e}if("string"===
typeof m){p=e;e=l;if("string"!==typeof e||""===e)e="utf8";if(!a.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');l=b(m,e)|0;p=h(p,l);m=p.write(m,e);m!==l&&(p=p.slice(0,m));return p}return c(e,m)}function l(a){if("number"!==typeof a)throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative');}function p(b,c){l(c);b=h(b,0>c?0:m(c)|0);if(!a.TYPED_ARRAY_SUPPORT)for(var d=0;d<c;++d)b[d]=0;return b}function d(a,
b){var c=0>b.length?0:m(b.length)|0;a=h(a,c);for(var d=0;d<c;d+=1)a[d]=b[d]&255;return a}function c(b,c){if(a.isBuffer(c)){var e=m(c.length)|0;b=h(b,e);if(0===b.length)return b;c.copy(b,0,0,e);return b}if(c){if("undefined"!==typeof ArrayBuffer&&c.buffer instanceof ArrayBuffer||"length"in c)return(e="number"!==typeof c.length)||(e=c.length,e=e!==e),e?h(b,0):d(b,c);if("Buffer"===c.type&&O(c.data))return d(b,c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function m(b){if(b>=(a.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(a.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return b|0}function b(b,c){if(a.isBuffer(b))return b.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(b)||b instanceof ArrayBuffer))return b.byteLength;"string"!==typeof b&&(b=""+b);var d=b.length;if(0===d)return 0;for(var e=!1;;)switch(c){case "ascii":case "latin1":case "binary":return d;
case "utf8":case "utf-8":case void 0:return B(b).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*d;case "hex":return d>>>1;case "base64":return I.toByteArray(F(b)).length;default:if(e)return B(b).length;c=(""+c).toLowerCase();e=!0}}function u(a,b,c){var d=!1;if(void 0===b||0>b)b=0;if(b>this.length)return"";if(void 0===c||c>this.length)c=this.length;if(0>=c)return"";c>>>=0;b>>>=0;if(c<=b)return"";for(a||(a="utf8");;)switch(a){case "hex":a=b;b=c;c=this.length;if(!a||0>a)a=0;
if(!b||0>b||b>c)b=c;d="";for(c=a;c<b;++c)a=d,d=this[c],d=16>d?"0"+d.toString(16):d.toString(16),d=a+d;return d;case "utf8":case "utf-8":return A(this,b,c);case "ascii":a="";for(c=Math.min(this.length,c);b<c;++b)a+=String.fromCharCode(this[b]&127);return a;case "latin1":case "binary":a="";for(c=Math.min(this.length,c);b<c;++b)a+=String.fromCharCode(this[b]);return a;case "base64":return b=0===b&&c===this.length?I.fromByteArray(this):I.fromByteArray(this.slice(b,c)),b;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":b=
this.slice(b,c);c="";for(a=0;a<b.length;a+=2)c+=String.fromCharCode(b[a]+256*b[a+1]);return c;default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();d=!0}}function v(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function r(b,c,d,e,m){if(0===b.length)return-1;"string"===typeof d?(e=d,d=0):2147483647<d?d=2147483647:-2147483648>d&&(d=-2147483648);d=+d;isNaN(d)&&(d=m?0:b.length-1);0>d&&(d=b.length+d);if(d>=b.length){if(m)return-1;d=b.length-1}else if(0>d)if(m)d=0;else return-1;"string"===
typeof c&&(c=a.from(c,e));if(a.isBuffer(c))return 0===c.length?-1:K(b,c,d,e,m);if("number"===typeof c)return c&=255,a.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?m?Uint8Array.prototype.indexOf.call(b,c,d):Uint8Array.prototype.lastIndexOf.call(b,c,d):K(b,[c],d,e,m);throw new TypeError("val must be string, number or Buffer");}function K(a,b,c,d,e){function m(a,b){return 1===l?a[b]:a.readUInt16BE(b*l)}var l=1,p=a.length,f=b.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===
d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(2>a.length||2>b.length)return-1;l=2;p/=2;f/=2;c/=2}if(e)for(d=-1;c<p;c++)if(m(a,c)===m(b,-1===d?0:c-d)){if(-1===d&&(d=c),c-d+1===f)return d*l}else-1!==d&&(c-=c-d),d=-1;else for(c+f>p&&(c=p-f);0<=c;c--){p=!0;for(d=0;d<f;d++)if(m(a,c+d)!==m(b,d)){p=!1;break}if(p)return c}return-1}function A(a,b,c){c=Math.min(a.length,c);for(var d=[];b<c;){var e=a[b],m=null,l=239<e?4:223<e?3:191<e?2:1;if(b+l<=c)switch(l){case 1:128>e&&(m=e);break;case 2:var p=a[b+1];
128===(p&192)&&(e=(e&31)<<6|p&63,127<e&&(m=e));break;case 3:p=a[b+1];var f=a[b+2];128===(p&192)&&128===(f&192)&&(e=(e&15)<<12|(p&63)<<6|f&63,2047<e&&(55296>e||57343<e)&&(m=e));break;case 4:p=a[b+1];f=a[b+2];var h=a[b+3];128===(p&192)&&128===(f&192)&&128===(h&192)&&(e=(e&15)<<18|(p&63)<<12|(f&63)<<6|h&63,65535<e&&1114112>e&&(m=e))}null===m?(m=65533,l=1):65535<m&&(m-=65536,d.push(m>>>10&1023|55296),m=56320|m&1023);d.push(m);b+=l}a=d.length;if(a<=M)d=String.fromCharCode.apply(String,d);else{c="";for(b=
0;b<a;)c+=String.fromCharCode.apply(String,d.slice(b,b+=M));d=c}return d}function n(a,b,c){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length");}function t(b,c,d,e,m,l){if(!a.isBuffer(b))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>m||c<l)throw new RangeError('"value" argument is out of bounds');if(d+e>b.length)throw new RangeError("Index out of range");}function z(a,b,c,d){0>b&&(b=65535+b+1);for(var e=
0,m=Math.min(a.length-c,2);e<m;++e)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function C(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,m=Math.min(a.length-c,4);e<m;++e)a[c+e]=b>>>8*(d?e:3-e)&255}function D(a,b,c,d,e,m){if(c+d>a.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range");}function y(a,b,c,d,e){e||D(a,b,c,4,3.4028234663852886e+38,-3.4028234663852886e+38);J.write(a,b,c,d,23,4);return c+4}function E(a,b,c,d,e){e||D(a,b,c,8,1.7976931348623157e+308,
-1.7976931348623157e+308);J.write(a,b,c,d,52,8);return c+8}function F(a){a=a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");a=a.replace(P,"");if(2>a.length)return"";for(;0!==a.length%4;)a+="\x3d";return a}function B(a,b){b=b||Infinity;for(var c,d=a.length,e=null,m=[],l=0;l<d;++l){c=a.charCodeAt(l);if(55295<c&&57344>c){if(!e){if(56319<c){-1<(b-=3)&&m.push(239,191,189);continue}else if(l+1===d){-1<(b-=3)&&m.push(239,191,189);continue}e=c;continue}if(56320>c){-1<(b-=3)&&m.push(239,191,189);e=c;continue}c=
(e-55296<<10|c-56320)+65536}else e&&-1<(b-=3)&&m.push(239,191,189);e=null;if(128>c){if(0>--b)break;m.push(c)}else if(2048>c){if(0>(b-=2))break;m.push(c>>6|192,c&63|128)}else if(65536>c){if(0>(b-=3))break;m.push(c>>12|224,c>>6&63|128,c&63|128)}else if(1114112>c){if(0>(b-=4))break;m.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw Error("Invalid code point");}return m}function Q(a){for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c)&255);return b}function G(a,b,c,d){for(var e=0;e<d&&
!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}var I=g(49),J=g(50),O=g(51);k.Buffer=a;k.SlowBuffer=function(b){+b!=b&&(b=0);return a.alloc(+b)};k.INSPECT_MAX_BYTES=50;a.TYPED_ARRAY_SUPPORT=void 0!==f.TYPED_ARRAY_SUPPORT?f.TYPED_ARRAY_SUPPORT:q();k.kMaxLength=a.TYPED_ARRAY_SUPPORT?2147483647:1073741823;a.poolSize=8192;a._augment=function(b){b.__proto__=a.prototype;return b};a.from=function(a,b,c){return e(null,a,b,c)};a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=
Uint8Array,$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!==typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&($jscomp.initSymbol(),Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})));a.alloc=function(a,b,c){l(a);a=0>=a?h(null,a):void 0!==b?"string"===typeof c?h(null,a).fill(b,c):h(null,a).fill(b):h(null,a);return a};a.allocUnsafe=function(a){return p(null,a)};a.allocUnsafeSlow=function(a){return p(null,a)};a.isBuffer=function(a){return!(null==a||
!a._isBuffer)};a.compare=function(b,c){if(!a.isBuffer(b)||!a.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(b===c)return 0;for(var d=b.length,e=c.length,m=0,l=Math.min(d,e);m<l;++m)if(b[m]!==c[m]){d=b[m];e=c[m];break}return d<e?-1:e<d?1:0};a.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};a.concat=function(b,
c){if(!O(b))throw new TypeError('"list" argument must be an Array of Buffers');if(0===b.length)return a.alloc(0);var d;if(void 0===c)for(d=c=0;d<b.length;++d)c+=b[d].length;c=a.allocUnsafe(c);var e=0;for(d=0;d<b.length;++d){var m=b[d];if(!a.isBuffer(m))throw new TypeError('"list" argument must be an Array of Buffers');m.copy(c,e);e+=m.length}return c};a.byteLength=b;a.prototype._isBuffer=!0;a.prototype.swap16=function(){var a=this.length;if(0!==a%2)throw new RangeError("Buffer size must be a multiple of 16-bits");
for(var b=0;b<a;b+=2)v(this,b,b+1);return this};a.prototype.swap32=function(){var a=this.length;if(0!==a%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<a;b+=4)v(this,b,b+3),v(this,b+1,b+2);return this};a.prototype.swap64=function(){var a=this.length;if(0!==a%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<a;b+=8)v(this,b,b+7),v(this,b+1,b+6),v(this,b+2,b+5),v(this,b+3,b+4);return this};a.prototype.toString=function(){var a=this.length|
0;return 0===a?"":0===arguments.length?A(this,0,a):u.apply(this,arguments)};a.prototype.equals=function(b){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===a.compare(this,b)};a.prototype.inspect=function(){var a="",b=k.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... "));return"\x3cBuffer "+a+"\x3e"};a.prototype.compare=function(b,c,d,e,m){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");
void 0===c&&(c=0);void 0===d&&(d=b?b.length:0);void 0===e&&(e=0);void 0===m&&(m=this.length);if(0>c||d>b.length||0>e||m>this.length)throw new RangeError("out of range index");if(e>=m&&c>=d)return 0;if(e>=m)return-1;if(c>=d)return 1;c>>>=0;d>>>=0;e>>>=0;m>>>=0;if(this===b)return 0;var l=m-e,p=d-c,f=Math.min(l,p);e=this.slice(e,m);b=b.slice(c,d);for(c=0;c<f;++c)if(e[c]!==b[c]){l=e[c];p=b[c];break}return l<p?-1:p<l?1:0};a.prototype.includes=function(a,b,c){return-1!==this.indexOf(a,b,c)};a.prototype.indexOf=
function(a,b,c){return r(this,a,b,c,!0)};a.prototype.lastIndexOf=function(a,b,c){return r(this,a,b,c,!1)};a.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"===typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var e=this.length-b;if(void 0===c||c>e)c=e;if(0<a.length&&(0>c||0>b)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");
d||(d="utf8");for(e=!1;;)switch(d){case "hex":a:{b=Number(b)||0;d=this.length-b;c?(c=Number(c),c>d&&(c=d)):c=d;d=a.length;if(0!==d%2)throw new TypeError("Invalid hex string");c>d/2&&(c=d/2);for(d=0;d<c;++d){e=parseInt(a.substr(2*d,2),16);if(isNaN(e)){a=d;break a}this[b+d]=e}a=d}return a;case "utf8":case "utf-8":return G(B(a,this.length-b),this,b,c);case "ascii":return G(Q(a),this,b,c);case "latin1":case "binary":return G(Q(a),this,b,c);case "base64":return G(I.toByteArray(F(a)),this,b,c);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":d=
a;for(var e=this.length-b,m=[],l=0;l<d.length&&!(0>(e-=2));++l){var p=d.charCodeAt(l);a=p>>8;p%=256;m.push(p);m.push(a)}return G(m,this,b,c);default:if(e)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();e=!0}};a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;a.prototype.slice=function(b,c){var d=this.length;b=~~b;c=void 0===c?d:~~c;0>b?(b+=d,0>b&&(b=0)):b>d&&(b=d);0>c?(c+=d,0>c&&(c=0)):c>d&&(c=d);c<b&&(c=b);if(a.TYPED_ARRAY_SUPPORT)c=
this.subarray(b,c),c.__proto__=a.prototype;else{d=c-b;c=new a(d,void 0);for(var e=0;e<d;++e)c[e]=this[e+b]}return c};a.prototype.readUIntLE=function(a,b,c){a|=0;b|=0;c||n(a,b,this.length);c=this[a];for(var d=1,e=0;++e<b&&(d*=256);)c+=this[a+e]*d;return c};a.prototype.readUIntBE=function(a,b,c){a|=0;b|=0;c||n(a,b,this.length);c=this[a+--b];for(var d=1;0<b&&(d*=256);)c+=this[a+--b]*d;return c};a.prototype.readUInt8=function(a,b){b||n(a,1,this.length);return this[a]};a.prototype.readUInt16LE=function(a,
b){b||n(a,2,this.length);return this[a]|this[a+1]<<8};a.prototype.readUInt16BE=function(a,b){b||n(a,2,this.length);return this[a]<<8|this[a+1]};a.prototype.readUInt32LE=function(a,b){b||n(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};a.prototype.readUInt32BE=function(a,b){b||n(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};a.prototype.readIntLE=function(a,b,c){a|=0;b|=0;c||n(a,b,this.length);c=this[a];for(var d=1,e=0;++e<b&&(d*=256);)c+=
this[a+e]*d;c>=128*d&&(c-=Math.pow(2,8*b));return c};a.prototype.readIntBE=function(a,b,c){a|=0;b|=0;c||n(a,b,this.length);c=b;for(var d=1,e=this[a+--c];0<c&&(d*=256);)e+=this[a+--c]*d;e>=128*d&&(e-=Math.pow(2,8*b));return e};a.prototype.readInt8=function(a,b){b||n(a,1,this.length);return this[a]&128?-1*(255-this[a]+1):this[a]};a.prototype.readInt16LE=function(a,b){b||n(a,2,this.length);a=this[a]|this[a+1]<<8;return a&32768?a|4294901760:a};a.prototype.readInt16BE=function(a,b){b||n(a,2,this.length);
a=this[a+1]|this[a]<<8;return a&32768?a|4294901760:a};a.prototype.readInt32LE=function(a,b){b||n(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};a.prototype.readInt32BE=function(a,b){b||n(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};a.prototype.readFloatLE=function(a,b){b||n(a,4,this.length);return J.read(this,a,!0,23,4)};a.prototype.readFloatBE=function(a,b){b||n(a,4,this.length);return J.read(this,a,!1,23,4)};a.prototype.readDoubleLE=function(a,
b){b||n(a,8,this.length);return J.read(this,a,!0,52,8)};a.prototype.readDoubleBE=function(a,b){b||n(a,8,this.length);return J.read(this,a,!1,52,8)};a.prototype.writeUIntLE=function(a,b,c,d){a=+a;b|=0;c|=0;d||t(this,a,b,c,Math.pow(2,8*c)-1,0);d=1;var e=0;for(this[b]=a&255;++e<c&&(d*=256);)this[b+e]=a/d&255;return b+c};a.prototype.writeUIntBE=function(a,b,c,d){a=+a;b|=0;c|=0;d||t(this,a,b,c,Math.pow(2,8*c)-1,0);d=c-1;var e=1;for(this[b+d]=a&255;0<=--d&&(e*=256);)this[b+d]=a/e&255;return b+c};a.prototype.writeUInt8=
function(b,c,d){b=+b;c|=0;d||t(this,b,c,1,255,0);a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));this[c]=b&255;return c+1};a.prototype.writeUInt16LE=function(b,c,d){b=+b;c|=0;d||t(this,b,c,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[c]=b&255,this[c+1]=b>>>8):z(this,b,c,!0);return c+2};a.prototype.writeUInt16BE=function(b,c,d){b=+b;c|=0;d||t(this,b,c,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=b&255):z(this,b,c,!1);return c+2};a.prototype.writeUInt32LE=function(b,c,d){b=+b;c|=0;d||t(this,b,c,4,4294967295,
0);a.TYPED_ARRAY_SUPPORT?(this[c+3]=b>>>24,this[c+2]=b>>>16,this[c+1]=b>>>8,this[c]=b&255):C(this,b,c,!0);return c+4};a.prototype.writeUInt32BE=function(b,c,d){b=+b;c|=0;d||t(this,b,c,4,4294967295,0);a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=b&255):C(this,b,c,!1);return c+4};a.prototype.writeIntLE=function(a,b,c,d){a=+a;b|=0;d||(d=Math.pow(2,8*c-1),t(this,a,b,c,d-1,-d));d=0;var e=1,m=0;for(this[b]=a&255;++d<c&&(e*=256);)0>a&&0===m&&0!==this[b+d-1]&&(m=1),this[b+
d]=(a/e>>0)-m&255;return b+c};a.prototype.writeIntBE=function(a,b,c,d){a=+a;b|=0;d||(d=Math.pow(2,8*c-1),t(this,a,b,c,d-1,-d));d=c-1;var e=1,m=0;for(this[b+d]=a&255;0<=--d&&(e*=256);)0>a&&0===m&&0!==this[b+d+1]&&(m=1),this[b+d]=(a/e>>0)-m&255;return b+c};a.prototype.writeInt8=function(b,c,d){b=+b;c|=0;d||t(this,b,c,1,127,-128);a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));0>b&&(b=255+b+1);this[c]=b&255;return c+1};a.prototype.writeInt16LE=function(b,c,d){b=+b;c|=0;d||t(this,b,c,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?
(this[c]=b&255,this[c+1]=b>>>8):z(this,b,c,!0);return c+2};a.prototype.writeInt16BE=function(b,c,d){b=+b;c|=0;d||t(this,b,c,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=b&255):z(this,b,c,!1);return c+2};a.prototype.writeInt32LE=function(b,c,d){b=+b;c|=0;d||t(this,b,c,4,2147483647,-2147483648);a.TYPED_ARRAY_SUPPORT?(this[c]=b&255,this[c+1]=b>>>8,this[c+2]=b>>>16,this[c+3]=b>>>24):C(this,b,c,!0);return c+4};a.prototype.writeInt32BE=function(b,c,d){b=+b;c|=0;d||t(this,b,c,4,2147483647,
-2147483648);0>b&&(b=4294967295+b+1);a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=b&255):C(this,b,c,!1);return c+4};a.prototype.writeFloatLE=function(a,b,c){return y(this,a,b,!0,c)};a.prototype.writeFloatBE=function(a,b,c){return y(this,a,b,!1,c)};a.prototype.writeDoubleLE=function(a,b,c){return E(this,a,b,!0,c)};a.prototype.writeDoubleBE=function(a,b,c){return E(this,a,b,!1,c)};a.prototype.copy=function(b,c,d,e){d||(d=0);e||0===e||(e=this.length);c>=b.length&&
(c=b.length);c||(c=0);0<e&&e<d&&(e=d);if(e===d||0===b.length||0===this.length)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>d||d>=this.length)throw new RangeError("sourceStart out of bounds");if(0>e)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length);b.length-c<e-d&&(e=b.length-c+d);var m=e-d;if(this===b&&d<c&&c<e)for(e=m-1;0<=e;--e)b[e+c]=this[e+d];else if(1E3>m||!a.TYPED_ARRAY_SUPPORT)for(e=0;e<m;++e)b[e+c]=this[e+d];else Uint8Array.prototype.set.call(b,
this.subarray(d,d+m),c);return m};a.prototype.fill=function(b,c,d,e){if("string"===typeof b){"string"===typeof c?(e=c,c=0,d=this.length):"string"===typeof d&&(e=d,d=this.length);if(1===b.length){var m=b.charCodeAt(0);256>m&&(b=m)}if(void 0!==e&&"string"!==typeof e)throw new TypeError("encoding must be a string");if("string"===typeof e&&!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);}else"number"===typeof b&&(b&=255);if(0>c||this.length<c||this.length<d)throw new RangeError("Out of range index");
if(d<=c)return this;c>>>=0;d=void 0===d?this.length:d>>>0;b||(b=0);if("number"===typeof b)for(e=c;e<d;++e)this[e]=b;else for(b=a.isBuffer(b)?b:B((new a(b,e)).toString()),m=b.length,e=0;e<d-c;++e)this[e+c]=b[e%m];return this};var P=/[^+\/0-9A-Za-z-_]/g}).call(k,g(24))},function(n,k,g){var f=g(54),q=g(14);n.exports=function(h){var a=h.xdomain,e=h.xscheme;h=h.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!a||f))return new XMLHttpRequest}catch(l){}try{if("undefined"!==typeof XDomainRequest&&
!e&&h)return new XDomainRequest}catch(l){}if(!a)try{return new (q[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(l){}}},function(n,k){n.exports="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")()},function(n,k,g){function f(f){this.path=f.path;this.hostname=f.hostname;this.port=f.port;this.secure=f.secure;this.query=f.query;this.timestampParam=f.timestampParam;this.timestampRequests=f.timestampRequests;this.readyState="";this.agent=f.agent||
!1;this.socket=f.socket;this.enablesXDR=f.enablesXDR;this.withCredentials=f.withCredentials;this.pfx=f.pfx;this.key=f.key;this.passphrase=f.passphrase;this.cert=f.cert;this.ca=f.ca;this.ciphers=f.ciphers;this.rejectUnauthorized=f.rejectUnauthorized;this.forceNode=f.forceNode;this.isReactNative=f.isReactNative;this.extraHeaders=f.extraHeaders;this.localAddress=f.localAddress}var q=g(3);k=g(2);n.exports=f;k(f.prototype);f.prototype.onError=function(f,a){f=Error(f);f.type="TransportError";f.description=
a;this.emit("error",f);return this};f.prototype.open=function(){if("closed"===this.readyState||""===this.readyState)this.readyState="opening",this.doOpen();return this};f.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState)this.doClose(),this.onClose();return this};f.prototype.send=function(f){if("open"===this.readyState)this.write(f);else throw Error("Transport not open");};f.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};f.prototype.onData=
function(f){f=q.decodePacket(f,this.socket.binaryType);this.onPacket(f)};f.prototype.onPacket=function(f){this.emit("packet",f)};f.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},function(n,k,g){var f=g(17),q=g(40),h=g(41),a=g(42);n=g(0);var e=g(1),l=g(9),p=g(10),d=e.c,c=103,m=["high-packet-losses","low-packet-losses","good"],b=n.a.module("ErizoConnection"),u=function(m,r){var g=d.call(this)||this;g.stack={};g.erizoId=r;g.streamsMap=Object(l.a)();c+=1;m.sessionId=c;g.sessionId=
c;g.connectionId=m.connectionId;g.disableIceRestart=m.disableIceRestart;g.qualityLevel="good";g.wasAbleToConnect=!1;b.debug("message: Building a new Connection, "+g.toLog());m.onEnqueueingTimeout=function(a){g.emit(Object(e.a)({type:"connection-failed",connection:g,message:"reason: Timeout in "+a}))};m.streamRemovedListener||(m.streamRemovedListener=function(){});g.streamRemovedListener=m.streamRemovedListener;g.browser=p.a.getBrowser();if("fake"===g.browser)b.warning("message: Publish/subscribe video/audio streams not supported in erizofc yet, "+
g.toLog()),g.stack=Object(a.a)(m);else if("mozilla"===g.browser)b.debug("message: Firefox Stack, "+g.toLog()),g.stack=Object(h.a)(m);else if("safari"===g.browser)b.debug("message: Safari Stack, "+g.toLog()),g.stack=Object(q.a)(m);else if("chrome-stable"===g.browser||"electron"===g.browser)b.debug("message: Chrome Stable Stack, "+g.toLog()),g.stack=Object(f.a)(m);else throw b.error("message: No stack available for this browser, "+g.toLog()),Error("WebRTC stack not available");g.stack.updateSpec||(g.stack.updateSpec=
function(a,c){c=void 0===c?function(){}:c;b.error("message: Update Configuration not implemented in this browser, "+g.toLog());c("unimplemented")});g.stack.setSignallingCallback||(g.stack.setSignallingCallback=function(){b.error("message: setSignallingCallback is not implemented in this stack, "+g.toLog())});g.stack.peerConnection&&(g.peerConnection=g.stack.peerConnection,g.stack.peerConnection.onaddstream=function(a){g.emit(Object(e.a)({type:"add-stream",stream:a.stream}))},g.stack.peerConnection.onremovestream=
function(a){g.emit(Object(e.a)({type:"remove-stream",stream:a.stream}));g.streamRemovedListener(a.stream.id)},g.stack.peerConnection.oniceconnectionstatechange=function(){var a=g.stack.peerConnection.iceConnectionState;-1!==["completed","connected"].indexOf(a)&&(g.wasAbleToConnect=!0);"failed"===a&&g.wasAbleToConnect&&!g.disableIceRestart?(b.warning("message: Restarting ICE, "+g.toLog()),g.stack.restartIce()):g.emit(Object(e.a)({type:"ice-state-change",state:a,wasAbleToConnect:g.wasAbleToConnect}))});
return g};$jscomp.inherits(u,d);u.prototype.toLog=function(){return"connectionId: "+this.connectionId+", sessionId: "+this.sessionId+", qualityLevel: "+this.qualityLevel+", erizoId: "+this.erizoId};u.prototype.close=function(){b.debug("message: Closing ErizoConnection, "+this.toLog());this.streamsMap.clear();this.stack.close()};u.prototype.addStream=function(a){b.debug("message: Adding stream to Connection, "+this.toLog()+", "+a.toLog());this.streamsMap.add(a.getID(),a);a.local&&this.stack.addStream(a)};
u.prototype.removeStream=function(a){var c=a.getID();this.streamsMap.has(c)?(this.streamsMap.remove(c),a.local?this.stack.removeStream(a.stream):0===this.streamsMap.size()&&this.streamRemovedListener(a.getLabel())):b.debug("message: Cannot remove stream not in map, "+this.toLog()+", "+a.toLog())};u.prototype.processSignalingMessage=function(a){this.stack.processSignalingMessage(a)};u.prototype.sendSignalingMessage=function(a){this.stack.sendSignalingMessage(a)};u.prototype.updateSpec=function(a,b,
c){this.stack.updateSpec(a,b,c)};u.prototype.setQualityLevel=function(a){this.qualityLevel=m[a]};u.prototype.getQualityLevel=function(){return{message:this.qualityLevel,index:m.indexOf(this.qualityLevel)}};g=function(){this.ErizoConnectionsMap=new Map};g.prototype.getErizoConnection=function(a){var b;this.ErizoConnectionsMap.forEach(function(c){Object.keys(c).forEach(function(d){c[d].connectionId===a&&(b=c[d])})});return b};g.prototype.getOrBuildErizoConnection=function(a,c,d){d=void 0===d?!1:d;b.debug("message: getOrBuildErizoConnection, erizoId: "+
c+", singlePC: "+d);var e=a.isRemote?"subscribe":"publish";if(void 0===c)return new u(a);d?(this.ErizoConnectionsMap.has(c)?d=this.ErizoConnectionsMap.get(c):(d={},this.ErizoConnectionsMap.set(c,d)),d["single-pc-"+e]||(d["single-pc-"+e]=new u(a,c)),a=d["single-pc-"+e]):(a=new u(a,c),this.ErizoConnectionsMap.has(c)?this.ErizoConnectionsMap.get(c)[a.sessionId]=a:(e={},e[a.sessionId]=a,this.ErizoConnectionsMap.set(c,e)));return a};g.prototype.maybeCloseConnection=function(a,c){c=void 0===c?!1:c;b.debug("message: Trying to remove connection, "+
a.toLog());if(0===a.streamsMap.size()||c){b.debug("message: No streams in connection, "+a.toLog());var d=this.ErizoConnectionsMap.get(a.erizoId);void 0===d||!d["single-pc-publish"]&&!d["single-pc-subscribe"]||c?(a.close(),void 0!==d&&(delete d["single-pc-subscribe"],delete d["single-pc-publish"],delete d[a.sessionId])):b.debug("message: Will not remove empty connection, "+a.toLog()+", reason: It is singlePC")}};k.a=g},function(n,k,g){var f=g(18),q=g(39),h=g(0).a.module("ChromeStableStack");k.a=function(a){h.debug("message: Starting Chrome stable stack, spec: "+
JSON.stringify(a));var e=Object(f.a)(a);e.mediaConstraints={offerToReceiveVideo:!0,offerToReceiveAudio:!0};e.prepareCreateOffer=function(){return Promise.resolve()};e.setStartVideoBW=function(l){e.video&&a.startVideoBW&&(h.debug("message: startVideoBW, requested: "+a.startVideoBW),q.a.setParamForCodecs(l,"video","x-google-start-bitrate",a.startVideoBW))};e.setHardMinVideoBW=function(l){e.video&&a.hardMinVideoBW&&(h.debug("message: hardMinVideoBW, requested: "+a.hardMinVideoBW),q.a.setParamForCodecs(l,
"video","x-google-min-bitrate",a.hardMinVideoBW))};return e}},function(n,k,g){var f=g(0).a.module("BaseStack");k.a=function(g){var h={},a=[],e=function(e){for(var l=[],d=0;d<arguments.length;++d)l[d-0]=arguments[d];a.push([].concat(["Negotiation:"],$jscomp.arrayFromIterable(l)).reduce(function(a,d){return a+" "+d}))};h.getNegotiationLogs=function(){return a.reduce(function(a,e){return a+"'\n'"+e})};f.debug("message: Starting Base stack, spec: "+JSON.stringify(g));h.pcConfig={iceServers:[],sdpSemantics:"unified-plan"};
h.con={};void 0!==g.iceServers&&(h.pcConfig.iceServers=g.iceServers);!0===g.forceTurn&&(h.pcConfig.iceTransportPolicy="relay");h.pcConfig.bundlePolicy="max-bundle";h.peerConnection=new RTCPeerConnection(h.pcConfig,h.con);h.peerConnection.onnegotiationneeded=function(){return $jscomp.executeAsyncGenerator(function(){function a(a,m){for(;;)switch(f){case 0:if(!g.managed){f=1;break}f=-1;return{value:void 0,done:!0};case 1:try{return f=4,{value:h.peerConnection.setLocalDescription(),done:!1}}catch(v){c=
v;f=2;break}case 4:try{if(void 0===m){f=5;break}f=-1;throw m;}catch(v){c=v;f=2;break}case 5:try{g.callback({type:h.peerConnection.localDescription.type,sdp:h.peerConnection.localDescription.sdp});f=3;break}catch(v){c=v;f=2;break}case 2:d=c,e("onnegotiationneeded - error",d.message);case 3:f=-1;default:return{value:void 0,done:!0}}}var f=0,d,c,m={next:function(b){return a(b,void 0)},throw:function(b){return a(void 0,b)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();
m[Symbol.iterator]=function(){return this};return m}())};h.peerConnection.onicecandidate=function(a){(a=a.candidate)?(a={sdpMLineIndex:a.sdpMLineIndex,sdpMid:a.sdpMid,candidate:a.candidate},a.candidate.match(/a=/)||(a.candidate="a\x3d"+a.candidate)):(f.debug("message: Gathered all candidates and sending END candidate"),a={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"});g.callback({type:"candidate",candidate:a})};h.setStartVideoBW=function(a){f.error("message: startVideoBW not implemented for this browser");
return a};h.setHardMinVideoBW=function(a){f.error("message: hardMinVideoBw not implemented for this browser");return a};h.updateSpec=function(a,e){if(!g.p2p&&a.maxVideoBW||a.minVideoBW||void 0!==a.slideShowMode||void 0!==a.muteStream||void 0!==a.qualityLayer||void 0!==a.slideShowBelowLayer||void 0!==a.video||void 0!==a.priorityLevel)f.debug("message: Configuration changed, maxVideoBW: "+a.maxVideoBW+(", minVideoBW: "+a.minVideoBW+", slideShowMode: "+a.slideShowMode)+(", muteStream: "+JSON.stringify(a.muteStream)+
", videoConstraints: "+JSON.stringify(a.video))+(", slideShowBelowMinLayer: "+a.slideShowBelowLayer)+(", priority: "+a.priorityLevel)),g.callback({type:"updatestream",config:a},e)};h.addStream=function(a){var e=a.stream;e.transceivers=[];e.getTracks().forEach(function(d){return $jscomp.executeAsyncGenerator(function(){function c(c,p){for(;;)switch(m){case 0:f={},"video"===d.kind&&(f={sendEncodings:a.generateEncoderParameters()}),f.streams=[e],b=h.peerConnection.addTransceiver(d,f),e.transceivers.push(b),
m=-1;default:return{value:void 0,done:!0}}}var m=0,b,f,p={next:function(a){return c(a,void 0)},throw:function(a){return c(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();p[Symbol.iterator]=function(){return this};return p}())})};h.removeStream=function(a){a.transceivers.forEach(function(a){f.debug("Stopping transceiver",a);"0"===a.mid?h.peerConnection.removeTrack(a.sender):a.stop()})};h.close=function(){h.peerConnection.close()};h.setLocalDescription=
function(){return $jscomp.executeAsyncGenerator(function(){function a(a,d){for(;;)switch(e){case 0:return e=-1,{value:h.peerConnection.setLocalDescription(),done:!0};default:return{value:void 0,done:!0}}}var e=0,d={next:function(c){return a(c,void 0)},throw:function(c){return a(void 0,c)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();d[Symbol.iterator]=function(){return this};return d}())};h.getLocalDescription=function(){return $jscomp.executeAsyncGenerator(function(){function a(a,
d){for(;;)switch(e){case 0:return e=-1,{value:h.peerConnection.localDescription.sdp,done:!0};default:return{value:void 0,done:!0}}}var e=0,d={next:function(c){return a(c,void 0)},throw:function(c){return a(void 0,c)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();d[Symbol.iterator]=function(){return this};return d}())};h.setRemoteDescription=function(a){return $jscomp.executeAsyncGenerator(function(){function e(c,b){for(;;)switch(d){case 0:return d=1,{value:h.peerConnection.setRemoteDescription(a),
done:!1};case 1:if(void 0===b){d=2;break}d=-1;throw b;case 2:d=-1;default:return{value:void 0,done:!0}}}var d=0,c={next:function(a){return e(a,void 0)},throw:function(a){return e(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();c[Symbol.iterator]=function(){return this};return c}())};h.processSignalingMessage=function(a){return $jscomp.executeAsyncGenerator(function(){function p(p,r){for(;;)switch(d){case 0:q=a;e("processSignalingMessage, type: ",a.type);
if("candidate"!==a.type){d=1;break}l="object"===typeof q.candidate?q.candidate:JSON.parse(q.candidate);if("end"!==l.candidate){d=3;break}d=-1;return{value:void 0,done:!0};case 3:l.candidate=l.candidate.replace(/a=/g,"");l.sdpMLineIndex=parseInt(l.sdpMLineIndex,10);b=new RTCIceCandidate(l);h.peerConnection.addIceCandidate(b);d=2;break;case 1:if("error"!==a.type){d=4;break}f.error("message: Received error signaling message, state: "+a.previousType);d=5;break;case 4:if(-1===["offer","answer"].indexOf(a.type)){d=
6;break}try{return d=9,{value:h.peerConnection.setRemoteDescription(q),done:!1}}catch(x){m=x;d=7;break}case 9:try{if(void 0===r){d=10;break}d=-1;throw r;}catch(x){m=x;d=7;break}case 10:try{if("offer"!==q.type){d=11;break}d=12;return{value:h.peerConnection.setLocalDescription(),done:!1}}catch(x){m=x;d=7;break}case 12:try{if(void 0===r){d=13;break}d=-1;throw r;}catch(x){m=x;d=7;break}case 13:try{g.callback({type:h.peerConnection.localDescription.type,sdp:h.peerConnection.localDescription.sdp})}catch(x){m=
x;d=7;break}case 11:try{d=8;break}catch(x){m=x;d=7;break}case 7:c=m,f.error("message: Error during negotiation, message: ",c.message),"offer"===q.type&&g.callback({type:"offer-error",sdp:h.peerConnection.localDescription.sdp});case 8:case 6:case 5:case 2:d=-1;default:return{value:void 0,done:!0}}}var d=0,c,m,b,l,q,r={next:function(a){return p(a,void 0)},throw:function(a){return p(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();r[Symbol.iterator]=function(){return this};
return r}())};h.restartIce=function(){h.peerConnection.restartIce();h.peerConnection.onnegotiationneeded()};return h}},function(n,k){function g(f,a){var e={};a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,f,d){f&&(e[f]=d)});return e}var f=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,q="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");
n.exports=function(h){var a=h,e=h.indexOf("["),l=h.indexOf("]");-1!=e&&-1!=l&&(h=h.substring(0,e)+h.substring(e,l).replace(/:/g,";")+h.substring(l,h.length));var p=f.exec(h||"");h={};for(var d=14;d--;)h[q[d]]=p[d]||"";-1!=e&&-1!=l&&(h.source=a,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0);a=h.path;e=a.replace(/\/{2,9}/g,"/").split("/");"/"!=a.substr(0,1)&&0!==a.length||e.splice(0,1);"/"==a.substr(a.length-
1,1)&&e.splice(e.length-1,1);h.pathNames=e;h.queryKey=g(h,h.query);return h}},function(n,k){function g(){throw Error("setTimeout has not been defined");}function f(){throw Error("clearTimeout has not been defined");}function q(a){if(d===setTimeout)return setTimeout(a,0);if((d===g||!d)&&setTimeout)return d=setTimeout,setTimeout(a,0);try{return d(a,0)}catch(K){try{return d.call(null,a,0)}catch(A){return d.call(this,a,0)}}}function h(a){if(c===clearTimeout)return clearTimeout(a);if((c===f||!c)&&clearTimeout)return c=
clearTimeout,clearTimeout(a);try{return c(a)}catch(K){try{return c.call(null,a)}catch(A){return c.call(this,a)}}}function a(){b&&u&&(b=!1,u.length?m=u.concat(m):v=-1,m.length&&e())}function e(){if(!b){var c=q(a);b=!0;for(var d=m.length;d;){u=m;for(m=[];++v<d;)u&&u[v].run();v=-1;d=m.length}u=null;b=!1;h(c)}}function l(a,b){this.fun=a;this.array=b}function p(){}n=n.exports={};try{var d="function"===typeof setTimeout?setTimeout:g}catch(r){d=g}try{var c="function"===typeof clearTimeout?clearTimeout:f}catch(r){c=
f}var m=[],b=!1,u,v=-1;n.nextTick=function(a){var c=Array(arguments.length-1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)c[d-1]=arguments[d];m.push(new l(a,c));1!==m.length||b||q(e)};l.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=!0;n.env={};n.argv=[];n.version="";n.versions={};n.on=p;n.addListener=p;n.once=p;n.off=p;n.removeListener=p;n.removeAllListeners=p;n.emit=p;n.prependListener=p;n.prependOnceListener=p;n.listeners=function(a){return[]};
n.binding=function(a){throw Error("process.binding is not supported");};n.cwd=function(){return"/"};n.chdir=function(a){throw Error("process.chdir is not supported");};n.umask=function(){return 0}},function(n,k){function g(a){a=String(a);if(!(100<a.length)&&(a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a))){var e=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return e*
h;case "days":case "day":case "d":return e*q;case "hours":case "hour":case "hrs":case "hr":case "h":return 36E5*e;case "minutes":case "minute":case "mins":case "min":case "m":return 6E4*e;case "seconds":case "second":case "secs":case "sec":case "s":return 1E3*e;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return e}}}function f(a,e,f){if(!(a<e))return a<1.5*e?Math.floor(a/e)+" "+f:Math.ceil(a/e)+" "+f+"s"}var q=864E5,h=365.25*q;n.exports=function(a,e){e=e||{};var l=typeof a;
if("string"===l&&0<a.length)return g(a);if("number"===l&&!1===isNaN(a))return e.long?f(a,q,"day")||f(a,36E5,"hour")||f(a,6E4,"minute")||f(a,1E3,"second")||a+" ms":a>=q?Math.round(a/q)+"d":36E5<=a?Math.round(a/36E5)+"h":6E4<=a?Math.round(a/6E4)+"m":1E3<=a?Math.round(a/1E3)+"s":a+"ms";throw Error("val is not a non-empty string or a valid number. val\x3d"+JSON.stringify(a));}},function(n,k){var g={}.toString;n.exports=Array.isArray||function(f){return"[object Array]"==g.call(f)}},function(n,k,g){(function(f){n.exports=
function(a){var e;!(e=g&&f.isBuffer(a))&&(e=h)&&((e=a instanceof ArrayBuffer)||(e="function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a.buffer instanceof ArrayBuffer));return e};var g="function"===typeof f&&"function"===typeof f.isBuffer,h="function"===typeof ArrayBuffer}).call(k,g(12).Buffer)},function(n,k){k=function(){return this}();try{k=k||Function("return this")()||(0,eval)("this")}catch(g){"object"===typeof window&&(k=window)}n.exports=k},function(n,k,g){function f(b,d){if(!(this instanceof
f))return new f(b,d);b&&"object"===typeof b&&(d=b,b=void 0);d=d||{};d.path=d.path||"/socket.io";this.nsps={};this.subs=[];this.opts=d;this.reconnection(!1!==d.reconnection);this.reconnectionAttempts(d.reconnectionAttempts||Infinity);this.reconnectionDelay(d.reconnectionDelay||1E3);this.reconnectionDelayMax(d.reconnectionDelayMax||5E3);this.randomizationFactor(d.randomizationFactor||.5);this.backoff=new c({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});
this.timeout(null==d.timeout?2E4:d.timeout);this.readyState="closed";this.uri=b;this.connecting=[];this.lastPing=null;this.encoding=!1;this.packetBuffer=[];b=d.parser||a;this.encoder=new b.Encoder;this.decoder=new b.Decoder;(this.autoConnect=!1!==d.autoConnect)&&this.open()}var q=g(52),h=g(31);k=g(2);var a=g(11),e=g(32),l=g(33),p=g(4)("socket.io-client:manager"),d=g(30),c=g(68),m=Object.prototype.hasOwnProperty;n.exports=f;f.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)m.call(this.nsps,
a)&&this.nsps[a].emit.apply(this.nsps[a],arguments)};f.prototype.updateSocketIds=function(){for(var a in this.nsps)m.call(this.nsps,a)&&(this.nsps[a].id=this.generateId(a))};f.prototype.generateId=function(a){return("/"===a?"":a+"#")+this.engine.id};k(f.prototype);f.prototype.reconnection=function(a){if(!arguments.length)return this._reconnection;this._reconnection=!!a;return this};f.prototype.reconnectionAttempts=function(a){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=
a;return this};f.prototype.reconnectionDelay=function(a){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=a;this.backoff&&this.backoff.setMin(a);return this};f.prototype.randomizationFactor=function(a){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=a;this.backoff&&this.backoff.setJitter(a);return this};f.prototype.reconnectionDelayMax=function(a){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=a;this.backoff&&
this.backoff.setMax(a);return this};f.prototype.timeout=function(a){if(!arguments.length)return this._timeout;this._timeout=a;return this};f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};f.prototype.open=f.prototype.connect=function(a,c){p("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;p("opening %s",this.uri);var b=this.engine=q(this.uri,this.opts),d=this;this.readyState="opening";this.skipReconnect=
!1;var m=e(b,"open",function(){d.onopen();a&&a()});c=e(b,"error",function(b){p("connect_error");d.cleanup();d.readyState="closed";d.emitAll("connect_error",b);if(a){var c=Error("Connection error");c.data=b;a(c)}else d.maybeReconnectOnOpen()});if(!1!==this._timeout){var f=this._timeout;p("connect attempt will timeout after %d",f);0===f&&m.destroy();var l=setTimeout(function(){p("connect attempt timed out after %d",f);m.destroy();b.close();b.emit("error","timeout");d.emitAll("connect_timeout",f)},f);
this.subs.push({destroy:function(){clearTimeout(l)}})}this.subs.push(m);this.subs.push(c);return this};f.prototype.onopen=function(){p("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(e(a,"data",l(this,"ondata")));this.subs.push(e(a,"ping",l(this,"onping")));this.subs.push(e(a,"pong",l(this,"onpong")));this.subs.push(e(a,"error",l(this,"onerror")));this.subs.push(e(a,"close",l(this,"onclose")));this.subs.push(e(this.decoder,"decoded",l(this,"ondecoded")))};
f.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};f.prototype.ondata=function(a){this.decoder.add(a)};f.prototype.ondecoded=function(a){this.emit("packet",a)};f.prototype.onerror=function(a){p("error",a);this.emitAll("error",a)};f.prototype.socket=function(a,c){function b(){~d(m.connecting,e)||m.connecting.push(e)}var e=this.nsps[a];if(!e){e=new h(this,a,c);this.nsps[a]=e;var m=this;e.on("connecting",
b);e.on("connect",function(){e.id=m.generateId(a)});this.autoConnect&&b()}return e};f.prototype.destroy=function(a){a=d(this.connecting,a);~a&&this.connecting.splice(a,1);this.connecting.length||this.close()};f.prototype.packet=function(a){p("writing packet %j",a);var b=this;a.query&&0===a.type&&(a.nsp+="?"+a.query);b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(c){for(var d=0;d<c.length;d++)b.engine.write(c[d],a.options);b.encoding=!1;b.processPacketQueue()}))};f.prototype.processPacketQueue=
function(){if(0<this.packetBuffer.length&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}};f.prototype.cleanup=function(){p("cleanup");for(var a=this.subs.length,c=0;c<a;c++)this.subs.shift().destroy();this.packetBuffer=[];this.encoding=!1;this.lastPing=null;this.decoder.destroy()};f.prototype.close=f.prototype.disconnect=function(){p("disconnect");this.skipReconnect=!0;this.reconnecting=!1;"opening"===this.readyState&&this.cleanup();this.backoff.reset();this.readyState="closed";this.engine&&
this.engine.close()};f.prototype.onclose=function(a){p("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var c=this.backoff.duration();p("will wait %dms before reconnect attempt",
c);this.reconnecting=!0;var d=setTimeout(function(){a.skipReconnect||(p("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(p("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(p("reconnect success"),a.onreconnect())}))},c);this.subs.push({destroy:function(){clearTimeout(d)}})}};f.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=
!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",a)}},function(n,k,g){var f=g(13),q=g(55),h=g(64);n=g(65);k.polling=function(a){var e=!1,l=!1,p=!1!==a.jsonp;"undefined"!==typeof location&&(l="https:"===location.protocol,(e=location.port)||(e=l?443:80),e=a.hostname!==location.hostname||e!==a.port,l=a.secure!==l);a.xdomain=e;a.xscheme=l;if("open"in new f(a)&&!a.forceJSONP)return new q(a);if(!p)throw Error("JSONP disabled");return new h(a)};k.websocket=n},function(n,k,g){function f(a){var c=
a&&a.forceBase64;if(!p||c)this.supportsBinary=!1;q.call(this,a)}var q=g(15),h=g(5),a=g(3);k=g(6);var e=g(29),l=g(7)("engine.io-client:polling");n.exports=f;var p=null!=(new (g(13))({xdomain:!1})).responseType;k(f,q);f.prototype.name="polling";f.prototype.doOpen=function(){this.poll()};f.prototype.pause=function(a){function c(){l("paused");d.readyState="paused";a()}var d=this;this.readyState="pausing";if(this.polling||!this.writable){var b=0;this.polling&&(l("we are currently polling - waiting to pause"),
b++,this.once("pollComplete",function(){l("pre-pause polling complete");--b||c()}));this.writable||(l("we are currently writing - waiting to pause"),b++,this.once("drain",function(){l("pre-pause writing complete");--b||c()}))}else c()};f.prototype.poll=function(){l("polling");this.polling=!0;this.doPoll();this.emit("poll")};f.prototype.onData=function(d){var c=this;l("polling got data %s",d);a.decodePayload(d,this.socket.binaryType,function(a,b,d){if("opening"===c.readyState&&"open"===a.type)c.onOpen();
if("close"===a.type)return c.onClose(),!1;c.onPacket(a)});"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))};f.prototype.doClose=function(){function a(){l("writing close packet");c.write([{type:"close"}])}var c=this;"open"===this.readyState?(l("transport open - closing"),a()):(l("transport not open - deferring close"),this.once("open",a))};f.prototype.write=function(d){var c=this;this.writable=
!1;var e=function(){c.writable=!0;c.emit("drain")};a.encodePayload(d,this.supportsBinary,function(a){c.doWrite(a,e)})};f.prototype.uri=function(){var a=this.query||{},c=this.secure?"https":"http",m="";!1!==this.timestampRequests&&(a[this.timestampParam]=e());this.supportsBinary||a.sid||(a.b64=1);a=h.encode(a);this.port&&("https"===c&&443!==Number(this.port)||"http"===c&&80!==Number(this.port))&&(m=":"+this.port);a.length&&(a="?"+a);var b=-1!==this.hostname.indexOf(":");return c+"://"+(b?"["+this.hostname+
"]":this.hostname)+m+this.path+a}},function(n,k,g){(function(f){function q(a){if(!a||"object"!==typeof a)return!1;if(h(a)){for(var d=0,c=a.length;d<c;d++)if(q(a[d]))return!0;return!1}if("function"===typeof f&&f.isBuffer&&f.isBuffer(a)||"function"===typeof ArrayBuffer&&a instanceof ArrayBuffer||e&&a instanceof Blob||l&&a instanceof File)return!0;if(a.toJSON&&"function"===typeof a.toJSON&&1===arguments.length)return q(a.toJSON(),!0);for(d in a)if(Object.prototype.hasOwnProperty.call(a,d)&&q(a[d]))return!0;
return!1}var h=g(57),a=Object.prototype.toString,e="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===a.call(Blob),l="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===a.call(File);n.exports=q}).call(k,g(12).Buffer)},function(n,k,g){function f(a){var c="";do c=h[a%64]+c,a=Math.floor(a/64);while(0<a);return c}function q(){var a=f(+new Date);return a!==p?(e=0,p=a):a+"."+f(e++)}for(var h="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),
a={},e=0,l=0,p;64>l;l++)a[h[l]]=l;q.encode=f;q.decode=function(d){var c=0;for(l=0;l<d.length;l++)c=64*c+a[d.charAt(l)];return c};n.exports=q},function(n,k){var g=[].indexOf;n.exports=function(f,q){if(g)return f.indexOf(q);for(var h=0;h<f.length;++h)if(f[h]===q)return h;return-1}},function(n,k,g){function f(a,c,d){this.io=a;this.nsp=c;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0;this.flags={};d&&d.query&&(this.query=d.query);
this.io.autoConnect&&this.open()}var q=g(11);k=g(2);var h=g(67),a=g(32),e=g(33),l=g(4)("socket.io-client:socket"),p=g(5),d=g(28);n.exports=f;var c={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},m=k.prototype.emit;k(f.prototype);f.prototype.subEvents=function(){if(!this.subs){var b=this.io;this.subs=[a(b,"open",e(this,"onopen")),a(b,"packet",e(this,"onpacket")),a(b,"close",
e(this,"onclose"))]}};f.prototype.open=f.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.reconnecting||this.io.open();if("open"===this.io.readyState)this.onopen();this.emit("connecting");return this};f.prototype.send=function(){var a=h(arguments);a.unshift("message");this.emit.apply(this,a);return this};f.prototype.emit=function(a){if(c.hasOwnProperty(a))return m.apply(this,arguments),this;var b=h(arguments),e={type:(void 0!==this.flags.binary?this.flags.binary:
d(b))?q.BINARY_EVENT:q.EVENT,data:b,options:{}};e.options.compress=!this.flags||!1!==this.flags.compress;"function"===typeof b[b.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),e.id=this.ids++);this.connected?this.packet(e):this.sendBuffer.push(e);this.flags={};return this};f.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};f.prototype.onopen=function(){l("transport is open - connecting");if("/"!==this.nsp)if(this.query){var a="object"===typeof this.query?
p.encode(this.query):this.query;l("sending connect packet with query %s",a);this.packet({type:q.CONNECT,query:a})}else this.packet({type:q.CONNECT})};f.prototype.onclose=function(a){l("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",a)};f.prototype.onpacket=function(a){var b=a.type===q.ERROR&&"/"===a.nsp;if(a.nsp===this.nsp||b)switch(a.type){case q.CONNECT:this.onconnect();break;case q.EVENT:this.onevent(a);break;case q.BINARY_EVENT:this.onevent(a);break;
case q.ACK:this.onack(a);break;case q.BINARY_ACK:this.onack(a);break;case q.DISCONNECT:this.ondisconnect();break;case q.ERROR:this.emit("error",a.data)}};f.prototype.onevent=function(a){var b=a.data||[];l("emitting event %j",b);null!=a.id&&(l("attaching ack callback to event"),b.push(this.ack(a.id)));this.connected?m.apply(this,b):this.receiveBuffer.push(b)};f.prototype.ack=function(a){var b=this,c=!1;return function(){if(!c){c=!0;var e=h(arguments);l("sending ack %j",e);b.packet({type:d(e)?q.BINARY_ACK:
q.ACK,id:a,data:e})}}};f.prototype.onack=function(a){var b=this.acks[a.id];"function"===typeof b?(l("calling ack %s with %j",a.id,a.data),b.apply(this,a.data),delete this.acks[a.id]):l("bad ack %s",a.id)};f.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};f.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)m.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);
this.sendBuffer=[]};f.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};f.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};f.prototype.close=f.prototype.disconnect=function(){this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:q.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");
return this};f.prototype.compress=function(a){this.flags.compress=a;return this};f.prototype.binary=function(a){this.flags.binary=a;return this}},function(n,k){n.exports=function(g,f,q){g.on(f,q);return{destroy:function(){g.removeListener(f,q)}}}},function(n,k){var g=[].slice;n.exports=function(f,q){"string"==typeof q&&(q=f[q]);if("function"!=typeof q)throw Error("bind() requires a function");var h=g.call(arguments,2);return function(){return q.apply(f,h.concat(g.call(arguments)))}}},function(n,k,
g){var f=this,q=g(1),h=g(10),a=g(9),e=g(70),l=g(71),p=g(73),d=g(0).a.module("Stream");k.a=function(c,m){var b=Object(q.b)(m),g,k;b.stream=m.stream;b.url=m.url;b.recording=m.recording;b.room=void 0;b.showing=!1;b.local=!1;b.video=m.video;b.audio=m.audio;b.screen=m.screen;b.videoSize=m.videoSize;b.videoFrameRate=m.videoFrameRate;b.extensionId=m.extensionId;b.desktopStreamId=m.desktopStreamId;b.audioMuted=!1;b.videoMuted=!1;b.maxVideoBW=void 0;b.maxAudioBW=void 0;b.unsubscribing={callbackReceived:!1,
pcEventReceived:!1};var r={};b.p2p=!1;b.ConnectionHelpers=void 0===c?h.a:c;void 0!==b.url&&(m.label="ei_"+e.a.getRandomValue());var n=function(a){a.stream.id===b.getLabel()&&b.emit(Object(q.f)({type:"added",stream:a.stream}))},A=function(a){a.stream.id===b.getLabel()&&b.emit(Object(q.f)({type:"removed",stream:b}))},x=function(a){b.emit(Object(q.f)({type:"icestatechanged",msg:a}))};if(!(void 0===b.videoSize||b.videoSize instanceof Array&&4===b.videoSize.length))throw Error("Invalid Video Size");if(void 0===
m.local||!0===m.local)b.local=!0;var t=function(a){if(b.local){var c=900*a-16E3;d.info("message: Setting maxVideoBW, streamId: "+b.getID()+", maxVideoBW: "+a+", translated: "+c);b.maxVideoBW=c;r&&Object.keys(r).forEach(function(a){a=r[a];a.maxBitrate=a.maxBitrate>b.maxVideoBW?b.maxVideoBW:a.maxBitrate})}else b.maxVideoBW=a};b.applySenderEncoderParameters=function(){b.stream.transceivers.forEach(function(a){if(a.sender&&"video"===a.sender.track.kind){var b=a.sender.getParameters();Object.keys(r).forEach(function(a){if(void 0===
b.encodings[a])d.warning("message: Failed Configure parameters for layer, layer: "+a+", config: "+r[a]);else{var c=b.encodings,e=r[a],m=b.encodings[a];m.maxBitrate=e.maxBitrate;void 0!==e.active&&(m.active=e.active);c[a]=m}});a.sender.setParameters(b).then(function(a){d.debug("message: Success setting simulcast layer configs, result: "+a)}).catch(function(a){d.warning("message: Error setting simulcast layer configs, error: "+a)})}})};b.getID=function(){return b.local&&!m.streamID?"local":m.streamID};
b.getLabel=function(){return b.stream&&b.stream.id?b.stream.id:m.label};b.getAttributes=function(){return m.attributes};b.setAttributes=function(a){b.local?b.emit(Object(q.f)({type:"internal-set-attributes",stream:b,attrs:a})):d.error("message: Failed to set attributes data, reason: Stream has not been published, "+b.toLog())};b.toLog=function(){var a="streamId: "+b.getID()+", label: "+b.getLabel();m.attributes&&Object.keys(m.attributes).forEach(function(b){a=a+", "+b+": "+m.attributes[b]});return a};
b.updateLocalAttributes=function(a){m.attributes=a};b.hasAudio=function(){return!1!==m.audio&&void 0!==m.audio};b.hasVideo=function(){return!1!==m.video&&void 0!==m.video};b.hasData=function(){return!1!==m.data&&void 0!==m.data};b.hasScreen=function(){return m.screen};b.hasMedia=function(){return m.audio||m.video||m.screen};b.isExternal=function(){return void 0!==b.url||void 0!==b.recording};b.getMaxVideoBW=function(){return b.maxVideoBW};b.hasSimulcast=function(){return 1<Object.keys(r).length};
b.generateEncoderParameters=function(){for(var a=[],c=Object.keys(r).length||3,d=b.hasScreen()?1:2,e=1;e<=c;e+=1){var m=Object.assign({},r[e-1]);m.rid=e.toString();m.scaleResolutionDownBy=Math.pow(d,c-e);a.push(m)}return a};b.addPC=function(c,e,m){if(e)b.p2p=!0,void 0===b.pc&&(b.pc=Object(a.a)()),b.pc.add(e,c),c.on("ice-state-change",x);else if(b.pc&&(b.pc.off("add-stream",n),b.pc.off("remove-stream",A),b.pc.off("ice-state-change",x)),b.pc=c,b.pc.on("add-stream",n),b.pc.on("remove-stream",A),b.pc.on("ice-state-change",
x),m&&(d.debug("configureVideoStream",m),k=m.limitMaxAudioBW,g=m.limitMaxVideoBW,m.maxVideoBW&&t(m.maxVideoBW),b.local))if(c=m.simulcast,d.info("Initializing encoder simulcastConfig",c,"MaxVideoBW is ",b.maxVideoBW),c){c=c.numSpatialLayers;for(e=0;e<c;e+=1)r[e]={};b.maxVideoBW&&(d.debug("Setting maxVideoBW",b.maxVideoBW),r[c-1].maxBitrate=b.maxVideoBW)}else r[0]={maxBitrate:b.maxVideoBW}};b.sendData=function(a){b.local&&b.hasData()?b.emit(Object(q.f)({type:"internal-send-data",stream:b,msg:a})):d.error("message: Failed to send data, reason: Stream has not been published, "+
b.toLog())};b.sendToolsData=function(a){b.local&&b.hasData()?b.emit(Object(q.f)({type:"internal-send-tools-data",stream:b,msg:a})):d.error("message: Failed to send data, reason: Stream has not been published, "+b.toLog())};b.init=function(){try{if((m.audio||m.video||m.screen)&&void 0===m.url){d.debug("message: Requested access to local media, "+b.toLog());var a=m.video;!0===a||!0===m.screen?(a=!0===a||null===a?{}:a,void 0!==b.videoSize&&(a.width={min:b.videoSize[0],max:b.videoSize[2]},a.height={min:b.videoSize[1],
max:b.videoSize[3]}),void 0!==b.videoFrameRate&&(a.frameRate={min:b.videoFrameRate[0],max:b.videoFrameRate[1]})):!0===m.screen&&void 0===a&&(a=!0);b.ConnectionHelpers.GetUserMedia({video:a,audio:m.audio,fake:m.fake,screen:m.screen,extensionId:b.extensionId,desktopStreamId:b.desktopStreamId},function(a){d.debug("message: User has granted access to local media, "+b.toLog());b.stream=a;b.dispatchEvent(Object(q.f)({type:"access-accepted"}));a=0<b.stream.getVideoTracks().length;0<b.stream.getAudioTracks().length||
(m.audio=!1);a||(m.video=!1);b.stream.getTracks().forEach(function(a){d.debug("message: getTracks, track: "+a.kind+", "+b.toLog());a.onended=function(){b.stream.getTracks().forEach(function(a){a.onended=null});var c=Object(q.f)({type:"stream-ended",stream:b,msg:a.kind});b.dispatchEvent(c)}})},function(a){d.error("message: Failed to get access to local media, "+b.toLog()+", error: "+a.name+", message: "+a.message);a=Object(q.f)({type:"access-denied",msg:a});b.dispatchEvent(a)})}else{var c=Object(q.f)({type:"access-accepted"});
b.dispatchEvent(c)}}catch(B){d.error("message: Failed to get access to local media, "+b.toLog()+", error: "+B),a=Object(q.f)({type:"access-denied",msg:B}),b.dispatchEvent(a)}};b.close=function(){b.local&&(void 0!==b.room&&b.room.unpublish(b),b.hide(),void 0!==b.stream&&b.stream.getTracks().forEach(function(a){a.onended=null;a.stop()}),b.stream=void 0);b.pc&&!b.p2p?(b.pc.off("add-stream",n),b.pc.off("remove-stream",A),b.pc.off("ice-state-change",x)):b.pc&&b.p2p&&b.pc.forEach(function(a){a.off("add-stream",
n);a.off("remove-stream",A);a.off("ice-state-change",x)});b.removeAllListeners()};b.play=function(a,c){c=c||{};b.elementID=a;var d=b.stream&&0<b.stream.getVideoTracks().length,e=b.stream&&0<b.stream.getAudioTracks().length;d&&(b.hasVideo()||b.hasScreen())?void 0!==a&&(a=Object(l.a)({id:b.getID(),stream:b,elementID:a,options:c}),b.player=a,b.showing=!0):e&&b.hasAudio()&&(a=Object(p.a)({id:b.getID(),stream:b,elementID:a,options:c}),b.player=a,b.showing=!0)};b.stop=function(){if(b.showing&&void 0!==
b.player){try{b.player.destroy()}catch(E){d.warning("message: Exception when destroying Player, error: "+E.message+", "+b.toLog())}b.showing=!1}};b.show=b.play;b.hide=b.stop;var z=function(){if(void 0!==b.player&&void 0!==b.stream){var a=b.player.video,c=document.defaultView.getComputedStyle(a),d=parseInt(c.getPropertyValue("width"),10),e=parseInt(c.getPropertyValue("height"),10),m=parseInt(c.getPropertyValue("left"),10),c=parseInt(c.getPropertyValue("top"),10);var f="object"===typeof b.elementID&&
"function"===typeof b.elementID.appendChild?b.elementID:document.getElementById(b.elementID);var l=document.defaultView.getComputedStyle(f);f=parseInt(l.getPropertyValue("width"),10);var l=parseInt(l.getPropertyValue("height"),10),p=document.createElement("canvas");p.id="testing";p.width=f;p.height=l;p.setAttribute("style","display: none");p.getContext("2d").drawImage(a,m,c,d,e);return p}return null};b.getVideoFrameURL=function(a){var b=z();return null!==b?a?b.toDataURL(a):b.toDataURL():null};b.getVideoFrame=
function(){var a=z();return null!==a?a.getContext("2d").getImageData(0,0,a.width,a.height):null};b.checkOptions=function(a,c){a.maxVideoBW&&a.maxVideoBW>g&&(a.maxVideoBW=g);a.maxAudioBW&&a.maxAudioBW>k&&(a.maxAudioBW=k);if(!0===c){if(a.audio||a.screen)d.warning("message: Cannot update type of subscription, "+b.toLog()),a.audio=void 0,a.screen=void 0}else!1===b.local&&(!0===a.video&&!1===b.hasVideo()&&(d.warning("message: Trying to subscribe to video when there is no video, "+b.toLog()),a.video=!1),
!0===a.audio&&!1===b.hasAudio()&&(d.warning("message: Trying to subscribe to audio when there is no audio, "+b.toLog()),a.audio=!1));!1!==b.local||b.hasVideo()||!0!==a.slideShowMode||(d.warning("message: Cannot enable slideShowMode without video, "+b.toLog()),a.slideShowMode=!1)};var C=function(a){a=void 0===a?function(){}:a;if(b.room&&b.room.p2p)d.warning("message: muteAudio/muteVideo are not implemented in p2p streams, "+b.toLog()),a("error");else{b.stream&&b.pc||(d.warning("message: muteAudio/muteVideo cannot be called until a stream is published or subscribed, "+
b.toLog()),a("error"));for(var c=0;c<b.stream.getVideoTracks().length;c+=1)b.stream.getVideoTracks()[c].enabled=!b.videoMuted;c={muteStream:{audio:b.audioMuted,video:b.videoMuted}};b.checkOptions(c,!0);b.pc.updateSpec(c,b.getID(),a)}};b.muteAudio=function(a,c){b.audioMuted=a;C(void 0===c?function(){}:c)};b.muteVideo=function(a,c){b.videoMuted=a;C(void 0===c?function(){}:c)};b._setStaticQualityLayer=function(a,c,e){e=void 0===e?function(){}:e;b.room&&b.room.p2p?(d.warning("message: setStaticQualityLayer is not implemented in p2p streams, "+
b.toLog()),e("error")):(a={qualityLayer:{spatialLayer:a,temporalLayer:c}},b.checkOptions(a,!0),b.pc.updateSpec(a,b.getID(),e))};b._setDynamicQualityLayer=function(a){if(b.room&&b.room.p2p)d.warning("message: setDynamicQualityLayer is not implemented in p2p streams, "+b.toLog()),a("error");else{var c={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};b.checkOptions(c,!0);b.pc.updateSpec(c,b.getID(),a)}};b._enableSlideShowBelowSpatialLayer=function(a,c,e){c=void 0===c?0:c;e=void 0===e?function(){}:e;
b.room&&b.room.p2p?(d.warning("message: enableSlideShowBelowSpatialLayer is not implemented in p2p streams, "+b.toLog()),e("error")):(a={slideShowBelowLayer:{enabled:a,spatialLayer:c}},b.checkOptions(a,!0),d.debug("message: Calling updateSpec, "+b.toLog()+", config: "+JSON.stringify(a)),b.pc.updateSpec(a,b.getID(),e))};b._setMinSpatialLayer=b._enableSlideShowBelowSpatialLayer.bind(f,!0);var D=function(a,c,d){!0!==c&&(c=!1);a="string"===typeof a?[a]:a;a=a instanceof Array?a:[];0<a.length&&b.room.sendControlMessage(b,
"control",{name:"controlhandlers",enable:d,publisherSide:c,handlers:a})};b.disableHandlers=function(a,c){D(a,c,!1)};b.enableHandlers=function(a,c){D(a,c,!0)};var y=function(a,c,b){b=void 0===b?function(){return!0}:b;Object.keys(c).forEach(function(e){var m=c[e];r[e]||d.warning("Cannot set parameter "+a+" for layer "+e+", it does not exist");b(m)&&(r[e][a]=m)})};b.updateSimulcastLayersBitrate=function(a){if(b.pc&&b.local){var c=Object.assign({},a);Object.keys(c).forEach(function(a){if(c[a]>b.maxVideoBW||
void 0===c[a])d.info("message: updateSimulcastLayersBitrate defaulting to max bitrate,"+(", layer :"+a+", requested: "+c[a]+", max: "+b.maxVideoBW)),c[a]=b.maxVideoBW});y("maxBitrate",c);b.applySenderEncoderParameters()}};b.updateSimulcastActiveLayers=function(a){b.pc&&b.local&&(y("active",a,function(a){return!0===a||!1===a}),b.applySenderEncoderParameters())};b.updateConfiguration=function(a,c){c=void 0===c?function(){}:c;if(void 0!==a)if(b.pc)if(b.checkOptions(a,!0),b.local)if(a.maxVideoBW&&(t(a.maxVideoBW),
b.applySenderEncoderParameters()),b.room.p2p)for(var d=0;d<b.pc.length;d+=1)b.pc[d].updateSpec(a,b.getID(),c);else b.pc.updateSpec(a,b.getID(),c),a.maxVideoBW&&t(a.maxVideoBW);else b.pc.updateSpec(a,b.getID(),c);else c("This stream has no peerConnection attached, ignoring")};return b}},function(n,k,g){var f=g(8),q=g(72);k.a=function(h){var a=Object(f.a)({}),e;a.elementID=h.elementID;a.id=h.id;a.div=document.createElement("div");a.div.setAttribute("id","bar_"+a.id);a.div.setAttribute("class","licode_bar");
a.bar=document.createElement("div");a.bar.setAttribute("style","width: 100%; height: 15%; max-height: 30px; position: absolute; bottom: 0; right: 0; background-color: rgba(255,255,255,0.62)");a.bar.setAttribute("id","subbar_"+a.id);a.bar.setAttribute("class","licode_subbar");a.link=document.createElement("a");a.link.setAttribute("href","http://www.lynckia.com/");a.link.setAttribute("class","licode_link");a.link.setAttribute("target","_blank");a.logo=document.createElement("img");a.logo.setAttribute("style",
"width: 100%; height: 100%; max-width: 30px; position: absolute; top: 0; left: 2px;");a.logo.setAttribute("class","licode_logo");a.logo.setAttribute("alt","Lynckia");a.logo.setAttribute("src",a.url+"/assets/star.svg");var l=function(f){var d=f;"block"!==f?d="none":clearTimeout(e);a.div.setAttribute("style","width: 100%; height: 100%; position: relative; bottom: 0; right: 0; display: "+d)};a.display=function(){l("block")};a.hide=function(){e=setTimeout(l,1E3)};document.getElementById(a.elementID).appendChild(a.div);
a.div.appendChild(a.bar);a.bar.appendChild(a.link);a.link.appendChild(a.logo);h.stream.screen||void 0!==h.options&&void 0!==h.options.speaker&&!0!==h.options.speaker||(a.speaker=Object(q.a)({elementID:"subbar_"+a.id,id:a.id,stream:h.stream,media:h.media}));a.display();a.hide();return a}},function(n,k,g){n=function(){for(var f,g,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),a=[],e=0;e<h.length;e+=1)a[h[e]]=e;var l=function(){if(!f||g>=f.length)return-1;var a=f.charCodeAt(g)&
255;g+=1;return a},p=function(){if(!f)return-1;for(;;){if(g>=f.length)return-1;var c=f.charAt(g);g+=1;if(a[c])return a[c];if("A"===c)return 0}},d=function(a){a=a.toString(16);1===a.length&&(a="0"+a);return unescape("%"+a)};return{encodeBase64:function(a){var c;f=a;g=0;a="";var b=Array(3);var d=0;for(c=!1;!c&&-1!==(b[0]=l());)b[1]=l(),b[2]=l(),a+=h[b[0]>>2],-1!==b[1]?(a+=h[b[0]<<4&48|b[1]>>4],-1!==b[2]?(a+=h[b[1]<<2&60|b[2]>>6],a+=h[b[2]&63]):(a+=h[b[1]<<2&60],a+="\x3d",c=!0)):(a+=h[b[0]<<4&48],a+=
"\x3d",a+="\x3d",c=!0),d+=4,76<=d&&(a+="\n",d=0);return a},decodeBase64:function(a){var c;f=a;g=0;a="";var b=Array(4);for(c=!1;!c&&-1!==(b[0]=p())&&-1!==(b[1]=p());)b[2]=p(),b[3]=p(),a+=d(b[0]<<2&255|b[1]>>4),-1!==b[2]?(a+=d(b[1]<<4&255|b[2]>>2),-1!==b[3]?a+=d(b[2]<<6&255|b[3]):c=!0):c=!0;return a}}}();k.a=n},function(n,k,g){Object.defineProperty(k,"__esModule",{value:!0});n=g(38);var f=g(36),q=g(16),h=g(1),a=g(34),e=g(0);g(74);g={Room:n.a.bind(null,void 0,void 0,void 0),LicodeEvent:h.d,RoomEvent:h.e,
StreamEvent:h.f,ConnectionEvent:h.a,Stream:a.a.bind(null,void 0),Logger:e.a,_:{ErizoConnectionManager:q.a,Room:n.a,Base64:f.a}};k["default"]=g},function(n,k,g){var f=this,q=g(16),h=g(10),a=g(1),e=g(44),l=g(34),p=g(9),d=g(36),c=g(0).a.module("Room");k.a=function(m,b,g,k){var r=Object(a.b)(k);r.remoteStreams=Object(p.a)();r.localStreams=Object(p.a)();r.roomID="";r.state=0;r.p2p=!1;r.minConnectionQualityLevel="";r.ConnectionHelpers=void 0===b?h.a:b;r.erizoConnectionManager=void 0===g?new q.a:new g.ErizoConnectionManager;
r.disableIceRestart=!!k.disableIceRestart;var u=Object(e.a)(m);r.socket=u;var n=r.remoteStreams,v=r.localStreams,t=function(){return"roomId: "+(0<r.roomID.length?r.roomID:"undefined")},z=function(a){a.removeAllListeners();a.pc&&!r.p2p&&a.pc.removeStream(a);c.debug("message: Removed stream, "+a.toLog()+", "+t());a.stream&&(a.hide(),a.stop(),a.close(),delete a.stream);a.pc&&(a.local&&r.p2p?a.pc.forEach(function(c,b){c.close();a.pc.remove(b)}):(r.erizoConnectionManager.maybeCloseConnection(a.pc),delete a.pc))},
C=function(b,d){c.info("message: Stream subscribed, "+b.toLog()+", "+t());b.stream=d.stream;r.p2p||b.pc.addStream(b);b.state="subscribed";b=Object(a.f)({type:"stream-subscribed",stream:b});r.dispatchEvent(b)},D=function(b){c.debug("message: Unsubscribing Stream, "+b.toLog()+", unsubscribing: "+b.unsubscribing+", "+t());b&&b.unsubscribing.callbackReceived&&(b.unsubscribing.pcEventReceived||b.failed)?(c.info("message: Stream fully unsubscribed, "+b.toLog()+", "+t()),b.unsubscribing.callbackReceived=
!1,b.unsubscribing.pcEventReceived=!1,z(b),delete b.failed,b.state="unsubscribed",b=Object(a.f)({type:"stream-unsubscribed",stream:b}),r.dispatchEvent(b)):c.debug("message: Not dispatching stream unsubscribed yet, "+b.toLog()+", "+t())},y=function(b,c,d,e){0!==r.state&&b&&!b.failed&&(b.failed=!0,c=Object(a.f)({type:"stream-failed",msg:c||"Stream failed after connection",stream:b,origin:void 0===d?"unknown":d,wasAbleToConnect:void 0===e?!1:e}),r.dispatchEvent(c),c=b.pc,b.local?r.unpublish(b):b.unsubscribing.callbackReceived?
D(b):r.unsubscribe(b),c&&k.singlePC&&r.erizoConnectionManager.maybeCloseConnection(c,!0))},E=function(a,b){return{callback:function(c,d){u.sendSDP("streamMessageP2P",{streamId:a.getID(),streamIds:d,peerSocket:b,msg:c})},audio:a.hasAudio(),video:a.hasVideo(),iceServers:r.iceServers,maxAudioBW:a.maxAudioBW,maxVideoBW:a.maxVideoBW,limitMaxAudioBW:k.maxAudioBW,limitMaxVideoBW:k.maxVideoBW,forceTurn:a.forceTurn,p2p:!0,disableIceRestart:r.disableIceRestart}},F=function(a,b){b=E(a,b);var d=r.erizoConnectionManager.getOrBuildErizoConnection(b);
a.addPC(d,!1,b);d.on("connection-failed",r.dispatchEvent.bind(f));a.on("added",C.bind(null,a));a.on("icestatechanged",function(b){c.debug("message: icestatechanged, "+a.toLog()+", iceConnectionState: "+b.msg.state+", "+t());"failed"===b.msg.state&&y(a,"ICE Connection Failed","ice-client",b.msg.wasAbleToConnect)})},B=function(a,b){var d=r.erizoConnectionManager.getOrBuildErizoConnection(E(a,b));a.addPC(d,b);d.on("connection-failed",r.dispatchEvent.bind(f));a.on("icestatechanged",function(d){c.debug("message: icestatechanged, streamId: "+
a.getID()+", iceConnectionState: "+d.msg.state+", "+t());"failed"===d.msg.state&&(a.pc.get(b).close(),a.pc.remove(b))});d.addStream(a)},Q=function(a){r.remoteStreams.forEach(function(b){b.local||b.getLabel()!==a||(b.unsubscribing.pcEventReceived=!0,D(b))})},G=function(a,b,c,d,e){var m={callback:function(d,e){e=void 0===e?a.getID():e;d&&d.type&&"updatestream"===d.type?u.sendSDP("streamMessage",{streamId:e,erizoId:c,msg:d,browser:a.pc&&a.pc.browser},void 0,function(){}):u.sendSDP("connectionMessage",
{connectionId:b,erizoId:c,msg:d,browser:a.pc&&a.pc.browser},void 0,function(){})},connectionId:b,nop2p:!0,audio:d.audio&&a.hasAudio(),video:d.video&&a.hasVideo(),maxAudioBW:d.maxAudioBW,maxVideoBW:d.maxVideoBW,simulcast:d.simulcast,limitMaxAudioBW:k.maxAudioBW,limitMaxVideoBW:k.maxVideoBW,label:a.getLabel(),iceServers:r.iceServers,disableIceRestart:r.disableIceRestart,forceTurn:a.forceTurn,p2p:!1,streamRemovedListener:Q,isRemote:e};e||(m.startVideoBW=d.startVideoBW,m.hardMinVideoBW=d.hardMinVideoBW);
return m},I=function(a,b,d,e){var m=G(a,b,d,e,!0);b=r.erizoConnectionManager.getOrBuildErizoConnection(m,d,k.singlePC);a.addPC(b,!1,m);b.on("connection-failed",r.dispatchEvent.bind(f));a.on("added",C.bind(null,a));a.on("icestatechanged",function(b){c.debug("message: icestatechanged, "+a.toLog()+", iceConnectionState: "+b.msg.state+", "+t());"failed"===b.msg.state&&(y(a,"ICE Connection Failed","ice-client",b.msg.wasAbleToConnect),k.singlePC&&m.callback({type:"failed"}))})},J=function(a,b,d,e){var m=
G(a,b,d,e);b=r.erizoConnectionManager.getOrBuildErizoConnection(m,d,k.singlePC);a.addPC(b,!1,e);b.on("connection-failed",r.dispatchEvent.bind(f));a.on("icestatechanged",function(b){c.debug("message: icestatechanged, "+a.toLog()+", iceConnectionState: "+b.msg.state+", "+t());"failed"===b.msg.state&&(y(a,"ICE Connection Failed","ice-client",b.msg.wasAbleToConnect),k.singlePC&&m.callback({type:"failed"}))});a.pc.addStream(a)},O=function(b){var c=b.evt.level,d=Number.MAX_SAFE_INTEGER,e="";v.forEach(function(a){!a.failed&&
a.pc&&(a.pc.connectionId===b.connectionId&&a.pc.setQualityLevel(c),a=a.pc.getQualityLevel(),a.index<d&&(d=a.index,e=a.message))});n.forEach(function(a){a.failed&&a.pc&&(a.pc.connectionId===b.connectionId&&a.pc.setQualityLevel(c),a=a.pc.getQualityLevel(),a.index<d&&(d=a.index,e=a.message))});e!==r.minConnectionQualityLevel&&(r.minConnectionQualityLevel=e,r.dispatchEvent(Object(a.e)({type:"quality-level",message:e})))},M=function(a){var b=a.stream;a=a.msg;b.local?u.sendMessage("sendDataStream",{id:b.getID(),
msg:a}):c.error("message: You can not send data through a remote stream, "+b.toLog()+", "+t())},P=function(a){var b=a.stream;a=a.msg;b.local?u.sendMessage("sendToolsDataStream",{id:b.getID(),msg:a}):c.error("message: You can not send data through a remote stream, "+b.toLog()+", "+t())},R=function(a){var b=a.stream;a=a.attrs;b.local?(b.updateLocalAttributes(a),u.sendMessage("updateStreamAttributes",{id:b.getID(),attrs:a})):c.error("message: You can not update attributes in a remote stream, "+b.toLog()+
", "+t())};m=function(a,b){b.args?a.apply(null,[].concat($jscomp.arrayFromIterable(b.args))):a()};var L=function(a,b,c){return{state:a,data:b.hasData(),audio:b.hasAudio(),video:b.hasVideo(),label:b.getLabel(),screen:b.hasScreen(),attributes:b.getAttributes(),metadata:c.metadata,createOffer:c.createOffer,muteStream:c.muteStream,encryptTransport:void 0===c.encryptTransport?!0:c.encryptTransport,handlerProfile:c.handlerProfile}},N=function(a,b,d,e){e=void 0===e?function(){}:e;null===a?(c.error("message: Error when publishing the stream, "+
b.toLog()+", "+t()+", error: "+d),e(void 0,d)):(c.info("message: Stream published, "+b.toLog()+", "+t()),b.getID=function(){return a},b.on("internal-send-data",M),b.on("internal-set-attributes",R),b.on("internal-send-tools-data",P),v.add(a,b),b.room=r,e(a))},S=function(a,b,d){d=void 0===d?function(){}:d;if(a.url){var e="url";var m=a.url}else e="recording",m=a.recording;c.debug("message: Checking publish options, "+a.toLog()+", "+t());a.checkOptions(b);u.sendSDP("publish",L(e,a,b),m,function(b,c){N(b,
a,c,d)})},T=function(a,b,c){c=void 0===c?function(){}:c;a.maxAudioBW=b.maxAudioBW;a.maxVideoBW=b.maxVideoBW;u.sendSDP("publish",L("p2p",a,b),void 0,function(b,d){N(b,a,d,c)})},U=function(a,b,c){c=void 0===c?function(){}:c;u.sendSDP("publish",L("data",a,b),void 0,function(b,d){N(b,a,d,c)})},W=function(a,b,d){d=void 0===d?function(){}:d;c.debug("message: Publishing to Erizo Normally, createOffer: "+b.createOffer+", "+t());var e=L("erizo",a,b);e.minVideoBW=b.minVideoBW;e.maxVideoBW=b.maxVideoBW;e.scheme=
b.scheme;u.sendSDP("publish",e,void 0,function(e,m,f,l){null===e?(c.error("message: Error publishing stream, "+a.toLog()+", "+t()+", error: "+l),d(void 0,l)):(N(e,a,l,void 0),J(a,f,m,b),d(e))})},X=function(a,b){a=b&&a.hasVideo();var c=b&&b.width,d=b&&b.height;b=b&&b.frameRate;return c||d||b?{width:c,height:d,frameRate:b}:a},w=function(a,b,d){d=void 0===d?function(){}:d;b.maxVideoBW=b.maxVideoBW||k.defaultVideoBW;b.maxVideoBW>k.maxVideoBW&&(b.maxVideoBW=k.maxVideoBW);b.audio=void 0===b.audio?!0:b.audio;
b.video=void 0===b.video?!0:b.video;b.data=void 0===b.data?!0:b.data;b.encryptTransport=void 0===b.encryptTransport?!0:b.encryptTransport;a.checkOptions(b);var e={streamId:a.getID(),audio:b.audio&&a.hasAudio(),video:X(a,b.video),maxVideoBW:b.maxVideoBW,data:b.data&&a.hasData(),browser:r.ConnectionHelpers.getBrowser(),createOffer:b.createOffer,metadata:b.metadata,muteStream:b.muteStream,encryptTransport:b.encryptTransport,slideShowMode:b.slideShowMode,handlerProfile:b.handlerProfile};u.sendSDP("subscribe",
e,void 0,function(e,m,f,l){null===e?(c.error("message: Error subscribing to stream, "+a.toLog()+", "+t()+", error: "+l),a.state="unsubscribed",d(void 0,l)):(c.debug("message: Subscriber added, "+a.toLog()+", "+t()+", erizoId: "+m+", connectionId: "+f),I(a,f,m,b),d(!0))})},H=function(b,d,e){e=void 0===e?function(){}:e;u.sendSDP("subscribe",{streamId:b.getID(),data:d.data,metadata:d.metadata},void 0,function(d,m){null===d?(c.error("message: Error subscribing to stream, "+b.toLog()+", "+t()+", error: "+
m),b.state="unsubscribed",e(void 0,m)):(c.debug("message: Stream subscribed, "+b.toLog()+", "+t()),d=Object(a.f)({type:"stream-subscribed",stream:b}),r.dispatchEvent(d),e(!0))})};r.connect=function(b){b=void 0===b?{}:b;var e=JSON.parse(d.a.decodeBase64(k.token));0!==r.state&&c.warning("message: Room already connected, roomId: "+r.roomID+", "+t());r.state=1;r.clientIntiatedDisconnection=!1;c.info("message: Connecting to room, tokenId: "+e.tokenId);u.connect(e,b,function(b){var d=[],e=b.streams||[],
m=b.id;r.p2p=b.p2p;r.iceServers=b.iceServers;r.state=2;k.singlePC=b.singlePC;k.defaultVideoBW=b.defaultVideoBW;k.maxVideoBW=b.maxVideoBW;r.streamPriorityStrategy=b.streamPriorityStrategy;r.connectionTargetBw=b.connectionTargetBw;for(var f=Object.keys(e),p=0;p<f.length;p+=1){var h=e[f[p]];b=Object(l.a)(r.ConnectionHelpers,{streamID:h.id,local:!1,audio:h.audio,video:h.video,data:h.data,label:h.label,screen:h.screen,attributes:h.attributes});b.room=r;b.state="unsubscribed";d.push(b);n.add(h.id,b)}r.roomID=
m;c.info("message: Connected to room, "+t());d=Object(a.e)({type:"room-connected",streams:d});r.dispatchEvent(d)},function(b){c.error("message: Error connecting to room, "+t()+", error: "+b+", token: "+e);b=Object(a.e)({type:"room-error",message:b});r.dispatchEvent(b)})};r.disconnect=function(){c.info("message: Disconnection requested, "+t());var b=Object(a.e)({type:"room-disconnected",message:"expected-disconnection"});r.clientIntiatedDisconnection=!0;r.dispatchEvent(b)};r.publish=function(a,b,d){b=
void 0===b?{}:b;d=void 0===d?function(){}:d;c.info("message: Publishing stream, "+a.toLog()+", "+t());b.maxVideoBW=b.maxVideoBW||k.defaultVideoBW;b.limitMaxVideoBW=k.maxVideoBW;b.limitMaxAudioBW=k.maxAudioBW;b.maxVideoBW>k.maxVideoBW&&(b.maxVideoBW=k.maxVideoBW);void 0===b.minVideoBW&&(b.minVideoBW=0);b.minVideoBW>k.defaultVideoBW&&(b.minVideoBW=k.defaultVideoBW);a.forceTurn=b.forceTurn;b.simulcast=b.simulcast||!1;b.handlerProfile=b.handlerProfile||null;b.muteStream={audio:a.audioMuted,video:a.videoMuted};
a&&a.local&&!a.failed&&!v.has(a.getID())?a.hasMedia()?a.isExternal()?S(a,b,d):r.p2p?T(a,b,d):W(a,b,d):a.hasData()&&U(a,b,d):(c.error("message: Trying to publish invalid stream, "+a.toLog()+", "+t()),d(void 0,"Invalid Stream"))};r.startRecording=function(a,b){b=void 0===b?function(){}:b;void 0===a?(c.error("message: Trying to start recording on an invalid stream, "+a.toLog()+", "+t()),b(void 0,"Invalid Stream")):(c.debug("message: Start Recording stream, "+a.toLog()+", "+t()),u.sendMessage("startRecorder",
{to:a.getID()},function(d,e){null===d?(c.error("message: Error on start recording, "+a.toLog()+", "+t()+", error: "+e),b(void 0,e)):(c.debug("message: Start recording, id: "+d+", "+t()),b(d))}))};r.stopRecording=function(a,b){b=void 0===b?function(){}:b;u.sendMessage("stopRecorder",{id:a},function(d,e){null===d?(c.error("message: Error on stop recording, recordingId: "+a+", "+t()+", error: "+e),b(void 0,e)):(c.debug("message: Stop recording, id: "+a+", "+t()),b(!0))})};r.unpublish=function(a,b){b=
void 0===b?function(){}:b;var d=r.localStreams.get(a.getID());d&&d.local?(u.sendMessage("unpublish",d.getID(),function(a,e){null===a?(c.error("message: Error unpublishing stream, "+d.toLog()+", "+t()+", error: "+e),b(void 0,e)):(c.info("message: Stream unpublished, "+d.toLog()+", "+t()),delete d.failed,b(!0))}),c.info("message: Unpublishing stream, "+d.toLog()+", "+t()),d.room=void 0,d.hasMedia()&&!d.isExternal()&&(a=v.has(d.getID())?v.get(d.getID()):d,z(a)),v.remove(d.getID()),d.getID=function(){},
d.off("internal-send-data",M),d.off("internal-set-attributes",R),d.off("internal-send-tools-data",P)):(a="message: Cannot unpublish because stream does not exist or is not local, "+d.toLog()+", "+t(),c.error(a),b(void 0,a))};r.sendControlMessage=function(a,b,c){a&&a.getID()&&(b={type:"control",action:c},u.sendSDP("streamMessage",{streamId:a.getID(),msg:b}))};r.subscribe=function(a,b,d){b=void 0===b?{}:b;d=void 0===d?function(){}:d;a=r.remoteStreams.get(a.getID());if(!a||a.local||a.failed)b="Error on subscribe",
a.state="unsubscribed",a?a.local?(c.warning("message: Cannot subscribe to local stream, "+a.toLog()+", "+t()),b="Local copy of stream"):a.failed&&(c.warning("message: Cannot subscribe to failed stream, "+a.toLog()+", "+t()+","+("unsubscribing: "+a.unsubscribing+", failed: "+a.failed)),b="Failed stream"):(c.warning("message: Cannot subscribe to invalid stream, "+a.toLog()+", "+t()),b="Invalid or undefined stream"),d(void 0,b);else if("unsubscribed"!==a.state&&"unsubscribing"!==a.state)c.warning("message: Cannot subscribe to a subscribed stream, "+
a.toLog()+", "+t()),d(void 0,"Stream already subscribed");else{a.state="subscribing";if(a.hasMedia())if(a.hasVideo()||a.hasScreen()||(b.video=!1),a.hasAudio()||(b.audio=!1),b.muteStream={audio:a.audioMuted,video:a.videoMuted},a.forceTurn=b.forceTurn,r.p2p){var e=n.get(a.getID());e.maxAudioBW=b.maxAudioBW;e.maxVideoBW=b.maxVideoBW;u.sendSDP("subscribe",{streamId:a.getID(),metadata:b.metadata});d(!0)}else w(a,b,d);else if(a.hasData()&&!1!==b.data)H(a,b,d);else{c.warning("message: There is nothing to subscribe to in stream, "+
a.toLog()+", "+t());a.state="unsubscribed";d(void 0,"Nothing to subscribe to");return}c.info("message: Subscribing to stream, "+a.toLog()+", "+t())}};r.unsubscribe=function(a,b){b=void 0===b?function(){}:b;var d=r.remoteStreams.get(a.getID());void 0!==u&&(d&&!d.local?"subscribed"!==d.state&&"subscribing"!==d.state?(c.warning("message: Cannot unsubscribe to a stream that is not subscribed, "+d.toLog()+", "+t()),b(void 0,"Stream not subscribed")):(d.state="unsubscribing",c.info("message: Unsubscribing stream, "+
d.toLog()+", "+t()),u.sendMessage("unsubscribe",d.getID(),function(a,c){null===a?(d.state="subscribed",b(void 0,c)):(b(!0),d.unsubscribing.callbackReceived=!0,D(d))},function(){d.state="subscribed";c.error("message: Error calling unsubscribe, "+d.toLog()+", "+t())})):(d.state="unsubscribed",b(void 0,"Error unsubscribing, stream does not exist or is not local")))};r.getStreamStats=function(a,b){b=void 0===b?function(){}:b;if(!u)return"Error getting stats - no socket";if(!a)return"Error getting stats - no stream";
u.sendMessage("getStreamStats",a.getID(),function(a){a&&b(a)})};r.getStreamsByAttribute=function(a,b){var c=[];n.forEach(function(d){void 0!==d.getAttributes()&&d.getAttributes()[a]===b&&c.push(d)});return c};r.setStreamPriorityStrategy=function(a,b){b=void 0===b?function(){}:b;u.sendMessage("setStreamPriorityStrategy",a,function(c){r.streamPriorityStrategy=a;c&&b(c)})};r.setConnectionTargetBandwidth=function(a,b){b=void 0===b?function(){}:b;u.sendMessage("setConnectionTargetBandwidth",a,function(c){r.connectionTargetBw=
a;c&&b(c)})};r.on("room-disconnected",function(){r.state=0;u.state=u.DISCONNECTED;r.erizoConnectionManager.ErizoConnectionsMap.forEach(function(a){Object.keys(a).forEach(function(b){a[b].close()})});n.forEach(function(b,c){z(b);n.remove(c);b&&!b.failed&&(b=Object(a.f)({type:"stream-removed",stream:b}),r.dispatchEvent(b))});n=Object(p.a)();v.forEach(function(a,b){z(a);v.remove(b)});v=Object(p.a)();try{u.disconnect(r.clientIntiatedDisconnection)}catch(V){c.debug("message: Socket already disconnected, "+
t()+", error: "+V)}c.info("message: Disconnected from room, roomId: "+r.roomID+", "+t());u=void 0});u.on("onAddStream",m.bind(null,function(b){if(!n.has(b.id)){var c=Object(l.a)(r.Connection,{streamID:b.id,local:v.has(b.id),audio:b.audio,video:b.video,data:b.data,label:b.label,screen:b.screen,attributes:b.attributes});c.room=r;c.state="unsubscribed";n.add(b.id,c);b=Object(a.f)({type:"stream-added",stream:c});r.dispatchEvent(b)}}));u.on("stream_message_erizo",m.bind(null,function(a){c.debug("message: Failed applying a stream message from erizo, "+
t()+", msg: "+JSON.stringify(a))}));u.on("stream_message_p2p",m.bind(null,function(a){var b=v.get(a.streamId);b&&!b.failed?b.pc.get(a.peerSocket).processSignalingMessage(a.msg):(b=n.get(a.streamId),b.pc||F(b,a.peerSocket),b.pc.processSignalingMessage(a.msg))}));u.on("connection_message_erizo",m.bind(null,function(a){if("quality_level"===a.evt.type)O(a);else{var b=r.erizoConnectionManager.getErizoConnection(a.connectionId);b?b.processSignalingMessage(a.evt):c.warning("message: Received signaling message to unknown connectionId, connectionId: "+
a.connectionId+", "+t())}}));u.on("publish_me",m.bind(null,function(a){var b=v.get(a.streamId);B(b,a.peerSocket)}));u.on("unpublish_me",m.bind(null,function(a){var b=v.get(a.streamId);b&&(a=a.peerSocket,void 0!==b.pc&&b.pc.has(a)&&(b.pc.get(a).close(),b.pc.remove(a)))}));u.on("onBandwidthAlert",m.bind(null,function(b){c.debug("message: Bandwidth Alert, streamId: "+b.streamID+", bwMessage: "+b.message+", bandwidth: "+b.bandwidth+", "+t());if(b.streamID){var d=n.get(b.streamID);d&&!d.failed&&(b=Object(a.f)({type:"bandwidth-alert",
stream:d,msg:b.message,bandwidth:b.bandwidth}),d.dispatchEvent(b))}}));u.on("onDataStream",m.bind(null,function(b){var c=n.get(b.id);b=Object(a.f)({type:"stream-data",msg:b.msg,stream:c});c.dispatchEvent(b)}));u.on("onUpdateAttributeStream",m.bind(null,function(b){var c=n.get(b.id),d=Object(a.f)({type:"stream-attributes-update",attrs:b.attrs,stream:c});c.updateLocalAttributes(b.attrs);c.dispatchEvent(d)}));u.on("onRemoveStream",m.bind(null,function(b){var d=v.get(b.id);if(d)y(d,"Stream removed from server",
"server");else if(d=n.get(b.id))c.info("message: Stream removed, "+d.toLog()+", "+t()),z(d),n.remove(b.id),b=Object(a.f)({type:"stream-removed",stream:d}),r.dispatchEvent(b)}));u.on("disconnect",m.bind(null,function(){c.info("message: Socket disconnected, reason: lost connection to ErizoController, "+t());if(0!==r.state){c.error("message: Unexpected disconnection from ErizoController, "+t());var b=Object(a.e)({type:"room-disconnected",message:"unexpected-disconnection"});r.dispatchEvent(b)}}));u.on("reconnecting",
m.bind(null,function(b){c.info("message: Socket reconnecting, reason: lost connection to ErizoController, "+t());b=Object(a.e)({type:"room-reconnecting",message:"reconnecting - "+b});r.dispatchEvent(b)}));u.on("reconnected",m.bind(null,function(){c.info("message: Socket reconnected, reason: restablished connection to ErizoController, "+t());var b=Object(a.e)({type:"room-reconnected",message:"reconnected"});r.dispatchEvent(b)}));u.on("connection_failed",m.bind(null,function(a){if(a.streamId){var b=
"message: ICE Connection Failed, type: "+a.type+", streamId: "+a.streamId+", state: "+r.state+", "+t();c.error(b);a="publish"===a.type?v.get(a.streamId):n.get(a.streamId);y(a,b,"ice-server")}}));u.on("error",m.bind(null,function(b){c.error("message: Error in the connection to Erizo Controller, "+t()+", error: "+b);b=Object(a.e)({type:"room-error",message:b});r.dispatchEvent(b)}));u.on("member_join",m.bind(null,function(b){b=Object(a.e)({type:"member_join",message:b});r.dispatchEvent(b)}));u.on("member_leave",
m.bind(null,function(b){b=Object(a.e)({type:"member_leave",message:b});r.dispatchEvent(b)}));u.on("group_create",m.bind(null,function(b){b=Object(a.e)({type:"group_create",message:b});r.dispatchEvent(b)}));u.on("group_invite",m.bind(null,function(b){b=Object(a.e)({type:"group_invite",message:b});r.dispatchEvent(b)}));u.on("group_join",m.bind(null,function(b){b=Object(a.e)({type:"group_join",message:b});r.dispatchEvent(b)}));u.on("group_kickoff",m.bind(null,function(b){b=Object(a.e)({type:"group_kickoff",
message:b});r.dispatchEvent(b)}));u.on("group_leave",m.bind(null,function(b){b=Object(a.e)({type:"group_leave",message:b});r.dispatchEvent(b)}));u.on("group_dismiss",m.bind(null,function(b){b=Object(a.e)({type:"group_dismiss",message:b});r.dispatchEvent(b)}));u.on("subroom_create",m.bind(null,function(b){b=Object(a.e)({type:"subroom_create",message:b});r.dispatchEvent(b)}));u.on("subroom_join",m.bind(null,function(b){b=Object(a.e)({type:"subroom_join",message:b});r.dispatchEvent(b)}));u.on("subroom_leave",
m.bind(null,function(b){b=Object(a.e)({type:"subroom_leave",message:b});r.dispatchEvent(b)}));u.on("subroom_delete",m.bind(null,function(b){b=Object(a.e)({type:"subroom_delete",message:b});r.dispatchEvent(b)}));return r}},function(n,k,g){k.a={addSim:function(f){var g="a\x3dssrc-group:SIM";f.forEach(function(f){g+=" "+f});return g+"\r\n"},addGroup:function(f,g){return"a\x3dssrc-group:FID "+f+" "+g+"\r\n"},addSpatialLayer:function(f,g,h,a,e,l){return"a\x3dssrc:"+e+" cname:"+f+"\r\n"+("a\x3dssrc:"+e+
" msid:"+g+"\r\n")+("a\x3dssrc:"+e+" mslabel:"+h+"\r\n")+("a\x3dssrc:"+e+" label:"+a+"\r\n")+("a\x3dssrc:"+l+" cname:"+f+"\r\n")+("a\x3dssrc:"+l+" msid:"+g+"\r\n")+("a\x3dssrc:"+l+" mslabel:"+h+"\r\n")+("a\x3dssrc:"+l+" label:"+a+"\r\n")},setMaxBW:function(f,g){if(g.p2p){if(g.video&&g.maxVideoBW){var h=f.getMedia("video");h&&h.setBitrate(g.maxVideoBW)}g.audio&&g.maxAudioBW&&(f=f.getMedia("audio"))&&f.setBitrate(g.maxAudioBW)}},enableOpusNacks:function(f){var g=f.match(/a=rtpmap:(.*)opus.*\r\n/);null!==
g&&(f=f.replace(g[0],g[0]+"a\x3drtcp-fb:"+g[1]+"nack\r\n"));return f},setParamForCodecs:function(f,g,h,a){f.medias.forEach(function(e){e.id===g&&e.codecs.forEach(function(e){e.setParam(h,a)})})}}},function(n,k,g){n=g(0);var f=g(17),q=n.a.module("SafariStack");k.a=function(h){q.debug("message: Starting Safari stack");var a=Object(f.a)(h);a._updateTracksToBeNegotiatedFromStream=function(){a.tracksToBeNegotiated+=1};return a}},function(n,k,g){n=g(0);var f=g(18),q=n.a.module("FirefoxStack");k.a=function(h){q.debug("message: Starting Firefox stack");
var a=Object(f.a)(h);a.addStream=function(e){var f=e.stream;f.transceivers=[];f.getTracks().forEach(function(l){return $jscomp.executeAsyncGenerator(function(){function d(d,h){for(;;)switch(c){case 0:return p={},"video"===l.kind&&e.simulcast&&(p={sendEncodings:[]}),p.streams=[f],b=a.peerConnection.addTransceiver(l,p),f.transceivers.push(b),m=b.sender.getParameters()||{},m.encodings=e.generateEncoderParameters(),c=-1,{value:b.sender.setParameters(m),done:!0};default:return{value:void 0,done:!0}}}var c=
0,m,b,p,h={next:function(a){return d(a,void 0)},throw:function(a){return d(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();h[Symbol.iterator]=function(){return this};return h}())})};a.prepareCreateOffer=function(){return Promise.resolve()};return a}},function(n,k,g){var f=g(0).a.module("FcStack");k.a=function(g){var h={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,close:function(){f.debug("message: Close FcStack")},createOffer:function(){f.debug("message: CreateOffer")},
addStream:function(a){f.debug("message: addStream, "+a.toLog())},processSignalingMessage:function(a){f.debug("message: processSignaling, message: "+a);void 0!==h.signalCallback&&h.signalCallback(a)},sendSignalingMessage:function(a){f.debug("message: Sending signaling Message, message: "+a);g.callback(a)},setSignalingCallback:function(a){a=void 0===a?function(){}:a;f.debug("message: Setting signalling callback");h.signalCallback=a}};return h}},function(n,k){n.exports=function(g){if(!g.webpackPolyfill){var f=
Object.create(g);f.children||(f.children=[]);Object.defineProperty(f,"loaded",{enumerable:!0,get:function(){return f.l}});Object.defineProperty(f,"id",{enumerable:!0,get:function(){return f.i}});Object.defineProperty(f,"exports",{enumerable:!0});f.webpackPolyfill=1}return f}},function(n,k,g){g.d(k,"a",function(){return l});n=g(45);var f=g.n(n);n=g(0);var q=g(69);g.n(q);var h=g(1),a=n.a.module("Socket"),e=function(a,d){a=Object(h.d)({type:a});a.args=d.args;return a},l=function(l){var d=Object(h.b)(),
c=function(){};$jscomp.initSymbol();d.CONNECTED=Symbol("connected");$jscomp.initSymbol();d.RECONNECTING=Symbol("reconnecting");$jscomp.initSymbol();d.DISCONNECTED=Symbol("disconnected");d.state=d.DISCONNECTED;d.IO=void 0===l?f.a:l;var m,b,p=!1,g=function(a,b){for(var c=[],m=1;m<arguments.length;++m)c[m-1]=arguments[m];d.emit(e(a,{args:c}))};d.connect=function(e,f,l,h){l=void 0===l?c:l;h=void 0===h?c:h;Object.assign(f,e);var k={reconnection:!0,reconnectionAttempts:3,reconnectionDelay:1E3,reconnectionDelayMax:4E3,
randomizationFactor:.5,secure:e.secure,forceNew:!0,transports:["websocket"],rejectUnauthorized:!1,query:f},t=e.secure?"wss://":"ws://",r=e.host;a.info(e);m=d.IO.connect(t+r,k);b=new q.ReliableSocket(m);d.reliableSocket=b;var u=1E3,n=m.io.engine.transport.ws.onclose;m.io.engine.transport.ws.onclose=function(b){a.info("message: WebSocket closed, code: "+b.code+", id: "+d.id);u=b.code;n(b)};b.on("connected",function(b){a.info("message: connected, previousState: "+d.state.toString()+", id: "+d.id);d.state=
d.CONNECTED;d.id=b.clientId;l(b)});b.on("onAddStream",g.bind(d,"onAddStream"));b.on("stream_message_erizo",g.bind(d,"stream_message_erizo"));b.on("stream_message_p2p",g.bind(d,"stream_message_p2p"));b.on("connection_message_erizo",g.bind(d,"connection_message_erizo"));b.on("publish_me",g.bind(d,"publish_me"));b.on("unpublish_me",g.bind(d,"unpublish_me"));b.on("onBandwidthAlert",g.bind(d,"onBandwidthAlert"));b.on("onDataStream",g.bind(d,"onDataStream"));b.on("onUpdateAttributeStream",g.bind(d,"onUpdateAttributeStream"));
b.on("onRemoveStream",g.bind(d,"onRemoveStream"));b.on("onAutomaticStreamsSubscription",g.bind(d,"onAutomaticStreamsSubscription"));b.on("connection_failed",function(b){a.warning("message: connection failed, id: "+d.id+", evt: "+b);g("connection_failed",b)});b.on("connect",function(){a.info("message: connect, previousState: "+d.state.toString()+", id: "+d.id);d.state===d.RECONNECTING&&(a.info("message: reconnected, id: "+d.id),d.state=d.CONNECTED,g("reconnected",d.id))});b.on("error",function(c){a.warning("message: socket error, id: "+
d.id+", state: "+d.state.toString()+", error: "+c);c.startsWith("token: ")?(d.state=d.DISCONNECTED,h(c.slice(7)),b.disconnect()):d.state===d.RECONNECTING?(d.state=d.DISCONNECTED,b.disconnect(!0),g("disconnect",c)):d.state===d.DISCONNECTED?b.disconnect(!0):g("error")});b.on("disconnect",function(c){var e=b.getNumberOfPending();a.info("message: disconnect, id: "+d.id+", reason: "+c+", closeCode: "+u+", pending: "+e);d.clientInitiated?(d.state=d.DISCONNECTED,p||g("disconnect",c),b.disconnect(!0)):(d.state=
d.RECONNECTING,g("reconnecting","reason: "+c+", pendingMessages: "+e))});b.on("connect_error",function(b){a.warning("message: connect error, id: "+d.id+", error: "+b.message)});b.on("connect_timeout",function(b){a.warning("message: connect timeout, id: "+d.id+", error: "+b.message)});b.on("reconnecting",function(b){a.info("message: reconnecting, id: "+d.id+", attempt: "+b)});b.on("reconnect",function(b){a.info("message: internal ws reconnected, id: "+d.id+", attempt: "+b)});b.on("reconnect_attempt",
function(b){a.debug("message: reconnect attempt, id: "+d.id+", attempt: "+b);f.clientId=d.id;m.io.opts.query=f});b.on("reconnect_error",function(b){a.info("message: error reconnecting, id: "+d.id+", error: "+b.message)});b.on("reconnect_failed",function(){a.info("message: reconnect failed, id: "+d.id);d.state=d.DISCONNECTED;g("disconnect","reconnect failed");b.disconnect(!0)});b.on("member_join",g.bind(d,"member_join"));b.on("member_leave",g.bind(d,"member_leave"));b.on("group_join",g.bind(d,"group_join"));
b.on("group_create",g.bind(d,"group_create"));b.on("group_invite",g.bind(d,"group_invite"));b.on("group_leave",g.bind(d,"group_leave"));b.on("group_kickoff",g.bind(d,"group_kickoff"));b.on("group_dismiss",g.bind(d,"group_dismiss"))};var k=function(a){d.state!==d.DISCONNECTED&&(a.preventDefault(),delete a.returnValue,p=!0,d.disconnect(!0))};d.disconnect=function(c){a.warning("message: disconnect, id: "+d.id+", clientInitiated: "+c+", state: "+d.state.toString());d.state=d.DISCONNECTED;(d.clientInitiated=
c)&&b.emit("clientDisconnection");b.disconnect();window.removeEventListener("beforeunload",k)};window.addEventListener("beforeunload",k);d.sendMessage=function(e,m,f,l){f=void 0===f?c:f;l=void 0===l?c:l;d.state===d.DISCONNECTED?a.debug("message: Trying to send a message over a disconnected Socket, id: "+d.id+", type: "+e):b.emit(e,m,function(a,b){"success"===a?f(b):"error"===a?l(b):f(a,b)})};d.sendSDP=function(e,m,f,l){l=void 0===l?c:l;d.state===d.DISCONNECTED?a.warning("message: Trying to send a message over a disconnected Socket, id: "+
d.id):b.emit(e,{options:m,sdp:f},function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];l.apply(null,[].concat($jscomp.arrayFromIterable(b)))})};return d}},function(n,k,g){function f(f,d){"object"===typeof f&&(d=f,f=void 0);d=d||{};f=q(f);var c=f.source,m=f.id,b=f.path,b=l[m]&&b in l[m].nsps;d.forceNew||d["force new connection"]||!1===d.multiplex||b?(e("ignoring socket cache for %s",c),c=a(c,d)):(l[m]||(e("new io instance for %s",c),l[m]=a(c,d)),c=l[m]);f.query&&!d.query&&(d.query=
f.query);return c.socket(f.path,d)}var q=g(46),h=g(11),a=g(25),e=g(4)("socket.io-client");n.exports=k=f;var l=k.managers={};k.protocol=h.protocol;k.connect=f;k.Manager=g(25);k.Socket=g(31)},function(n,k,g){var f=g(19),q=g(4)("socket.io-client:url");n.exports=function(h,a){var e=h;a=a||"undefined"!==typeof location&&location;null==h&&(h=a.protocol+"//"+a.host);"string"===typeof h&&("/"===h.charAt(0)&&(h="/"===h.charAt(1)?a.protocol+h:a.host+h),/^(https?|wss?):\/\//.test(h)||(q("protocol-less url %s",
h),h="undefined"!==typeof a?a.protocol+"//"+h:"https://"+h),q("parse %s",h),e=f(h));e.port||(/^(http|ws)$/.test(e.protocol)?e.port="80":/^(http|ws)s$/.test(e.protocol)&&(e.port="443"));e.path=e.path||"/";h=-1!==e.host.indexOf(":")?"["+e.host+"]":e.host;e.id=e.protocol+"://"+h+":"+e.port;e.href=e.protocol+"://"+h+(a&&a.port===e.port?"":":"+e.port);return e}},function(n,k,g){function f(a){var e=0,f;for(f in a)e=(e<<5)-e+a.charCodeAt(f),e|=0;return k.colors[Math.abs(e)%k.colors.length]}function q(a){function e(){if(e.enabled){var a=
+new Date;e.diff=a-(l||a);e.prev=l;l=e.curr=a;for(var d=Array(arguments.length),a=0;a<d.length;a++)d[a]=arguments[a];d[0]=k.coerce(d[0]);"string"!==typeof d[0]&&d.unshift("%O");var c=0;d[0]=d[0].replace(/%([a-zA-Z%])/g,function(a,b){if("%%"===a)return a;c++;b=k.formatters[b];"function"===typeof b&&(a=b.call(e,d[c]),d.splice(c,1),c--);return a});k.formatArgs.call(e,d);(e.log||k.log||console.log.bind(console)).apply(e,d)}}var l;e.namespace=a;e.enabled=k.enabled(a);e.useColors=k.useColors();e.color=
f(a);e.destroy=h;"function"===typeof k.init&&k.init(e);k.instances.push(e);return e}function h(){var a=k.instances.indexOf(this);return-1!==a?(k.instances.splice(a,1),!0):!1}k=n.exports=q.debug=q["default"]=q;k.coerce=function(a){return a instanceof Error?a.stack||a.message:a};k.disable=function(){k.enable("")};k.enable=function(a){k.save(a);k.names=[];k.skips=[];var e,f=("string"===typeof a?a:"").split(/[\s,]+/),p=f.length;for(e=0;e<p;e++)f[e]&&(a=f[e].replace(/\*/g,".*?"),"-"===a[0]?k.skips.push(new RegExp("^"+
a.substr(1)+"$")):k.names.push(new RegExp("^"+a+"$")));for(e=0;e<k.instances.length;e++)a=k.instances[e],a.enabled=k.enabled(a.namespace)};k.enabled=function(a){if("*"===a[a.length-1])return!0;var e;var f=0;for(e=k.skips.length;f<e;f++)if(k.skips[f].test(a))return!1;f=0;for(e=k.names.length;f<e;f++)if(k.names[f].test(a))return!0;return!1};k.humanize=g(21);k.instances=[];k.names=[];k.skips=[];k.formatters={}},function(n,k,g){function f(e,d){if(!e)return e;if(a(e)){var c={_placeholder:!0,num:d.length};
d.push(e);return c}if(h(e)){c=Array(e.length);for(var m=0;m<e.length;m++)c[m]=f(e[m],d);return c}if("object"===typeof e&&!(e instanceof Date)){c={};for(m in e)c[m]=f(e[m],d);return c}return e}function q(a,d){if(!a)return a;if(a&&a._placeholder)return d[a.num];if(h(a))for(var c=0;c<a.length;c++)a[c]=q(a[c],d);else if("object"===typeof a)for(c in a)a[c]=q(a[c],d);return a}var h=g(22),a=g(23);n=Object.prototype.toString;var e="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===
n.call(Blob),l="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===n.call(File);k.deconstructPacket=function(a){var d=[];a.data=f(a.data,d);a.attachments=d.length;return{packet:a,buffers:d}};k.reconstructPacket=function(a,d){a.data=q(a.data,d);a.attachments=void 0;return a};k.removeBlobs=function(f,d){function c(f,p,g){if(!f)return f;if(e&&f instanceof Blob||l&&f instanceof File){m++;var k=new FileReader;k.onload=function(){g?g[p]=this.result:b=this.result;--m||d(b)};
k.readAsArrayBuffer(f)}else if(h(f))for(k=0;k<f.length;k++)c(f[k],k,f);else if("object"===typeof f&&!a(f))for(k in f)c(f[k],k,f)}var m=0,b=f;c(b);m||d(b)}},function(n,k,g){function f(a){var e=a.length;if(0<e%4)throw Error("Invalid string. Length must be a multiple of 4");a=a.indexOf("\x3d");-1===a&&(a=e);return[a,a===e?0:4-a%4]}function q(a,e,d){for(var c=[],m=e;m<d;m+=3)e=(a[m]<<16&16711680)+(a[m+1]<<8&65280)+(a[m+2]&255),c.push(h[e>>18&63]+h[e>>12&63]+h[e>>6&63]+h[e&63]);return c.join("")}k.byteLength=
function(a){a=f(a);var e=a[1];return 3*(a[0]+e)/4-e};k.toByteArray=function(l){var p=f(l);var d=p[0];var p=p[1],c=new e(3*(d+p)/4-p),m=0,b=0<p?d-4:d,h;for(h=0;h<b;h+=4)d=a[l.charCodeAt(h)]<<18|a[l.charCodeAt(h+1)]<<12|a[l.charCodeAt(h+2)]<<6|a[l.charCodeAt(h+3)],c[m++]=d>>16&255,c[m++]=d>>8&255,c[m++]=d&255;2===p&&(d=a[l.charCodeAt(h)]<<2|a[l.charCodeAt(h+1)]>>4,c[m++]=d&255);1===p&&(d=a[l.charCodeAt(h)]<<10|a[l.charCodeAt(h+1)]<<4|a[l.charCodeAt(h+2)]>>2,c[m++]=d>>8&255,c[m++]=d&255);return c};k.fromByteArray=
function(a){for(var e=a.length,d=e%3,c=[],m=0,b=e-d;m<b;m+=16383)c.push(q(a,m,m+16383>b?b:m+16383));1===d?(a=a[e-1],c.push(h[a>>2]+h[a<<4&63]+"\x3d\x3d")):2===d&&(a=(a[e-2]<<8)+a[e-1],c.push(h[a>>10]+h[a>>4&63]+h[a<<2&63]+"\x3d"));return c.join("")};var h=[],a=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(n=0;64>n;++n)h[n]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n],a["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(n)]=n;a[45]=62;
a[95]=63},function(n,k){k.read=function(g,f,k,h,a){var e=8*a-h-1;var l=(1<<e)-1,p=l>>1,d=-7;a=k?a-1:0;var c=k?-1:1,m=g[f+a];a+=c;k=m&(1<<-d)-1;m>>=-d;for(d+=e;0<d;k=256*k+g[f+a],a+=c,d-=8);e=k&(1<<-d)-1;k>>=-d;for(d+=h;0<d;e=256*e+g[f+a],a+=c,d-=8);if(0===k)k=1-p;else{if(k===l)return e?NaN:Infinity*(m?-1:1);e+=Math.pow(2,h);k-=p}return(m?-1:1)*e*Math.pow(2,k-h)};k.write=function(g,f,k,h,a,e){var l,p=8*e-a-1,d=(1<<p)-1,c=d>>1,m=23===a?Math.pow(2,-24)-Math.pow(2,-77):0;e=h?0:e-1;var b=h?1:-1,q=0>f||
0===f&&0>1/f?1:0;f=Math.abs(f);isNaN(f)||Infinity===f?(f=isNaN(f)?1:0,h=d):(h=Math.floor(Math.log(f)/Math.LN2),1>f*(l=Math.pow(2,-h))&&(h--,l*=2),f=1<=h+c?f+m/l:f+m*Math.pow(2,1-c),2<=f*l&&(h++,l/=2),h+c>=d?(f=0,h=d):1<=h+c?(f=(f*l-1)*Math.pow(2,a),h+=c):(f=f*Math.pow(2,c-1)*Math.pow(2,a),h=0));for(;8<=a;g[k+e]=f&255,e+=b,f/=256,a-=8);h=h<<a|f;for(p+=a;0<p;g[k+e]=h&255,e+=b,h/=256,p-=8);g[k+e-b]|=128*q}},function(n,k){var g={}.toString;n.exports=Array.isArray||function(f){return"[object Array]"==
g.call(f)}},function(n,k,g){n.exports=g(53);n.exports.parser=g(3)},function(n,k,g){function f(a,c){if(!(this instanceof f))return new f(a,c);c=c||{};a&&"object"===typeof a&&(c=a,a=null);a?(a=l(a),c.hostname=a.host,c.secure="https"===a.protocol||"wss"===a.protocol,c.port=a.port,a.query&&(c.query=a.query)):c.host&&(c.hostname=l(c.host).host);this.secure=null!=c.secure?c.secure:"undefined"!==typeof location&&"https:"===location.protocol;c.hostname&&!c.port&&(c.port=this.secure?"443":"80");this.agent=
c.agent||!1;this.hostname=c.hostname||("undefined"!==typeof location?location.hostname:"localhost");this.port=c.port||("undefined"!==typeof location&&location.port?location.port:this.secure?443:80);this.query=c.query||{};"string"===typeof this.query&&(this.query=p.decode(this.query));this.upgrade=!1!==c.upgrade;this.path=(c.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!c.forceJSONP;this.jsonp=!1!==c.jsonp;this.forceBase64=!!c.forceBase64;this.enablesXDR=!!c.enablesXDR;this.withCredentials=
!1!==c.withCredentials;this.timestampParam=c.timestampParam||"t";this.timestampRequests=c.timestampRequests;this.transports=c.transports||["polling","websocket"];this.transportOptions=c.transportOptions||{};this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.policyPort=c.policyPort||843;this.rememberUpgrade=c.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=c.onlyBinaryUpgrades;this.perMessageDeflate=!1!==c.perMessageDeflate?c.perMessageDeflate||{}:!1;!0===this.perMessageDeflate&&
(this.perMessageDeflate={});this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024);this.pfx=c.pfx||void 0;this.key=c.key||void 0;this.passphrase=c.passphrase||void 0;this.cert=c.cert||void 0;this.ca=c.ca||void 0;this.ciphers=c.ciphers||void 0;this.rejectUnauthorized=void 0===c.rejectUnauthorized?!0:c.rejectUnauthorized;this.forceNode=!!c.forceNode;this.isReactNative="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===
navigator.product.toLowerCase();if("undefined"===typeof self||this.isReactNative)c.extraHeaders&&0<Object.keys(c.extraHeaders).length&&(this.extraHeaders=c.extraHeaders),c.localAddress&&(this.localAddress=c.localAddress);this.pingTimeoutTimer=this.pingIntervalTimer=this.pingTimeout=this.pingInterval=this.upgrades=this.id=null;this.open()}var q=g(26);k=g(2);var h=g(7)("engine.io-client:socket"),a=g(30),e=g(3),l=g(19),p=g(5);n.exports=f;f.priorWebsocketSuccess=!1;k(f.prototype);f.protocol=e.protocol;
f.Socket=f;f.Transport=g(15);f.transports=g(26);f.parser=g(3);f.prototype.createTransport=function(a){h('creating transport "%s"',a);var c=this.query,d={},b;for(b in c)c.hasOwnProperty(b)&&(d[b]=c[b]);d.EIO=e.protocol;d.transport=a;c=this.transportOptions[a]||{};this.id&&(d.sid=this.id);return new q[a]({query:d,socket:this,agent:c.agent||this.agent,hostname:c.hostname||this.hostname,port:c.port||this.port,secure:c.secure||this.secure,path:c.path||this.path,forceJSONP:c.forceJSONP||this.forceJSONP,
jsonp:c.jsonp||this.jsonp,forceBase64:c.forceBase64||this.forceBase64,enablesXDR:c.enablesXDR||this.enablesXDR,withCredentials:c.withCredentials||this.withCredentials,timestampRequests:c.timestampRequests||this.timestampRequests,timestampParam:c.timestampParam||this.timestampParam,policyPort:c.policyPort||this.policyPort,pfx:c.pfx||this.pfx,key:c.key||this.key,passphrase:c.passphrase||this.passphrase,cert:c.cert||this.cert,ca:c.ca||this.ca,ciphers:c.ciphers||this.ciphers,rejectUnauthorized:c.rejectUnauthorized||
this.rejectUnauthorized,perMessageDeflate:c.perMessageDeflate||this.perMessageDeflate,extraHeaders:c.extraHeaders||this.extraHeaders,forceNode:c.forceNode||this.forceNode,localAddress:c.localAddress||this.localAddress,requestTimeout:c.requestTimeout||this.requestTimeout,protocols:c.protocols||void 0,isReactNative:this.isReactNative})};f.prototype.open=function(){if(this.rememberUpgrade&&f.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var a="websocket";else{if(0===this.transports.length){var c=
this;setTimeout(function(){c.emit("error","No transports available")},0);return}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(m){this.transports.shift();this.open();return}a.open();this.setTransport(a)};f.prototype.setTransport=function(a){h("setting transport %s",a.name);var c=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){c.onDrain()}).on("packet",function(a){c.onPacket(a)}).on("error",
function(a){c.onError(a)}).on("close",function(){c.onClose("transport close")})};f.prototype.probe=function(a){function c(){if(t.onlyBinaryUpgrades){var b=!this.supportsBinary&&t.transport.supportsBinary;q=q||b}q||(h('probe transport "%s" opened',a),k.send([{type:"ping",data:"probe"}]),k.once("packet",function(b){q||("pong"===b.type&&"probe"===b.data?(h('probe transport "%s" pong',a),t.upgrading=!0,t.emit("upgrading",k),k&&(f.priorWebsocketSuccess="websocket"===k.name,h('pausing current transport "%s"',
t.transport.name),t.transport.pause(function(){q||"closed"===t.readyState||(h("changing transport and sending upgrade packet"),p(),t.setTransport(k),k.send([{type:"upgrade"}]),t.emit("upgrade",k),k=null,t.upgrading=!1,t.flush())}))):(h('probe transport "%s" failed',a),b=Error("probe error"),b.transport=k.name,t.emit("upgradeError",b)))}))}function d(){q||(q=!0,p(),k.close(),k=null)}function b(b){var c=Error("probe error: "+b);c.transport=k.name;d();h('probe transport "%s" failed because of error: %s',
a,b);t.emit("upgradeError",c)}function e(){b("transport closed")}function l(){b("socket closed")}function g(a){k&&a.name!==k.name&&(h('"%s" works - aborting "%s"',a.name,k.name),d())}function p(){k.removeListener("open",c);k.removeListener("error",b);k.removeListener("close",e);t.removeListener("close",l);t.removeListener("upgrading",g)}h('probing transport "%s"',a);var k=this.createTransport(a,{probe:1}),q=!1,t=this;f.priorWebsocketSuccess=!1;k.once("open",c);k.once("error",b);k.once("close",e);
this.once("close",l);this.once("upgrading",g);k.open()};f.prototype.onOpen=function(){h("socket open");this.readyState="open";f.priorWebsocketSuccess="websocket"===this.transport.name;this.emit("open");this.flush();if("open"===this.readyState&&this.upgrade&&this.transport.pause){h("starting upgrade probes");for(var a=0,c=this.upgrades.length;a<c;a++)this.probe(this.upgrades[a])}};f.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(h('socket receive: type "%s", data "%s"',
a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(JSON.parse(a.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var c=Error("server error");c.code=a.data;this.onError(c);break;case "message":this.emit("data",a.data),this.emit("message",a.data)}else h('packet received with socket readyState "%s"',this.readyState)};f.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=
this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};f.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var c=this;c.pingTimeoutTimer=setTimeout(function(){if("closed"!==c.readyState)c.onClose("ping timeout")},a||c.pingInterval+c.pingTimeout)};f.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);
a.pingIntervalTimer=setTimeout(function(){h("writing ping packet - expecting pong within %sms",a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};f.prototype.ping=function(){var a=this;this.sendPacket("ping",function(){a.emit("ping")})};f.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emit("drain"):this.flush()};f.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&
this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};f.prototype.write=f.prototype.send=function(a,c,e){this.sendPacket("message",a,c,e);return this};f.prototype.sendPacket=function(a,c,e,b){"function"===typeof c&&(b=c,c=void 0);"function"===typeof e&&(b=e,e=null);if("closing"!==this.readyState&&"closed"!==this.readyState){e=e||{};e.compress=!1!==e.compress;a={type:a,
data:c,options:e};this.emit("packetCreate",a);this.writeBuffer.push(a);if(b)this.once("flush",b);this.flush()}};f.prototype.close=function(){function a(){b.onClose("forced close");h("socket closing - telling transport to close");b.transport.close()}function c(){b.removeListener("upgrade",c);b.removeListener("upgradeError",c);a()}function e(){b.once("upgrade",c);b.once("upgradeError",c)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var b=this;if(this.writeBuffer.length)this.once("drain",
function(){this.upgrading?e():a()});else this.upgrading?e():a()}return this};f.prototype.onError=function(a){h("socket error %j",a);f.priorWebsocketSuccess=!1;this.emit("error",a);this.onClose("transport error",a)};f.prototype.onClose=function(a,c){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)h('socket close with reason: "%s"',a),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),
this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,c),this.writeBuffer=[],this.prevBufferLen=0};f.prototype.filterUpgrades=function(d){for(var c=[],e=0,b=d.length;e<b;e++)~a(this.transports,d[e])&&c.push(d[e]);return c}},function(n,k){try{n.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(g){n.exports=!1}},function(n,k,g){function f(){}function q(a){l.call(this,a);this.requestTimeout=a.requestTimeout;this.extraHeaders=
a.extraHeaders;if("undefined"!==typeof location){var c="https:"===location.protocol,b=location.port;b||(b=c?443:80);this.xd="undefined"!==typeof location&&a.hostname!==location.hostname||b!==a.port;this.xs=a.secure!==c}}function h(a){this.method=a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!==a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=a.enablesXDR;this.withCredentials=a.withCredentials;
this.requestTimeout=a.requestTimeout;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.extraHeaders=a.extraHeaders;this.create()}function a(){for(var a in h.requests)h.requests.hasOwnProperty(a)&&h.requests[a].abort()}var e=g(13),l=g(27);k=g(2);var p=g(6),d=g(7)("engine.io-client:polling-xhr");g=g(14);n.exports=q;n.exports.Request=h;p(q,l);q.prototype.supportsBinary=!0;q.prototype.request=
function(a){a=a||{};a.uri=this.uri();a.xd=this.xd;a.xs=this.xs;a.agent=this.agent||!1;a.supportsBinary=this.supportsBinary;a.enablesXDR=this.enablesXDR;a.withCredentials=this.withCredentials;a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;a.requestTimeout=this.requestTimeout;a.extraHeaders=this.extraHeaders;return new h(a)};q.prototype.doWrite=function(a,d){a=this.request({method:"POST",data:a,
isBinary:"string"!==typeof a&&void 0!==a});var b=this;a.on("success",d);a.on("error",function(a){b.onError("xhr post error",a)});this.sendXhr=a};q.prototype.doPoll=function(){d("xhr poll");var a=this.request(),e=this;a.on("data",function(a){e.onData(a)});a.on("error",function(a){e.onError("xhr poll error",a)});this.pollXhr=a};k(h.prototype);h.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;
a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;var f=this.xhr=new e(a),b=this;try{d("xhr open %s: %s",this.method,this.uri);f.open(this.method,this.uri,this.async);try{if(this.extraHeaders){f.setDisableHeaderCheck&&f.setDisableHeaderCheck(!0);for(var l in this.extraHeaders)this.extraHeaders.hasOwnProperty(l)&&f.setRequestHeader(l,this.extraHeaders[l])}}catch(v){}if("POST"===this.method)try{this.isBinary?f.setRequestHeader("Content-type","application/octet-stream"):
f.setRequestHeader("Content-type","text/plain;charset\x3dUTF-8")}catch(v){}try{f.setRequestHeader("Accept","*/*")}catch(v){}"withCredentials"in f&&(f.withCredentials=this.withCredentials);this.requestTimeout&&(f.timeout=this.requestTimeout);this.hasXDR()?(f.onload=function(){b.onLoad()},f.onerror=function(){b.onError(f.responseText)}):f.onreadystatechange=function(){if(2===f.readyState)try{var a=f.getResponseHeader("Content-Type");if(b.supportsBinary&&"application/octet-stream"===a||"application/octet-stream; charset\x3dUTF-8"===
a)f.responseType="arraybuffer"}catch(r){}if(4===f.readyState)if(200===f.status||1223===f.status)b.onLoad();else setTimeout(function(){b.onError("number"===typeof f.status?f.status:0)},0)};d("xhr data %s",this.data);f.send(this.data)}catch(v){setTimeout(function(){b.onError(v)},0);return}"undefined"!==typeof document&&(this.index=h.requestsCount++,h.requests[this.index]=this)};h.prototype.onSuccess=function(){this.emit("success");this.cleanup()};h.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};
h.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};h.prototype.cleanup=function(a){if("undefined"!==typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=f:this.xhr.onreadystatechange=f;if(a)try{this.xhr.abort()}catch(m){}"undefined"!==typeof document&&delete h.requests[this.index];this.xhr=null}};h.prototype.onLoad=function(){try{try{var a=this.xhr.getResponseHeader("Content-Type")}catch(b){}var d="application/octet-stream"===a||"application/octet-stream; charset\x3dUTF-8"===
a?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(b){this.onError(b)}if(null!=d)this.onData(d)};h.prototype.hasXDR=function(){return"undefined"!==typeof XDomainRequest&&!this.xs&&this.enablesXDR};h.prototype.abort=function(){this.cleanup()};h.requestsCount=0;h.requests={};"undefined"!==typeof document&&("function"===typeof attachEvent?attachEvent("onunload",a):"function"===typeof addEventListener&&addEventListener("onpagehide"in g?"pagehide":"unload",a,!1))},function(n,k){n.exports=
Object.keys||function(g){var f=[],k=Object.prototype.hasOwnProperty,h;for(h in g)k.call(g,h)&&f.push(h);return f}},function(n,k){var g={}.toString;n.exports=Array.isArray||function(f){return"[object Array]"==g.call(f)}},function(n,k){n.exports=function(g,f,k){var h=g.byteLength;f=f||0;k=k||h;if(g.slice)return g.slice(f,k);0>f&&(f+=h);0>k&&(k+=h);k>h&&(k=h);if(f>=h||f>=k||0===h)return new ArrayBuffer(0);g=new Uint8Array(g);for(var h=new Uint8Array(k-f),a=0;f<k;f++,a++)h[a]=g[f];return h.buffer}},function(n,
k){function g(){}n.exports=function(f,k,h){function a(f,g){if(0>=a.count)throw Error("after called too many times");--a.count;f?(e=!0,k(f),k=h):0!==a.count||e||k(null,g)}var e=!1;h=h||g;a.count=f;return 0===f?k():a}},function(n,k){function g(a){for(var c=[],d=0,b=a.length,e,f;d<b;)e=a.charCodeAt(d++),55296<=e&&56319>=e&&d<b?(f=a.charCodeAt(d++),56320==(f&64512)?c.push(((e&1023)<<10)+(f&1023)+65536):(c.push(e),d--)):c.push(e);return c}function f(a,c){if(55296<=a&&57343>=a){if(c)throw Error("Lone surrogate U+"+
a.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function q(){if(p>=l)throw Error("Invalid byte index");var a=e[p]&255;p++;if(128==(a&192))return a&63;throw Error("Invalid continuation byte");}function h(a){if(p>l)throw Error("Invalid byte index");if(p==l)return!1;var c=e[p]&255;p++;if(0==(c&128))return c;if(192==(c&224)){var d=q();c=(c&31)<<6|d;if(128<=c)return c;throw Error("Invalid continuation byte");}if(224==(c&240)){d=q();var b=q();c=(c&15)<<12|d<<6|b;if(2048<=c)return f(c,
a)?c:65533;throw Error("Invalid continuation byte");}if(240==(c&248)&&(d=q(),b=q(),a=q(),c=(c&7)<<18|d<<12|b<<6|a,65536<=c&&1114111>=c))return c;throw Error("Invalid UTF-8 detected");}var a=String.fromCharCode,e,l,p;n.exports={version:"2.1.2",encode:function(d,c){c=c||{};c=!1!==c.strict;d=g(d);for(var e=d.length,b=-1,l,h="";++b<e;){l=d[b];var p=c;if(0==(l&4294967168))l=a(l);else{var k="";0==(l&4294965248)?k=a(l>>6&31|192):0==(l&4294901760)?(f(l,p)||(l=65533),k=a(l>>12&15|224),k+=a(l>>6&63|128)):0==
(l&4292870144)&&(k=a(l>>18&7|240),k+=a(l>>12&63|128),k+=a(l>>6&63|128));l=k+=a(l&63|128)}h+=l}return h},decode:function(d,c){c=c||{};c=!1!==c.strict;e=g(d);l=e.length;p=0;d=[];for(var f;!1!==(f=h(c));)d.push(f);c=d.length;f=-1;for(var b,k="";++f<c;)b=d[f],65535<b&&(b-=65536,k+=a(b>>>10&1023|55296),b=56320|b&1023),k+=a(b);return k}}},function(n,k){(function(g){k.encode=function(f){f=new Uint8Array(f);var k,h=f.length,a="";for(k=0;k<h;k+=3)a+=g[f[k]>>2],a+=g[(f[k]&3)<<4|f[k+1]>>4],a+=g[(f[k+1]&15)<<
2|f[k+2]>>6],a+=g[f[k+2]&63];2===h%3?a=a.substring(0,a.length-1)+"\x3d":1===h%3&&(a=a.substring(0,a.length-2)+"\x3d\x3d");return a};k.decode=function(f){var k=.75*f.length,h=f.length,a=0;"\x3d"===f[f.length-1]&&(k--,"\x3d"===f[f.length-2]&&k--);for(var e=new ArrayBuffer(k),l=new Uint8Array(e),k=0;k<h;k+=4){var p=g.indexOf(f[k]);var d=g.indexOf(f[k+1]);var c=g.indexOf(f[k+2]);var m=g.indexOf(f[k+3]);l[a++]=p<<2|d>>4;l[a++]=(d&15)<<4|c>>2;l[a++]=(c&3)<<6|m&63}return e}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},
function(n,k){function g(a){return a.map(function(a){if(a.buffer instanceof ArrayBuffer){var d=a.buffer;if(a.byteLength!==d.byteLength){var c=new Uint8Array(a.byteLength);c.set(new Uint8Array(d,a.byteOffset,a.byteLength));d=c.buffer}return d}return a})}function f(a,e){e=e||{};var d=new h;g(a).forEach(function(a){d.append(a)});return e.type?d.getBlob(e.type):d.getBlob()}function q(a,e){return new Blob(g(a),e||{})}var h="undefined"!==typeof h?h:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:
"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:!1;try{var a=2===(new Blob(["hi"])).size}catch(l){a=!1}if(k=a)try{k=2===(new Blob([new Uint8Array([1,2])])).size}catch(l){k=!1}var e=h&&h.prototype.append&&h.prototype.getBlob;"undefined"!==typeof Blob&&(f.prototype=Blob.prototype,q.prototype=Blob.prototype);a=a?k?Blob:q:e?f:void 0;n.exports=a},function(n,k,g){function f(a){var e=0,f;for(f in a)e=(e<<5)-e+a.charCodeAt(f),e|=0;return k.colors[Math.abs(e)%
k.colors.length]}function q(a){function e(){if(e.enabled){var a=+new Date;e.diff=a-(l||a);e.prev=l;l=e.curr=a;for(var d=Array(arguments.length),a=0;a<d.length;a++)d[a]=arguments[a];d[0]=k.coerce(d[0]);"string"!==typeof d[0]&&d.unshift("%O");var c=0;d[0]=d[0].replace(/%([a-zA-Z%])/g,function(a,b){if("%%"===a)return a;c++;b=k.formatters[b];"function"===typeof b&&(a=b.call(e,d[c]),d.splice(c,1),c--);return a});k.formatArgs.call(e,d);(e.log||k.log||console.log.bind(console)).apply(e,d)}}var l;e.namespace=
a;e.enabled=k.enabled(a);e.useColors=k.useColors();e.color=f(a);e.destroy=h;"function"===typeof k.init&&k.init(e);k.instances.push(e);return e}function h(){var a=k.instances.indexOf(this);return-1!==a?(k.instances.splice(a,1),!0):!1}k=n.exports=q.debug=q["default"]=q;k.coerce=function(a){return a instanceof Error?a.stack||a.message:a};k.disable=function(){k.enable("")};k.enable=function(a){k.save(a);k.names=[];k.skips=[];var e,f=("string"===typeof a?a:"").split(/[\s,]+/),h=f.length;for(e=0;e<h;e++)f[e]&&
(a=f[e].replace(/\*/g,".*?"),"-"===a[0]?k.skips.push(new RegExp("^"+a.substr(1)+"$")):k.names.push(new RegExp("^"+a+"$")));for(e=0;e<k.instances.length;e++)a=k.instances[e],a.enabled=k.enabled(a.namespace)};k.enabled=function(a){if("*"===a[a.length-1])return!0;var e;var f=0;for(e=k.skips.length;f<e;f++)if(k.skips[f].test(a))return!1;f=0;for(e=k.names.length;f<e;f++)if(k.names[f].test(a))return!0;return!1};k.humanize=g(21);k.instances=[];k.names=[];k.skips=[];k.formatters={}},function(n,k,g){function f(){}
function q(d){h.call(this,d);this.query=this.query||{};p||(p=a.___eio=a.___eio||[]);this.index=p.length;var c=this;p.push(function(a){c.onData(a)});this.query.j=this.index;"function"===typeof addEventListener&&addEventListener("beforeunload",function(){c.script&&(c.script.onerror=f)},!1)}var h=g(27);k=g(6);var a=g(14);n.exports=q;var e=/\n/g,l=/\\n/g,p;k(q,h);q.prototype.supportsBinary=!1;q.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);
this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);h.prototype.doClose.call(this)};q.prototype.doPoll=function(){var a=this,c=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);c.async=!0;c.src=this.uri();c.onerror=function(b){a.onError("jsonp poll error",b)};var e=document.getElementsByTagName("script")[0];e?e.parentNode.insertBefore(c,e):(document.head||document.body).appendChild(c);this.script=c;"undefined"!==
typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};q.prototype.doWrite=function(a,c){function d(){b();c()}function b(){if(h.iframe)try{h.form.removeChild(h.iframe)}catch(x){h.onError("jsonp polling iframe removal error",x)}try{f=document.createElement('\x3ciframe src\x3d"javascript:0" name\x3d"'+h.iframeId+'"\x3e')}catch(x){f=document.createElement("iframe"),f.name=h.iframeId,
f.src="javascript:0"}f.id=h.iframeId;h.form.appendChild(f);h.iframe=f}var f,h=this;if(!this.form){var g=document.createElement("form"),p=document.createElement("textarea"),k=this.iframeId="eio_iframe_"+this.index;g.className="socketio";g.style.position="absolute";g.style.top="-1000px";g.style.left="-1000px";g.target=k;g.method="POST";g.setAttribute("accept-charset","utf-8");p.name="d";g.appendChild(p);document.body.appendChild(g);this.form=g;this.area=p}this.form.action=this.uri();b();a=a.replace(l,
"\\\n");this.area.value=a.replace(e,"\\n");try{this.form.submit()}catch(x){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===h.iframe.readyState&&d()}:this.iframe.onload=d}},function(n,k,g){(function(f){function k(a){a&&a.forceBase64&&(this.supportsBinary=!1);this.perMessageDeflate=a.perMessageDeflate;this.usingBrowserWebSocket=c&&!a.forceNode;this.protocols=a.protocols;this.usingBrowserWebSocket||(b=m);h.call(this,a)}var h=g(15),a=g(3),e=g(5),l=g(6),p=g(29),d=g(7)("engine.io-client:websocket"),
c;"undefined"!==typeof WebSocket?c=WebSocket:"undefined"!==typeof self&&(c=self.WebSocket||self.MozWebSocket);if("undefined"===typeof window)try{var m=g(66)}catch(u){}var b=c||m;n.exports=k;l(k,h);k.prototype.name="websocket";k.prototype.supportsBinary=!0;k.prototype.doOpen=function(){if(this.check()){var a=this.uri(),c=this.protocols,d={};this.isReactNative||(d.agent=this.agent,d.perMessageDeflate=this.perMessageDeflate,d.pfx=this.pfx,d.key=this.key,d.passphrase=this.passphrase,d.cert=this.cert,
d.ca=this.ca,d.ciphers=this.ciphers,d.rejectUnauthorized=this.rejectUnauthorized);this.extraHeaders&&(d.headers=this.extraHeaders);this.localAddress&&(d.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?c?new b(a,c):new b(a):new b(a,c,d)}catch(K){return this.emit("error",K)}void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer";
this.addEventListeners()}};k.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(b){a.onData(b.data)};this.ws.onerror=function(b){a.onError("websocket error",b)}};k.prototype.write=function(b){function c(){e.emit("flush");setTimeout(function(){e.writable=!0;e.emit("drain")},0)}var e=this;this.writable=!1;for(var m=b.length,l=0,h=m;l<h;l++)(function(b){a.encodePacket(b,e.supportsBinary,function(a){if(!e.usingBrowserWebSocket){var l=
{};b.options&&(l.compress=b.options.compress);e.perMessageDeflate&&("string"===typeof a?f.byteLength(a):a.length)<e.perMessageDeflate.threshold&&(l.compress=!1)}try{e.usingBrowserWebSocket?e.ws.send(a):e.ws.send(a,l)}catch(D){d("websocket closed before onclose event")}--m||c()})})(b[l])};k.prototype.onClose=function(){h.prototype.onClose.call(this)};k.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};k.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",
c="";this.port&&("wss"===b&&443!==Number(this.port)||"ws"===b&&80!==Number(this.port))&&(c=":"+this.port);this.timestampRequests&&(a[this.timestampParam]=p());this.supportsBinary||(a.b64=1);a=e.encode(a);a.length&&(a="?"+a);var d=-1!==this.hostname.indexOf(":");return b+"://"+(d?"["+this.hostname+"]":this.hostname)+c+this.path+a};k.prototype.check=function(){return!!b&&!("__initialize"in b&&this.name===k.prototype.name)}}).call(k,g(12).Buffer)},function(n,k){},function(n,k){n.exports=function(g,f){for(var k=
[],h=(f=f||0)||0;h<g.length;h++)k[h-f]=g[h];return k}},function(n,k){function g(f){f=f||{};this.ms=f.min||100;this.max=f.max||1E4;this.factor=f.factor||2;this.jitter=0<f.jitter&&1>=f.jitter?f.jitter:0;this.attempts=0}n.exports=g;g.prototype.duration=function(){var f=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter)var g=Math.random(),h=Math.floor(g*this.jitter*f),f=0==(Math.floor(10*g)&1)?f-h:f+h;return Math.min(f,this.max)|0};g.prototype.reset=function(){this.attempts=0};g.prototype.setMin=
function(f){this.ms=f};g.prototype.setMax=function(f){this.max=f};g.prototype.setJitter=function(f){this.jitter=f}},function(n,k){k=function(g,f){this._pending=[];this._events={};this._id=0;this._enabled=!0;this._onAckCB=this._onAck.bind(this);this._onReconnectCB=this._onReconnect.bind(this);this.setLastAcked(f);this.setSocket(g)};k.prototype.setId=function(g){this._id=0<=g?g:0};k.prototype.id=function(){return this._id};k.prototype.setLastAcked=function(g){this._lastAcked=0<=g?g:-1};k.prototype.lastAcked=
function(){return this._lastAcked};k.prototype.setSocket=function(g){var f=this;this._cleanup();if(this._socket=g)Object.keys(this._events).forEach(function(g){for(var h=0;h<f._events[g].length;h+=1)f._socket.on(g,f._events[g][h].wrapped)}),this._socket.on("reconnect",this._onReconnectCB),this._socket.on("socketgd_ack",this._onAckCB),this.sendPending()};k.prototype.sendPending=function(){var g=this;this._pending.forEach(function(f){g._sendOnSocket(f)})};k.prototype.clearPending=function(){this._pending=
[]};k.prototype.getNumberOfPending=function(){return this._pending.length};k.prototype.enable=function(g){this._enabled=g};k.prototype.socket=function(){return this._socket};k.prototype._cleanup=function(){var g=this;this._socket&&(this._socket.removeListener("reconnect",this._onReconnectCB),this._socket.removeListener("socketgd_ack",this._onAckCB),Object.keys(this._events).forEach(function(f){for(var k=0;k<g._events[f].length;k+=1)g._socket.removeListener(f,g._events[f][k].wrapped)}))};k.prototype._onAck=
function(g){for(;0<this._pending.length&&this._pending[0].id<=g.id;)this._pending.shift()};k.prototype._onReconnect=function(){this.sendPending()};k.prototype._sendAck=function(g){if(this._socket)return this._lastAcked=g,this._socket.emit("socketgd_ack",{id:g}),this._lastAcked};k.prototype._sendOnSocket=function(g){this._enabled&&void 0===g.id&&(g.id=this._id,this._id+=1,g.gd=!0,this._pending.push(g));if(this._socket)if(this._enabled)switch(g.type){case "send":this._socket.send("socketgd:"+g.id+":"+
g.msg,g.ack);break;case "emit":this._socket.emit(g.event,{socketgd:g.id,msg:g.msg},g.ack)}else switch(g.type){case "send":this._socket.send(g.msg,g.ack);break;case "emit":this._socket.emit(g.event,g.msg,g.ack)}};k.prototype.send=function(g,f){this._sendOnSocket({type:"send",msg:g,ack:f})};k.prototype.emit=function(g,f,k){this._sendOnSocket({type:"emit",event:g,msg:f,ack:k})};k.prototype.disconnect=function(g){this._socket&&this._socket.disconnect(g);this._cleanup();this._socket=null};k.prototype.disconnectSync=
function(){this._socket&&this._socket.disconnectSync();this._cleanup();this._socket=null};k.prototype.on=function(g,f){var k=this;this._events[g]=this._events[g]||[];var h={cb:f,wrapped:function(a,e){if(a&&"message"===g)if(0!==a.indexOf("socketgd:"))f(a,e);else{var l=a.indexOf(":",9);if(-1===l)f(a,e);else{var h=parseInt(a.substring(9,l),10);if(!(h<=k._lastAcked)){a=a.substring(l+1);if(f)try{f(a,e)}catch(d){}k._sendAck(h)}}}else if(a&&"object"===typeof a&&void 0!==a.socketgd){if(!(a.socketgd<=k._lastAcked)){if(f)try{f(a.msg,
e)}catch(d){}k._sendAck(a.socketgd)}}else f(a,e)}};this._events[g].push(h);if(this._socket)this._socket.on(g,h.wrapped)};k.prototype.off=function(g,f){if(this._events[g])for(var k=0;k<this._events[g].length;k+=1)this._events[g][k].cb===f&&(this._socket&&this._socket.removeListener(g,this._events[g][k].wrapped),this._events[g].splice(k,1))};n.exports={ReliableSocket:k}},function(n,k,g){n=function(){return{getRandomValue:function(){var f=new Uint16Array(1);window.crypto.getRandomValues(f);return f[0]}}}();
k.a=n},function(n,k,g){var f=g(8),q=g(35);k.a=function(h){var a=Object(f.a)({});a.id=h.id;a.stream=h.stream.stream;a.elementID=h.elementID;var e=function(){a.bar.display()},l=function(){a.bar.hide()};a.destroy=function(){a.video.pause();a.parentNode.removeChild(a.div)};a.div=document.createElement("div");a.div.setAttribute("id","player_"+a.id);a.div.setAttribute("class","licode_player");a.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;");
!1!==h.options.loader&&(a.loader=document.createElement("img"),a.loader.setAttribute("style","width: 16px; height: 16px; position: absolute; top: 50%; left: 50%; margin-top: -8px; margin-left: -8px"),a.loader.setAttribute("id","back_"+a.id),a.loader.setAttribute("class","licode_loader"),a.loader.setAttribute("src",a.url+"/assets/loader.gif"));a.video=document.createElement("video");a.video.setAttribute("id","stream"+a.id);a.video.setAttribute("class","licode_stream");a.video.setAttribute("style",
"width: 100%; height: 100%; position: absolute; object-fit: cover");a.video.setAttribute("autoplay","autoplay");a.video.setAttribute("playsinline","playsinline");h.stream.local&&(a.video.volume=0);a.container=void 0!==a.elementID?"object"===typeof a.elementID&&"function"===typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID):document.body;a.container.appendChild(a.div);a.parentNode=a.div.parentNode;a.loader&&a.div.appendChild(a.loader);a.div.appendChild(a.video);a.containerWidth=
0;a.containerHeight=0;!1!==h.options.bar?(a.bar=Object(q.a)({elementID:"player_"+a.id,id:a.id,stream:h.stream,media:a.video,options:h.options}),a.div.onmouseover=e,a.div.onmouseout=l):a.media=a.video;a.video.srcObject=a.stream;return a}},function(n,k,g){var f=g(8);k.a=function(g){var h=Object(f.a)({}),a=50;h.elementID=g.elementID;h.media=g.media;h.id=g.id;h.stream=g.stream;h.div=document.createElement("div");h.div.setAttribute("style","width: 40%; height: 100%; max-width: 32px; position: absolute; right: 0;z-index:0;");
h.icon=document.createElement("img");h.icon.setAttribute("id","volume_"+h.id);h.icon.setAttribute("src",h.url+"/assets/sound48.png");h.icon.setAttribute("style","width: 80%; height: 100%; position: absolute;");h.div.appendChild(h.icon);h.icon.onclick=function(){h.media.muted?(h.media.muted=!1,h.icon.setAttribute("src",h.url+"/assets/sound48.png"),h.stream.local?h.stream.stream.getAudioTracks()[0].enabled=!0:(h.picker.value=a,h.media.volume=h.picker.value/100)):(h.media.muted=!0,h.icon.setAttribute("src",
h.url+"/assets/mute48.png"),h.stream.local?h.stream.stream.getAudioTracks()[0].enabled=!1:(a=h.picker.value,h.picker.value=0,h.media.volume=0))};if(!h.stream.local){h.picker=document.createElement("input");h.picker.setAttribute("id","picker_"+h.id);h.picker.type="range";h.picker.min=0;h.picker.max=100;h.picker.step=10;h.picker.value=a;h.picker.setAttribute("orient","vertical");h.div.appendChild(h.picker);h.media.volume=h.picker.value/100;h.media.muted=!1;h.picker.oninput=function(){0<h.picker.value?
(h.media.muted=!1,h.icon.setAttribute("src",h.url+"/assets/sound48.png")):(h.media.muted=!0,h.icon.setAttribute("src",h.url+"/assets/mute48.png"));h.media.volume=h.picker.value/100};var e=function(a){h.picker.setAttribute("style","background: transparent; width: 32px;\n                                         height: 100px; position: absolute; bottom: 90%;\n                                         z-index: 1; right: 0px; -webkit-appearance: slider-vertical;\n                                         bottom: "+
h.div.offsetHeight+"px; display: "+a)};h.div.onmouseover=function(){e("block")};h.div.onmouseout=function(){e("none")};e("none")}document.getElementById(h.elementID).appendChild(h.div);return h}},function(n,k,g){var f=g(8),q=g(35);k.a=function(h){var a=Object(f.a)({});a.id=h.id;a.stream=h.stream.stream;a.elementID=h.elementID;a.audio=document.createElement("audio");a.audio.setAttribute("id","stream"+a.id);a.audio.setAttribute("class","licode_stream");a.audio.setAttribute("style","width: 100%; height: 100%; position: absolute");
a.audio.setAttribute("autoplay","autoplay");h.stream.local&&(a.audio.volume=0);if(void 0!==a.elementID){a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.div)};var e=function(){a.bar.display()};var l=function(){a.bar.hide()};a.div=document.createElement("div");a.div.setAttribute("id","player_"+a.id);a.div.setAttribute("class","licode_player");a.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;");a.container="object"===typeof a.elementID&&"function"===
typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID);a.container.appendChild(a.div);a.parentNode=a.div.parentNode;a.div.appendChild(a.audio);!1!==h.options.bar?(a.bar=Object(q.a)({elementID:"player_"+a.id,id:a.id,stream:h.stream,media:a.audio,options:h.options}),a.div.onmouseover=e,a.div.onmouseout=l):a.media=a.audio}else a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.audio)},document.body.appendChild(a.audio),a.parentNode=document.body;a.audio.srcObject=
a.stream;return a}},function(n,k,g){(function(f){n.exports=f.adapter=g(75)}).call(k,g(24))},function(n,k,g){n.exports=function(){return function(){function f(g,h,a){function e(d,c){if(!h[d]){if(!g[d]){if(l)return l(d,!0);c=Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c;}c=h[d]={exports:{}};g[d][0].call(c.exports,function(a){return e(g[d][1][a]||a)},c,c.exports,f,g,h,a)}return h[d].exports}for(var l=!1,k=0;k<a.length;k++)e(a[k]);return e}return f}()({1:[function(f,g,h){f=f("./adapter_factory.js");
f=(0,f.adapterFactory)({window:window});g.exports=f},{"./adapter_factory.js":2}],2:[function(f,g,h){function a(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}Object.defineProperty(h,"__esModule",{value:!0});h.adapterFactory=function(){var a=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,
shimSafari:!0},g=e.log,h=e.detectBrowser(a),p={browserDetails:h,commonShim:m,extractVersion:e.extractVersion,disableLog:e.disableLog,disableWarnings:e.disableWarnings};switch(h.browser){case "chrome":if(!l||!l.shimPeerConnection||!f.shimChrome){g("Chrome shim is not included in this adapter release.");break}g("adapter.js shimming chrome.");p.browserShim=l;l.shimGetUserMedia(a);l.shimMediaStream(a);l.shimPeerConnection(a);l.shimOnTrack(a);l.shimAddTrackRemoveTrack(a);l.shimGetSendersWithDtmf(a);l.shimGetStats(a);
l.shimSenderReceiverGetStats(a);l.fixNegotiationNeeded(a);m.shimRTCIceCandidate(a);m.shimConnectionState(a);m.shimMaxMessageSize(a);m.shimSendThrowTypeError(a);m.removeAllowExtmapMixed(a);break;case "firefox":if(!d||!d.shimPeerConnection||!f.shimFirefox){g("Firefox shim is not included in this adapter release.");break}g("adapter.js shimming firefox.");p.browserShim=d;d.shimGetUserMedia(a);d.shimPeerConnection(a);d.shimOnTrack(a);d.shimRemoveStream(a);d.shimSenderGetStats(a);d.shimReceiverGetStats(a);
d.shimRTCDataChannel(a);m.shimRTCIceCandidate(a);m.shimConnectionState(a);m.shimMaxMessageSize(a);m.shimSendThrowTypeError(a);break;case "edge":if(!k||!k.shimPeerConnection||!f.shimEdge){g("MS edge shim is not included in this adapter release.");break}g("adapter.js shimming edge.");p.browserShim=k;k.shimGetUserMedia(a);k.shimGetDisplayMedia(a);k.shimPeerConnection(a);k.shimReplaceTrack(a);m.shimMaxMessageSize(a);m.shimSendThrowTypeError(a);break;case "safari":if(!c||!f.shimSafari){g("Safari shim is not included in this adapter release.");
break}g("adapter.js shimming safari.");p.browserShim=c;c.shimRTCIceServerUrls(a);c.shimCreateOfferLegacy(a);c.shimCallbacksAPI(a);c.shimLocalStreamsAPI(a);c.shimRemoteStreamsAPI(a);c.shimTrackEventTransceiver(a);c.shimGetUserMedia(a);m.shimRTCIceCandidate(a);m.shimMaxMessageSize(a);m.shimSendThrowTypeError(a);m.removeAllowExtmapMixed(a);break;default:g("Unsupported browser!")}return p};g=f("./utils");var e=a(g);g=f("./chrome/chrome_shim");var l=a(g);g=f("./edge/edge_shim");var k=a(g);g=f("./firefox/firefox_shim");
var d=a(g);g=f("./safari/safari_shim");var c=a(g);f=f("./common_shim");var m=a(f)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(f,g,h){function a(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}function e(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};
var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var d=b.apply(this,arguments);this._shimmedLocalStreams[c.id]?-1===this._shimmedLocalStreams[c.id].indexOf(d)&&this._shimmedLocalStreams[c.id].push(d):this._shimmedLocalStreams[c.id]=[c,d];return d};var c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=
this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});var d=this.getSenders();c.apply(this,arguments);var e=this.getSenders().filter(function(a){return-1===d.indexOf(a)});this._shimmedLocalStreams[a.id]=[a].concat(e)};var d=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||
{};delete this._shimmedLocalStreams[a.id];return d.apply(this,arguments)};var e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(c){var d=b._shimmedLocalStreams[c].indexOf(a);-1!==d&&b._shimmedLocalStreams[c].splice(d,1);1===b._shimmedLocalStreams[c].length&&delete b._shimmedLocalStreams[c]});return e.apply(this,arguments)}}Object.defineProperty(h,
"__esModule",{value:!0});h.shimGetDisplayMedia=h.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},k=f("./getusermedia");Object.defineProperty(h,"shimGetUserMedia",{enumerable:!0,get:function(){return k.shimGetUserMedia}});
var d=f("./getdisplaymedia");Object.defineProperty(h,"shimGetDisplayMedia",{enumerable:!0,get:function(){return d.shimGetDisplayMedia}});h.shimMediaStream=function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream};h.shimOnTrack=function(a){if("object"!==("undefined"===typeof a?"undefined":l(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)c.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});
else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var c=this;this._ontrackpoly||(this._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(d){var e=void 0,
e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):{track:d.track},f=new Event("track");f.track=d.track;f.receiver=e;f.transceiver={receiver:e};f.streams=[b.stream];c.dispatchEvent(f)});b.stream.getTracks().forEach(function(d){var e=void 0,e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.id}):{track:d},f=new Event("track");f.track=d;f.receiver=e;f.transceiver={receiver:e};
f.streams=[b.stream];c.dispatchEvent(f)})},this.addEventListener("addstream",this._ontrackpoly));return b.apply(this,arguments)}}};h.shimGetSendersWithDtmf=function(a){if("object"===("undefined"===typeof a?"undefined":l(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===b.kind?a.createDTMFSender(b):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=
function(){this._senders=this._senders||[];return this._senders.slice()};var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var e=c.apply(this,arguments);e||(e=b(this,a),this._senders.push(e));return e};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){d.apply(this,arguments);var b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}var e=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=
function(a){var c=this;this._senders=this._senders||[];e.apply(this,[a]);a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};var f=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._senders=this._senders||[];f.apply(this,[a]);a.getTracks().forEach(function(a){var c=b._senders.find(function(b){return b.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"===("undefined"===typeof a?"undefined":l(a))&&a.RTCPeerConnection&&
"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var m=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=m.apply(this,[]);b.forEach(function(b){return b._pc=a});return b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);
return this._dtmf}})}};h.shimGetStats=function(a){if(a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){var a=this,c=Array.prototype.slice.call(arguments),d=c[0],e=c[1],c=c[2];if(0<arguments.length&&"function"===typeof d)return b.apply(this,arguments);if(0===b.length&&(0===arguments.length||"function"!==typeof d))return b.apply(this,[]);var f=function(a){var b={};a.result().forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",
remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){c[b]=a.stat(b)});b[c.id]=c});return b},m=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};return 2<=arguments.length?b.apply(this,[function(a){e(m(f(a)))},d]):(new Promise(function(c,d){b.apply(a,[function(a){c(m(f(a)))},d])})).then(e,c)}}};h.shimSenderReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":l(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in
a.RTCRtpSender.prototype)){var b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=b.apply(this,[]);c.forEach(function(b){return b._pc=a});return c});var d=a.RTCPeerConnection.prototype.addTrack;d&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=d.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return c.filterStats(b,a.track,!0)})}}if(!("getStats"in
a.RTCRtpReceiver.prototype)){var e=a.RTCPeerConnection.prototype.getReceivers;e&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=e.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});c.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return c.filterStats(b,a.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var f=
a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof a.MediaStreamTrack){var b=arguments[0],c=void 0,d=void 0,e=void 0;this.getSenders().forEach(function(a){a.track===b&&(c?e=!0:c=a)});this.getReceivers().forEach(function(a){a.track===b&&(d?e=!0:d=a);return a.track===b});return e||c&&d?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():d?
d.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return f.apply(this,arguments)}}}};h.shimAddTrackRemoveTrackWithNative=e;h.shimAddTrackRemoveTrack=function(d){function b(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(a._streams[b.id].id,"g"),b.id)});return new RTCSessionDescription({type:b.type,sdp:c})}function f(a,b){var c=b.sdp;Object.keys(a._reverseStreams||
[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(b.id,"g"),a._streams[b.id].id)});return new RTCSessionDescription({type:b.type,sdp:c})}if(d.RTCPeerConnection){var l=c.detectBrowser(d);if(d.RTCPeerConnection.prototype.addTrack&&65<=l.version)return e(d);var g=d.RTCPeerConnection.prototype.getLocalStreams;d.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,b=g.apply(this);this._reverseStreams=this._reverseStreams||{};return b.map(function(b){return a._reverseStreams[b.id]})};
var m=d.RTCPeerConnection.prototype.addStream;d.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[a.id]){var c=new d.MediaStream(a.getTracks());this._streams[a.id]=c;this._reverseStreams[c.id]=a;a=c}m.apply(this,[a])};var h=d.RTCPeerConnection.prototype.removeStream;
d.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};h.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};d.RTCPeerConnection.prototype.addTrack=function(a,b){var c=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,
1);if(1!==e.length||!e[0].getTracks().find(function(b){return b===a}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(e=this._streams[b.id])?(e.addTrack(a),Promise.resolve().then(function(){c.dispatchEvent(new Event("negotiationneeded"))})):
(e=new d.MediaStream([a]),this._streams[b.id]=e,this._reverseStreams[e.id]=b,this.addStream(e));return this.getSenders().find(function(b){return b.track===a})};["createOffer","createAnswer"].forEach(function(c){var e=d.RTCPeerConnection.prototype[c],f=a({},c,function(){var a=this,c=arguments;return arguments.length&&"function"===typeof arguments[0]?e.apply(this,[function(d){d=b(a,d);c[0].apply(null,[d])},function(a){c[1]&&c[1].apply(null,a)},arguments[2]]):e.apply(this,arguments).then(function(c){return b(a,
c)})});d.RTCPeerConnection.prototype[c]=f[c]});var k=d.RTCPeerConnection.prototype.setLocalDescription;d.RTCPeerConnection.prototype.setLocalDescription=function(){if(!arguments.length||!arguments[0].type)return k.apply(this,arguments);arguments[0]=f(this,arguments[0]);return k.apply(this,arguments)};var p=Object.getOwnPropertyDescriptor(d.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(d.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=p.get.apply(this);
return""===a.type?a:b(this,a)}});d.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};
var c=void 0;Object.keys(this._streams).forEach(function(d){b._streams[d].getTracks().find(function(b){return a.track===b})&&(c=b._streams[d])});c&&(1===c.getTracks().length?this.removeStream(this._reverseStreams[c.id]):c.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}};h.shimPeerConnection=function(d){var b=c.detectBrowser(d);!d.RTCPeerConnection&&d.webkitRTCPeerConnection&&(d.RTCPeerConnection=d.webkitRTCPeerConnection);if(d.RTCPeerConnection){53>b.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(b){var c=d.RTCPeerConnection.prototype[b],e=a({},b,function(){arguments[0]=new ("addIceCandidate"===b?d.RTCIceCandidate:d.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)});d.RTCPeerConnection.prototype[b]=e[b]});var e=d.RTCPeerConnection.prototype.addIceCandidate;d.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>b.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};h.fixNegotiationNeeded=function(a){c.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})};var c=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(f("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(f,g,h){Object.defineProperty(h,"__esModule",
{value:!0});h.shimGetDisplayMedia=function(a,e){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||("function"!==typeof e?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):a.navigator.mediaDevices.getDisplayMedia=function(f){return e(f).then(function(e){var d=f.video&&f.video.width,c=f.video&&f.video.height;f.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:f.video&&f.video.frameRate||3}};d&&
(f.video.mandatory.maxWidth=d);c&&(f.video.mandatory.maxHeight=c);return a.navigator.mediaDevices.getUserMedia(f)})})}},{}],5:[function(f,g,h){Object.defineProperty(h,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==
Symbol.prototype?"symbol":typeof a};h.shimGetUserMedia=function(f){var d=f&&f.navigator;if(d.mediaDevices){var c=e.detectBrowser(f),g=function(b){if("object"!==("undefined"===typeof b?"undefined":a(b))||b.mandatory||b.optional)return b;var c={};Object.keys(b).forEach(function(d){if("require"!==d&&"advanced"!==d&&"mediaSource"!==d){var e="object"===a(b[d])?b[d]:{ideal:b[d]};void 0!==e.exact&&"number"===typeof e.exact&&(e.min=e.max=e.exact);var f=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):
"deviceId"===b?"sourceId":b};if(void 0!==e.ideal){c.optional=c.optional||[];var g={};"number"===typeof e.ideal?(g[f("min",d)]=e.ideal,c.optional.push(g),g={},g[f("max",d)]=e.ideal):g[f("",d)]=e.ideal;c.optional.push(g)}void 0!==e.exact&&"number"!==typeof e.exact?(c.mandatory=c.mandatory||{},c.mandatory[f("",d)]=e.exact):["min","max"].forEach(function(a){void 0!==e[a]&&(c.mandatory=c.mandatory||{},c.mandatory[f(a,d)]=e[a])})}});b.advanced&&(c.optional=(c.optional||[]).concat(b.advanced));return c},
b=function(b,e){if(61<=c.version)return e(b);if((b=JSON.parse(JSON.stringify(b)))&&"object"===a(b.audio)){var f=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};b=JSON.parse(JSON.stringify(b));f(b.audio,"autoGainControl","googAutoGainControl");f(b.audio,"noiseSuppression","googNoiseSuppression");b.audio=g(b.audio)}if(b&&"object"===a(b.video)){var h=b.video.facingMode,h=h&&("object"===("undefined"===typeof h?"undefined":a(h))?h:{ideal:h}),f=66>c.version;if(!(!h||"user"!==h.exact&&"environment"!==
h.exact&&"user"!==h.ideal&&"environment"!==h.ideal||d.mediaDevices.getSupportedConstraints&&d.mediaDevices.getSupportedConstraints().facingMode&&!f)){delete b.video.facingMode;var k=void 0;if("environment"===h.exact||"environment"===h.ideal)k=["back","rear"];else if("user"===h.exact||"user"===h.ideal)k=["front"];if(k)return d.mediaDevices.enumerateDevices().then(function(a){a=a.filter(function(a){return"videoinput"===a.kind});var c=a.find(function(a){return k.some(function(b){return a.label.toLowerCase().includes(b)})});
!c&&a.length&&k.includes("back")&&(c=a[a.length-1]);c&&(b.video.deviceId=h.exact?{exact:c.deviceId}:{ideal:c.deviceId});b.video=g(b.video);l("chrome: "+JSON.stringify(b));return e(b)})}b.video=g(b.video)}l("chrome: "+JSON.stringify(b));return e(b)},h=function(a){return 64<=c.version?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",
MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};d.getUserMedia=function(a,c,e){b(a,function(a){d.webkitGetUserMedia(a,c,function(a){e&&e(h(a))})})}.bind(d);if(d.mediaDevices.getUserMedia){var k=d.mediaDevices.getUserMedia.bind(d.mediaDevices);
d.mediaDevices.getUserMedia=function(a){return b(a,function(a){return k(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return b},function(a){return Promise.reject(h(a))})})}}}};var e=function(a){if(a&&a.__esModule)return a;var d={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);d.default=a;return d}(f("../utils.js")),l=e.log},{"../utils.js":15}],
6:[function(f,g,h){Object.defineProperty(h,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};h.shimRTCIceCandidate=function(f){if(f.RTCIceCandidate&&!(f.RTCIceCandidate&&"foundation"in
f.RTCIceCandidate.prototype)){var d=f.RTCIceCandidate;f.RTCIceCandidate=function(c){"object"===("undefined"===typeof c?"undefined":a(c))&&c.candidate&&0===c.candidate.indexOf("a\x3d")&&(c=JSON.parse(JSON.stringify(c)),c.candidate=c.candidate.substr(2));if(c.candidate&&c.candidate.length){var f=new d(c);c=e.default.parseCandidate(c.candidate);var b=Object.assign(f,c);b.toJSON=function(){return{candidate:b.candidate,sdpMid:b.sdpMid,sdpMLineIndex:b.sdpMLineIndex,usernameFragment:b.usernameFragment}};
return b}return new d(c)};f.RTCIceCandidate.prototype=d.prototype;l.wrapPeerConnectionEvent(f,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new f.RTCIceCandidate(a.candidate),writable:"false"});return a})}};h.shimMaxMessageSize=function(a){if(a.RTCPeerConnection){var d=l.detectBrowser(a);"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var c=
function(a){if(!a||!a.sdp)return!1;a=e.default.splitSections(a.sdp);a.shift();return a.some(function(a){return(a=e.default.parseMLine(a))&&"application"===a.kind&&-1!==a.protocol.indexOf("SCTP")})},f=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},b=function(a){var b=65536;"firefox"===d.browser&&(b=57>d.version?-1===a?16384:2147483637:60>d.version?57===d.version?65535:65536:2147483637);return b},g=function(a,b){var c=
65536;"firefox"===d.browser&&57===d.version&&(c=65535);a=e.default.matchPrefix(a.sdp,"a\x3dmax-message-size:");0<a.length?c=parseInt(a[0].substr(19),10):"firefox"===d.browser&&-1!==b&&(c=2147483637);return c},h=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;"chrome"===d.browser&&76<=d.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?
null:this._sctp},enumerable:!0,configurable:!0});if(c(arguments[0])){var a=f(arguments[0]),e=b(a),a=g(arguments[0],a),l=void 0,l=0===e&&0===a?Number.POSITIVE_INFINITY:0===e||0===a?Math.max(e,a):Math.min(e,a),e={};Object.defineProperty(e,"maxMessageSize",{get:function(){return l}});this._sctp=e}return h.apply(this,arguments)}}};h.shimSendThrowTypeError=function(a){function d(a,b){var c=a.send;a.send=function(){var d=arguments[0],d=d.length||d.size||d.byteLength;if("open"===a.readyState&&b.sctp&&d>
b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var c=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){var a=c.apply(this,arguments);d(a,this);return a};l.wrapPeerConnectionEvent(a,"datachannel",function(a){d(a.channel,a.target);return a})}};h.shimConnectionState=function(a){if(a.RTCPeerConnection&&
!("connectionState"in a.RTCPeerConnection.prototype)){var d=a.RTCPeerConnection.prototype;Object.defineProperty(d,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(d,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),
delete this._onconnectionstatechange);a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(a){var c=d[a];d[a]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=function(a){var b=a.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;var c=new Event("connectionstatechange",a);b.dispatchEvent(c)}return a},this.addEventListener("iceconnectionstatechange",
this._connectionstatechangepoly));return c.apply(this,arguments)}})}};h.removeAllowExtmapMixed=function(a){if(a.RTCPeerConnection){var d=l.detectBrowser(a);if(!("chrome"===d.browser&&71<=d.version)){var c=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(a){a&&a.sdp&&-1!==a.sdp.indexOf("\na\x3dextmap-allow-mixed")&&(a.sdp=a.sdp.split("\n").filter(function(a){return"a\x3dextmap-allow-mixed"!==a.trim()}).join("\n"));return c.apply(this,arguments)}}}};
var e=(g=f("sdp"))&&g.__esModule?g:{default:g},l=function(a){if(a&&a.__esModule)return a;var d={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);d.default=a;return d}(f("./utils"))},{"./utils":15,sdp:17}],7:[function(f,g,h){Object.defineProperty(h,"__esModule",{value:!0});h.shimGetDisplayMedia=h.shimGetUserMedia=void 0;var a=f("./getusermedia");Object.defineProperty(h,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}});var e=f("./getdisplaymedia");
Object.defineProperty(h,"shimGetDisplayMedia",{enumerable:!0,get:function(){return e.shimGetDisplayMedia}});h.shimPeerConnection=function(a){var c=l.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=function(a){return a}),15025>c.version)){var b=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){b.set.call(this,
a);var c=new Event("enabled");c.enabled=a;this.dispatchEvent(c)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null));return this._dtmf}});a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender);var e=(0,d.default)(a,c.version);a.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=
(0,k.filterIceServers)(a.iceServers,c.version),l.log("ICE servers after filtering:",a.iceServers));return new e(a)};a.RTCPeerConnection.prototype=e.prototype};h.shimReplaceTrack=function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)};var l=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b]);c.default=a;return c}(f("../utils")),k=f("./filtericeservers"),
d=(f=f("rtcpeerconnection-shim"))&&f.__esModule?f:{default:f}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(f,g,h){Object.defineProperty(h,"__esModule",{value:!0});h.filterIceServers=function(e,f){var g=!1;e=JSON.parse(JSON.stringify(e));return e.filter(function(d){if(d&&(d.urls||d.url)){var c=d.urls||d.url;d.url&&!d.urls&&a.deprecated("RTCIceServer.url","RTCIceServer.urls");var e="string"===typeof c;e&&(c=[c]);c=c.filter(function(a){return 0===
a.indexOf("stun:")?!1:(a=a.startsWith("turn")&&!a.startsWith("turn:[")&&a.includes("transport\x3dudp"))&&!g?g=!0:a&&!g});delete d.url;d.urls=e?c[0]:c;return!!c.length}})};var a=function(a){if(a&&a.__esModule)return a;var e={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(e[f]=a[f]);e.default=a;return e}(f("../utils"))},{"../utils":15}],9:[function(f,g,h){Object.defineProperty(h,"__esModule",{value:!0});h.shimGetDisplayMedia=function(a){"getDisplayMedia"in a.navigator&&a.navigator.mediaDevices&&
!(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)&&(a.navigator.mediaDevices.getDisplayMedia=a.navigator.getDisplayMedia.bind(a.navigator))}},{}],10:[function(f,g,h){Object.defineProperty(h,"__esModule",{value:!0});h.shimGetUserMedia=function(a){a=a&&a.navigator;var e=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},f=a.mediaDevices.getUserMedia.bind(a.mediaDevices);
a.mediaDevices.getUserMedia=function(a){return f(a).catch(function(a){return Promise.reject(e(a))})}}},{}],11:[function(f,g,h){function a(a,d,b){d in a?Object.defineProperty(a,d,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[d]=b;return a}Object.defineProperty(h,"__esModule",{value:!0});h.shimGetDisplayMedia=h.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},l=f("./getusermedia");Object.defineProperty(h,"shimGetUserMedia",{enumerable:!0,get:function(){return l.shimGetUserMedia}});var k=f("./getdisplaymedia");Object.defineProperty(h,"shimGetDisplayMedia",{enumerable:!0,get:function(){return k.shimGetDisplayMedia}});h.shimOnTrack=function(a){"object"===("undefined"===typeof a?"undefined":
e(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};h.shimPeerConnection=function(c){var f=d.detectBrowser(c);if("object"===("undefined"===typeof c?"undefined":e(c))&&(c.RTCPeerConnection||c.mozRTCPeerConnection)){!c.RTCPeerConnection&&c.mozRTCPeerConnection&&(c.RTCPeerConnection=c.mozRTCPeerConnection);53>f.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(b){var d=c.RTCPeerConnection.prototype[b],e=a({},b,function(){arguments[0]=new ("addIceCandidate"===b?c.RTCIceCandidate:c.RTCSessionDescription)(arguments[0]);return d.apply(this,arguments)});c.RTCPeerConnection.prototype[b]=e[b]});if(68>f.version){var b=c.RTCPeerConnection.prototype.addIceCandidate;c.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():b.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var g={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},h=c.RTCPeerConnection.prototype.getStats;c.RTCPeerConnection.prototype.getStats=function(){var a=Array.prototype.slice.call(arguments),b=a[1],c=a[2];return h.apply(this,[a[0]||null]).then(function(a){if(53>f.version&&!b)try{a.forEach(function(a){a.type=g[a.type]||a.type})}catch(t){if("TypeError"!==
t.name)throw t;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:g[b.type]||b.type}))})}return a}).then(b,c)}}};h.shimSenderGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":e(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)){var c=a.RTCPeerConnection.prototype.getSenders;c&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=c.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});var b=a.RTCPeerConnection.prototype.addTrack;
b&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=b.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};h.shimReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":e(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)){var c=a.RTCPeerConnection.prototype.getReceivers;c&&(a.RTCPeerConnection.prototype.getReceivers=
function(){var a=this,d=c.apply(this,[]);d.forEach(function(b){return b._pc=a});return d});d.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};h.shimRemoveStream=function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;d.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(c){c.track&&
a.getTracks().includes(c.track)&&b.removeTrack(c)})})};h.shimRTCDataChannel=function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)};var d=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b]);c.default=a;return c}(f("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(f,g,h){Object.defineProperty(h,"__esModule",{value:!0});h.shimGetDisplayMedia=function(a,e){a.navigator.mediaDevices&&
"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||(a.navigator.mediaDevices.getDisplayMedia=function(f){if(!f||!f.video)return f=new DOMException("getDisplayMedia without video constraints is undefined"),f.name="NotFoundError",f.code=8,Promise.reject(f);!0===f.video?f.video={mediaSource:e}:f.video.mediaSource=e;return a.navigator.mediaDevices.getUserMedia(f)})}},{}],13:[function(f,g,h){Object.defineProperty(h,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};h.shimGetUserMedia=function(f){var g=e.detectBrowser(f),d=f&&f.navigator;f=f&&f.MediaStreamTrack;d.getUserMedia=function(a,b,c){e.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");
d.mediaDevices.getUserMedia(a).then(b,c)};if(!(55<g.version&&"autoGainControl"in d.mediaDevices.getSupportedConstraints())){var c=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},h=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(b){"object"===("undefined"===typeof b?"undefined":a(b))&&"object"===a(b.audio)&&(b=JSON.parse(JSON.stringify(b)),c(b.audio,"autoGainControl","mozAutoGainControl"),c(b.audio,"noiseSuppression","mozNoiseSuppression"));return h(b)};
if(f&&f.prototype.getSettings){var b=f.prototype.getSettings;f.prototype.getSettings=function(){var a=b.apply(this,arguments);c(a,"mozAutoGainControl","autoGainControl");c(a,"mozNoiseSuppression","noiseSuppression");return a}}if(f&&f.prototype.applyConstraints){var k=f.prototype.applyConstraints;f.prototype.applyConstraints=function(b){"audio"===this.kind&&"object"===("undefined"===typeof b?"undefined":a(b))&&(b=JSON.parse(JSON.stringify(b)),c(b,"autoGainControl","mozAutoGainControl"),c(b,"noiseSuppression",
"mozNoiseSuppression"));return k.apply(this,[b])}}}};var e=function(a){if(a&&a.__esModule)return a;var e={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(e[d]=a[d]);e.default=a;return e}(f("../utils"))},{"../utils":15}],14:[function(f,g,h){function a(a){return a&&void 0!==a.video?Object.assign({},a,{video:k.compactObject(a.video)}):a}Object.defineProperty(h,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e="function"===typeof Symbol&&
"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};h.shimLocalStreamsAPI=function(a){if("object"===("undefined"===typeof a?"undefined":e(a))&&a.RTCPeerConnection){"getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=
[]);return this._localStreams});if(!("addStream"in a.RTCPeerConnection.prototype)){var d=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(a)||this._localStreams.push(a);a.getAudioTracks().forEach(function(b){return d.call(c,b,a)});a.getVideoTracks().forEach(function(b){return d.call(c,b,a)})};a.RTCPeerConnection.prototype.addTrack=function(a){var c=arguments[1];c&&(this._localStreams?
this._localStreams.includes(c)||this._localStreams.push(c):this._localStreams=[c]);return d.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var c=this;this._localStreams||(this._localStreams=[]);var b=this._localStreams.indexOf(a);if(-1!==b){this._localStreams.splice(b,1);var d=a.getTracks();this.getSenders().forEach(function(a){d.includes(a.track)&&c.removeTrack(a)})}})}};h.shimRemoteStreamsAPI=function(a){if("object"===
("undefined"===typeof a?"undefined":e(a))&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var c=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",
this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){c._remoteStreams||(c._remoteStreams=[]);if(!c._remoteStreams.includes(a)){c._remoteStreams.push(a);var b=new Event("addstream");b.stream=a;c.dispatchEvent(b)}})})}});var d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",
this._onaddstreampoly=function(c){c.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(b))){a._remoteStreams.push(b);var c=new Event("addstream");c.stream=b;a.dispatchEvent(c)}})});return d.apply(a,arguments)}}};h.shimCallbacksAPI=function(a){if("object"===("undefined"===typeof a?"undefined":e(a))&&a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var d=a.createOffer,c=a.createAnswer,f=a.setLocalDescription,b=a.setRemoteDescription,g=a.addIceCandidate;
a.createOffer=function(a,b){var c=d.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};a.createAnswer=function(a,b){var d=c.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return d;d.then(a,b);return Promise.resolve()};var h=function(a,b,c){a=f.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.setLocalDescription=h;h=function(a,c,d){a=b.apply(this,[a]);if(!d)return a;a.then(c,d);return Promise.resolve()};
a.setRemoteDescription=h;h=function(a,b,c){a=g.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.addIceCandidate=h}};h.shimGetUserMedia=function(e){var d=e&&e.navigator;if(d.mediaDevices&&d.mediaDevices.getUserMedia){e=d.mediaDevices;var c=e.getUserMedia.bind(e);d.mediaDevices.getUserMedia=function(d){return c(a(d))}}!d.getUserMedia&&d.mediaDevices&&d.mediaDevices.getUserMedia&&(d.getUserMedia=function(a,b,c){d.mediaDevices.getUserMedia(a).then(b,c)}.bind(d))};h.shimConstraints=
a;h.shimRTCIceServerUrls=function(a){var d=a.RTCPeerConnection;a.RTCPeerConnection=function(a,e){if(a&&a.iceServers){for(var b=[],c=0;c<a.iceServers.length;c++){var f=a.iceServers[c];!f.hasOwnProperty("urls")&&f.hasOwnProperty("url")?(k.deprecated("RTCIceServer.url","RTCIceServer.urls"),f=JSON.parse(JSON.stringify(f)),f.urls=f.url,delete f.url,b.push(f)):b.push(a.iceServers[c])}a.iceServers=b}return new d(a,e)};a.RTCPeerConnection.prototype=d.prototype;"generateCertificate"in a.RTCPeerConnection&&
Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return d.generateCertificate}})};h.shimTrackEventTransceiver=function(a){"object"===("undefined"===typeof a?"undefined":e(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};h.shimCreateOfferLegacy=function(a){var d=a.RTCPeerConnection.prototype.createOffer;
a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var c=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});!1===a.offerToReceiveAudio&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):!0!==a.offerToReceiveAudio||c||this.addTransceiver("audio");
"undefined"!==typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);c=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});!1===a.offerToReceiveVideo&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):!0!==a.offerToReceiveVideo||c||this.addTransceiver("video")}return d.apply(this,arguments)}};var k=function(a){if(a&&
a.__esModule)return a;var d={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);d.default=a;return d}(f("../utils"))},{"../utils":15}],15:[function(f,g,h){function a(a,c,d){c in a?Object.defineProperty(a,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[c]=d;return a}function e(a,c,d){return(a=a.match(c))&&a.length>=d&&parseInt(a[d],10)}function k(b){return"[object Object]"!==Object.prototype.toString.call(b)?b:Object.keys(b).reduce(function(c,d){var e="[object Object]"===
Object.prototype.toString.call(b[d]),f=e?k(b[d]):b[d],e=e&&!Object.keys(f).length;return void 0===f||e?c:Object.assign(c,a({},d,f))},{})}function p(a,c,d){c&&!d.has(c.id)&&(d.set(c.id,c),Object.keys(c).forEach(function(b){b.endsWith("Id")?p(a,a.get(c[b]),d):b.endsWith("Ids")&&c[b].forEach(function(b){p(a,a.get(b),d)})}))}Object.defineProperty(h,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?
function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};h.extractVersion=e;h.wrapPeerConnectionEvent=function(a,c,d){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var b=a.addEventListener;a.addEventListener=function(a,e){if(a!==c)return b.apply(this,arguments);var f=function(a){(a=d(a))&&e(a)};this._eventMap=this._eventMap||{};this._eventMap[e]=
f;return b.apply(this,[a,f])};var e=a.removeEventListener;a.removeEventListener=function(a,b){if(a!==c||!this._eventMap||!this._eventMap[b])return e.apply(this,arguments);var d=this._eventMap[b];delete this._eventMap[b];return e.apply(this,[a,d])};Object.defineProperty(a,"on"+c,{get:function(){return this["_on"+c]},set:function(a){this["_on"+c]&&(this.removeEventListener(c,this["_on"+c]),delete this["_on"+c]);a&&this.addEventListener(c,this["_on"+c]=a)},enumerable:!0,configurable:!0})}};h.disableLog=
function(a){return"boolean"!==typeof a?Error("Argument type: "+("undefined"===typeof a?"undefined":d(a))+". Please use a boolean."):(c=a)?"adapter.js logging disabled":"adapter.js logging enabled"};h.disableWarnings=function(a){if("boolean"!==typeof a)return Error("Argument type: "+("undefined"===typeof a?"undefined":d(a))+". Please use a boolean.");m=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")};h.log=function(){"object"!==("undefined"===typeof window?"undefined":d(window))||
c||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)};h.deprecated=function(a,c){m&&console.warn(a+" is deprecated, please use "+c+" instead.")};h.detectBrowser=function(a){var b=a.navigator,c={browser:null,version:null};if("undefined"===typeof a||!a.navigator)return c.browser="Not a browser.",c;b.mozGetUserMedia?(c.browser="firefox",c.version=e(b.userAgent,/Firefox\/(\d+)\./,1)):b.webkitGetUserMedia||!1===a.isSecureContext&&a.webkitRTCPeerConnection&&
!a.RTCIceGatherer?(c.browser="chrome",c.version=e(b.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):b.mediaDevices&&b.userAgent.match(/Edge\/(\d+).(\d+)$/)?(c.browser="edge",c.version=e(b.userAgent,/Edge\/(\d+).(\d+)$/,2)):a.RTCPeerConnection&&b.userAgent.match(/AppleWebKit\/(\d+)\./)?(c.browser="safari",c.version=e(b.userAgent,/AppleWebKit\/(\d+)\./,1),c.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype):c.browser="Not a supported browser.";return c};h.compactObject=
k;h.walkStats=p;h.filterStats=function(a,c,d){var b=d?"outbound-rtp":"inbound-rtp",e=new Map;if(null===c)return e;var f=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===c.id&&f.push(a)});f.forEach(function(c){a.forEach(function(d){d.type===b&&d.trackId===c.id&&p(a,d,e)})});return e};var c=!0,m=!0},{}],16:[function(f,g,h){function a(a,c,d,e,f){c=m.writeRtpDescription(a.kind,c);c+=m.writeIceParameters(a.iceGatherer.getLocalParameters());c+=m.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),
"offer"===d?"actpass":f||"active");c+="a\x3dmid:"+a.mid+"\r\n";c=a.rtpSender&&a.rtpReceiver?c+"a\x3dsendrecv\r\n":a.rtpSender?c+"a\x3dsendonly\r\n":a.rtpReceiver?c+"a\x3drecvonly\r\n":c+"a\x3dinactive\r\n";a.rtpSender&&(d=a.rtpSender._initialTrackId||a.rtpSender.track.id,a.rtpSender._initialTrackId=d,e="msid:"+(e?e.id:"-")+" "+d+"\r\n",c=c+("a\x3d"+e)+("a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" "+e),a.sendEncodingParameters[0].rtx&&(c+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,
c+="a\x3dssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));c+="a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+m.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(c+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+m.localCName+"\r\n");return c}function e(a,c){var b=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var d=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");
var e="string"===typeof d;e&&(d=[d]);d=d.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport\x3dudp")||-1!==a.indexOf("turn:[")||b?0===a.indexOf("stun:")&&14393<=c&&-1===a.indexOf("?transport\x3dudp"):b=!0});delete a.url;a.urls=e?d[0]:d;return!!d.length}})}function k(a,c){var b={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,b){a=parseInt(a,10);for(var c=0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},e=function(a,b,c,e){a=
d(a.parameters.apt,c);b=d(b.parameters.apt,e);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};a.codecs.forEach(function(d){for(var f=0;f<c.codecs.length;f++){var g=c.codecs[f];if(d.name.toLowerCase()===g.name.toLowerCase()&&d.clockRate===g.clockRate&&("rtx"!==d.name.toLowerCase()||!d.parameters||!g.parameters.apt||e(d,g,a.codecs,c.codecs))){g=JSON.parse(JSON.stringify(g));g.numChannels=Math.min(d.numChannels,g.numChannels);b.codecs.push(g);g.rtcpFeedback=g.rtcpFeedback.filter(function(a){for(var b=
0;b<d.rtcpFeedback.length;b++)if(d.rtcpFeedback[b].type===a.type&&d.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var d=0;d<c.headerExtensions.length;d++){var e=c.headerExtensions[d];if(a.uri===e.uri){b.headerExtensions.push(e);break}}});return b}function p(a,c,d){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer",
"have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[c][a].indexOf(d)}function d(a,c){var b=a.getRemoteCandidates().find(function(a){return c.foundation===a.foundation&&c.ip===a.ip&&c.port===a.port&&c.priority===a.priority&&c.protocol===a.protocol&&c.type===a.type});b||a.addRemoteCandidate(c);return!b}function c(a,c){c=Error(c);c.name=a;c.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return c}var m=
f("sdp");g.exports=function(b,f){function g(a,c){c.addTrack(a);c.dispatchEvent(new b.MediaStreamTrackEvent("addtrack",{track:a}))}function h(a,c){c.removeTrack(a);c.dispatchEvent(new b.MediaStreamTrackEvent("removetrack",{track:a}))}function l(a,c,d,e){var f=new Event("track");f.track=c;f.receiver=d;f.transceiver={receiver:d};f.streams=e;b.setTimeout(function(){a._dispatchEvent("track",f)})}var n=function(a){var d=this,g=document.createDocumentFragment();["addEventListener","removeEventListener",
"dispatchEvent"].forEach(function(a){d[a]=g[a].bind(g)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState="new";a=JSON.parse(JSON.stringify(a||{}));this.usingBundle="max-bundle"===a.bundlePolicy;if("negotiate"===a.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");
a.rtcpMuxPolicy||(a.rtcpMuxPolicy="require");switch(a.iceTransportPolicy){case "all":case "relay":break;default:a.iceTransportPolicy="all"}switch(a.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:a.bundlePolicy="balanced"}a.iceServers=e(a.iceServers||[],f);this._iceGatherers=[];if(a.iceCandidatePoolSize)for(var h=a.iceCandidatePoolSize;0<h;h--)this._iceGatherers.push(new b.RTCIceGatherer({iceServers:a.iceServers,gatherPolicy:a.iceTransportPolicy}));else a.iceCandidatePoolSize=
0;this._config=a;this.transceivers=[];this._sdpSessionId=m.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(n.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(n.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});n.prototype.onicecandidate=null;n.prototype.onaddstream=null;n.prototype.ontrack=null;n.prototype.onremovestream=null;
n.prototype.onsignalingstatechange=null;n.prototype.oniceconnectionstatechange=null;n.prototype.onconnectionstatechange=null;n.prototype.onicegatheringstatechange=null;n.prototype.onnegotiationneeded=null;n.prototype.ondatachannel=null;n.prototype._dispatchEvent=function(a,b){if(!this._isClosed&&(this.dispatchEvent(b),"function"===typeof this["on"+a]))this["on"+a](b)};n.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",
a)};n.prototype.getConfiguration=function(){return this._config};n.prototype.getLocalStreams=function(){return this.localStreams};n.prototype.getRemoteStreams=function(){return this.remoteStreams};n.prototype._createTransceiver=function(a,b){var c=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,
associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);b||this.transceivers.push(a);return a};n.prototype.addTrack=function(a,d){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(b){return b.track===
a}))throw c("InvalidAccessError","Track already exists.");for(var e,f=0;f<this.transceivers.length;f++)this.transceivers[f].track||this.transceivers[f].kind!==a.kind||(e=this.transceivers[f]);e||(e=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(d)&&this.localStreams.push(d);e.track=a;e.stream=d;e.rtpSender=new b.RTCRtpSender(a,e.dtlsTransport);return e.rtpSender};n.prototype.addStream=function(a){var b=this;if(15025<=f)a.getTracks().forEach(function(c){b.addTrack(c,
a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var d=c.getTracks()[b];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});c.getTracks().forEach(function(a){b.addTrack(a,c)})}};n.prototype.removeTrack=function(a){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof b.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var d=this.transceivers.find(function(b){return b.rtpSender===
a});if(!d)throw c("InvalidAccessError","Sender was not created by this connection.");var e=d.stream;d.rtpSender.stop();d.rtpSender=null;d.track=null;d.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(e)&&-1<this.localStreams.indexOf(e)&&this.localStreams.splice(this.localStreams.indexOf(e),1);this._maybeFireNegotiationNeeded()};n.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&
b.removeTrack(c)})};n.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};n.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};n.prototype._createIceGatherer=function(a,c){var d=this;if(c&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var e=new b.RTCIceGatherer({iceServers:this._config.iceServers,
gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(e,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=[];this.transceivers[a].bufferCandidates=function(b){var c=!b.candidate||0===Object.keys(b.candidate).length;e.state=c?"completed":"gathering";null!==d.transceivers[a].bufferedCandidateEvents&&d.transceivers[a].bufferedCandidateEvents.push(b)};e.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return e};n.prototype._gather=function(a,
c){var d=this,e=this.transceivers[c].iceGatherer;if(!e.onlocalcandidate){var f=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null;e.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates);e.onlocalcandidate=function(b){if(!(d.usingBundle&&0<c)){var f=new Event("icecandidate");f.candidate={sdpMid:a,sdpMLineIndex:c};var g=b.candidate;if(b=!g||0===Object.keys(g).length){if("new"===e.state||"gathering"===e.state)e.state="completed"}else"new"===
e.state&&(e.state="gathering"),g.component=1,g.ufrag=e.getLocalParameters().usernameFragment,g=m.writeCandidate(g),f.candidate=Object.assign(f.candidate,m.parseCandidate(g)),f.candidate.candidate=g,f.candidate.toJSON=function(){return{candidate:f.candidate.candidate,sdpMid:f.candidate.sdpMid,sdpMLineIndex:f.candidate.sdpMLineIndex,usernameFragment:f.candidate.usernameFragment}};g=m.getMediaSections(d._localDescription.sdp);g[f.candidate.sdpMLineIndex]=b?g[f.candidate.sdpMLineIndex]+"a\x3dend-of-candidates\r\n":
g[f.candidate.sdpMLineIndex]+("a\x3d"+f.candidate.candidate+"\r\n");d._localDescription.sdp=m.getDescription(d._localDescription.sdp)+g.join("");g=d.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange());b||d._dispatchEvent("icecandidate",f);g&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())}};
b.setTimeout(function(){f.forEach(function(a){e.onlocalcandidate(a)})},0)}};n.prototype._createIceAndDtlsTransports=function(){var a=this,c=new b.RTCIceTransport(null);c.onicestatechange=function(){a._updateIceConnectionState();a._updateConnectionState()};var d=new b.RTCDtlsTransport(c);d.ondtlsstatechange=function(){a._updateConnectionState()};d.onerror=function(){Object.defineProperty(d,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:c,dtlsTransport:d}};n.prototype._disposeIceAndDtlsTransports=
function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[a].dtlsTransport};n.prototype._transceive=function(a,b,c){var d=k(a.localCapabilities,a.remoteCapabilities);b&&a.rtpSender&&(d.encodings=a.sendEncodingParameters,d.rtcp=
{cname:m.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(d.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(d));c&&a.rtpReceiver&&0<d.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>f&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),d.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],d.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(d.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&
(d.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(d))};n.prototype.setLocalDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(c("TypeError",'Unsupported type "'+a.type+'"'));if(!p("setLocalDescription",a.type,b.signalingState)||b._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+a.type+" in state "+b.signalingState));if("offer"===a.type){var d=m.splitSections(a.sdp);var e=d.shift();d.forEach(function(a,c){a=
m.parseRtpParameters(a);b.transceivers[c].localCapabilities=a});b.transceivers.forEach(function(a,c){b._gather(a.mid,c)})}else if("answer"===a.type){d=m.splitSections(b._remoteDescription.sdp);e=d.shift();var f=0<m.matchPrefix(e,"a\x3dice-lite").length;d.forEach(function(a,c){var d=b.transceivers[c],g=d.iceGatherer,h=d.iceTransport,l=d.dtlsTransport,p=d.localCapabilities,n=d.remoteCapabilities;if(!(m.isRejected(a)&&0===m.matchPrefix(a,"a\x3dbundle-only").length||d.rejected)){var q=m.getIceParameters(a,
e);a=m.getDtlsParameters(a,e);f&&(a.role="server");b.usingBundle&&0!==c||(b._gather(d.mid,c),"new"===h.state&&h.start(g,q,f?"controlling":"controlled"),"new"===l.state&&l.start(a));c=k(p,n);b._transceive(d,0<c.codecs.length,!1)}})}b._localDescription={type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-local-offer"):b._updateSignalingState("stable");return Promise.resolve()};n.prototype.setRemoteDescription=function(a){var e=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(c("TypeError",
'Unsupported type "'+a.type+'"'));if(!p("setRemoteDescription",a.type,e.signalingState)||e._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+a.type+" in state "+e.signalingState));var n={};e.remoteStreams.forEach(function(a){n[a.id]=a});var q=[],t=m.splitSections(a.sdp),r=t.shift(),u=0<m.matchPrefix(r,"a\x3dice-lite").length,v=0<m.matchPrefix(r,"a\x3dgroup:BUNDLE ").length;e.usingBundle=v;var x=m.matchPrefix(r,"a\x3dice-options:")[0];e.canTrickleIceCandidates=x?0<=x.substr(14).split(" ").indexOf("trickle"):
!1;t.forEach(function(c,l){var p=m.splitLines(c),t=m.getKind(c),z=m.isRejected(c)&&0===m.matchPrefix(c,"a\x3dbundle-only").length,E=p[0].substr(2).split(" ")[2],p=m.getDirection(c,r),y=m.parseMsid(c),C=m.getMid(c)||m.generateIdentifier();if(z||"application"===t&&("DTLS/SCTP"===E||"UDP/DTLS/SCTP"===E))e.transceivers[l]={mid:C,kind:t,protocol:E,rejected:!0};else{!z&&e.transceivers[l]&&e.transceivers[l].rejected&&(e.transceivers[l]=e._createTransceiver(t,!0));var D=m.parseRtpParameters(c);if(!z){var F=
m.getIceParameters(c,r);var G=m.getDtlsParameters(c,r);G.role="client"}var E=m.parseRtpEncodingParameters(c),x=m.parseRtcpParameters(c),I=0<m.matchPrefix(c,"a\x3dend-of-candidates",r).length,B=m.matchPrefix(c,"a\x3dcandidate:").map(function(a){return m.parseCandidate(a)}).filter(function(a){return 1===a.component});("offer"===a.type||"answer"===a.type)&&!z&&v&&0<l&&e.transceivers[l]&&(e._disposeIceAndDtlsTransports(l),e.transceivers[l].iceGatherer=e.transceivers[0].iceGatherer,e.transceivers[l].iceTransport=
e.transceivers[0].iceTransport,e.transceivers[l].dtlsTransport=e.transceivers[0].dtlsTransport,e.transceivers[l].rtpSender&&e.transceivers[l].rtpSender.setTransport(e.transceivers[0].dtlsTransport),e.transceivers[l].rtpReceiver&&e.transceivers[l].rtpReceiver.setTransport(e.transceivers[0].dtlsTransport));if("offer"!==a.type||z)"answer"!==a.type||z||(w=e.transceivers[l],A=w.iceGatherer,t=w.iceTransport,C=w.dtlsTransport,H=w.rtpReceiver,z=w.sendEncodingParameters,c=w.localCapabilities,e.transceivers[l].recvEncodingParameters=
E,e.transceivers[l].remoteCapabilities=D,e.transceivers[l].rtcpParameters=x,B.length&&"new"===t.state&&(!u&&!I||v&&0!==l?B.forEach(function(a){d(w.iceTransport,a)}):t.setRemoteCandidates(B)),v&&0!==l||("new"===t.state&&t.start(A,F,"controlling"),"new"===C.state&&C.start(G)),!k(w.localCapabilities,w.remoteCapabilities).codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx,e._transceive(w,"sendrecv"===p||"recvonly"===
p,"sendrecv"===p||"sendonly"===p),!H||"sendrecv"!==p&&"sendonly"!==p?delete w.rtpReceiver:(p=H.track,y?(n[y.stream]||(n[y.stream]=new b.MediaStream),g(p,n[y.stream]),q.push([p,H,n[y.stream]])):(n.default||(n.default=new b.MediaStream),g(p,n.default),q.push([p,H,n.default]))));else{var w=e.transceivers[l]||e._createTransceiver(t);w.mid=C;w.iceGatherer||(w.iceGatherer=e._createIceGatherer(l,v));B.length&&"new"===w.iceTransport.state&&(!I||v&&0!==l?B.forEach(function(a){d(w.iceTransport,a)}):w.iceTransport.setRemoteCandidates(B));
c=b.RTCRtpReceiver.getCapabilities(t);15019>f&&(c.codecs=c.codecs.filter(function(a){return"rtx"!==a.name}));z=w.sendEncodingParameters||[{ssrc:1001*(2*l+2)}];F=!1;if("sendrecv"===p||"sendonly"===p){F=!w.rtpReceiver;var H=w.rtpReceiver||new b.RTCRtpReceiver(w.dtlsTransport,t);if(F){p=H.track;if(!y||"-"!==y.stream)if(y){n[y.stream]||(n[y.stream]=new b.MediaStream,Object.defineProperty(n[y.stream],"id",{get:function(){return y.stream}}));Object.defineProperty(p,"id",{get:function(){return y.track}});
var A=n[y.stream]}else n.default||(n.default=new b.MediaStream),A=n.default;A&&(g(p,A),w.associatedRemoteMediaStreams.push(A));q.push([p,H,A])}}else w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===w.rtpReceiver.track.id});b&&h(b,a)}),w.associatedRemoteMediaStreams=[]);w.localCapabilities=c;w.remoteCapabilities=D;w.rtpReceiver=H;w.rtcpParameters=x;w.sendEncodingParameters=z;w.recvEncodingParameters=E;e._transceive(e.transceivers[l],
!1,F)}}});void 0===e._dtlsRole&&(e._dtlsRole="offer"===a.type?"active":"passive");e._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?e._updateSignalingState("have-remote-offer"):e._updateSignalingState("stable");Object.keys(n).forEach(function(a){var c=n[a];if(c.getTracks().length){if(-1===e.remoteStreams.indexOf(c)){e.remoteStreams.push(c);var d=new Event("addstream");d.stream=c;b.setTimeout(function(){e._dispatchEvent("addstream",d)})}q.forEach(function(a){c.id===a[2].id&&l(e,a[0],a[1],
[c])})}});q.forEach(function(a){a[2]||l(e,a[0],a[1],[])});b.setTimeout(function(){e&&e.transceivers&&e.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};n.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();
a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};n.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};n.prototype._maybeFireNegotiationNeeded=function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,b.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=
!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};n.prototype._updateIceConnectionState=function(){var a={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&a[b.iceTransport.state]++});var b="new";0<a.failed?b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&
(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};n.prototype._updateConnectionState=function(){var a={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&(a[b.iceTransport.state]++,a[b.dtlsTransport.state]++)});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":
0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};n.prototype.createOffer=function(d){var e=this;if(e._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var g=e.transceivers.filter(function(a){return"audio"===a.kind}).length,h=e.transceivers.filter(function(a){return"video"===a.kind}).length;if(d){if(d.mandatory||d.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");
void 0!==d.offerToReceiveAudio&&(g=!0===d.offerToReceiveAudio?1:!1===d.offerToReceiveAudio?0:d.offerToReceiveAudio);void 0!==d.offerToReceiveVideo&&(h=!0===d.offerToReceiveVideo?1:!1===d.offerToReceiveVideo?0:d.offerToReceiveVideo)}for(e.transceivers.forEach(function(a){"audio"===a.kind?(g--,0>g&&(a.wantReceive=!1)):"video"===a.kind&&(h--,0>h&&(a.wantReceive=!1))});0<g||0<h;)0<g&&(e._createTransceiver("audio"),g--),0<h&&(e._createTransceiver("video"),h--);var k=m.writeSessionBoilerplate(e._sdpSessionId,
e._sdpSessionVersion++);e.transceivers.forEach(function(a,c){var d=a.track,g=a.kind,h=a.mid||m.generateIdentifier();a.mid=h;a.iceGatherer||(a.iceGatherer=e._createIceGatherer(c,e.usingBundle));h=b.RTCRtpSender.getCapabilities(g);15019>f&&(h.codecs=h.codecs.filter(function(a){return"rtx"!==a.name}));h.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===
a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});h.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&(b.id=a.id)})});c=a.sendEncodingParameters||[{ssrc:1001*(2*c+1)}];d&&15019<=f&&"video"===g&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new b.RTCRtpReceiver(a.dtlsTransport,g));a.localCapabilities=h;a.sendEncodingParameters=c});"max-compat"!==
e._config.bundlePolicy&&(k+="a\x3dgroup:BUNDLE "+e.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");k+="a\x3dice-options:trickle\r\n";e.transceivers.forEach(function(b,c){k+=a(b,b.localCapabilities,"offer",b.stream,e._dtlsRole);k+="a\x3drtcp-rsize\r\n";!b.iceGatherer||"new"===e.iceGatheringState||0!==c&&e.usingBundle||(b.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;k+="a\x3d"+m.writeCandidate(a)+"\r\n"}),"completed"===b.iceGatherer.state&&(k+="a\x3dend-of-candidates\r\n"))});
d=new b.RTCSessionDescription({type:"offer",sdp:k});return Promise.resolve(d)};n.prototype.createAnswer=function(){var d=this;if(d._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==d.signalingState&&"have-local-pranswer"!==d.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+d.signalingState));var e=m.writeSessionBoilerplate(d._sdpSessionId,d._sdpSessionVersion++);d.usingBundle&&
(e+="a\x3dgroup:BUNDLE "+d.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");var e=e+"a\x3dice-options:trickle\r\n",g=m.getMediaSections(d._remoteDescription.sdp).length;d.transceivers.forEach(function(b,c){if(!(c+1>g))if(b.rejected)"application"===b.kind?e="DTLS/SCTP"===b.protocol?e+"m\x3dapplication 0 DTLS/SCTP 5000\r\n":e+("m\x3dapplication 0 "+b.protocol+" webrtc-datachannel\r\n"):"audio"===b.kind?e+="m\x3daudio 0 UDP/TLS/RTP/SAVPF 0\r\na\x3drtpmap:0 PCMU/8000\r\n":"video"===b.kind&&
(e+="m\x3dvideo 0 UDP/TLS/RTP/SAVPF 120\r\na\x3drtpmap:120 VP8/90000\r\n"),e+="c\x3dIN IP4 0.0.0.0\r\na\x3dinactive\r\na\x3dmid:"+b.mid+"\r\n";else{if(b.stream){var h;"audio"===b.kind?h=b.stream.getAudioTracks()[0]:"video"===b.kind&&(h=b.stream.getVideoTracks()[0]);h&&15019<=f&&"video"===b.kind&&!b.sendEncodingParameters[0].rtx&&(b.sendEncodingParameters[0].rtx={ssrc:b.sendEncodingParameters[0].ssrc+1})}c=k(b.localCapabilities,b.remoteCapabilities);!c.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&
b.sendEncodingParameters[0].rtx&&delete b.sendEncodingParameters[0].rtx;e+=a(b,c,"answer",b.stream,d._dtlsRole);b.rtcpParameters&&b.rtcpParameters.reducedSize&&(e+="a\x3drtcp-rsize\r\n")}});var h=new b.RTCSessionDescription({type:"answer",sdp:e});return Promise.resolve(h)};n.prototype.addIceCandidate=function(a){var b=this,e;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(f,g){if(b._remoteDescription)if(a&&""!==a.candidate){var h=
a.sdpMLineIndex;if(a.sdpMid)for(var k=0;k<b.transceivers.length;k++)if(b.transceivers[k].mid===a.sdpMid){h=k;break}var l=b.transceivers[h];if(l){if(l.rejected)return f();k=0<Object.keys(a.candidate).length?m.parseCandidate(a.candidate):{};if("tcp"===k.protocol&&(0===k.port||9===k.port)||k.component&&1!==k.component)return f();if((0===h||0<h&&l.iceTransport!==b.transceivers[0].iceTransport)&&!d(l.iceTransport,k))return g(c("OperationError","Can not add ICE candidate"));g=a.candidate.trim();0===g.indexOf("a\x3d")&&
(g=g.substr(2));e=m.getMediaSections(b._remoteDescription.sdp);e[h]+="a\x3d"+(k.type?g:"end-of-candidates")+"\r\n";b._remoteDescription.sdp=m.getDescription(b._remoteDescription.sdp)+e.join("")}else return g(c("OperationError","Can not add ICE candidate"))}else for(h=0;h<b.transceivers.length&&(b.transceivers[h].rejected||(b.transceivers[h].iceTransport.addRemoteCandidate({}),e=m.getMediaSections(b._remoteDescription.sdp),e[h]+="a\x3dend-of-candidates\r\n",b._remoteDescription.sdp=m.getDescription(b._remoteDescription.sdp)+
e.join(""),!b.usingBundle));h++);else return g(c("InvalidStateError","Can not add ICE candidate without a remote description"));f()})};n.prototype.getStats=function(a){if(a&&a instanceof b.MediaStreamTrack){var d=null;this.transceivers.forEach(function(b){b.rtpSender&&b.rtpSender.track===a?d=b.rtpSender:b.rtpReceiver&&b.rtpReceiver.track===a&&(d=b.rtpReceiver)});if(!d)throw c("InvalidAccessError","Invalid selector.");return d.getStats()}var e=[];this.transceivers.forEach(function(a){["rtpSender",
"rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&e.push(a[b].getStats())})});return Promise.all(e).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=b[a])&&a.prototype&&a.prototype.getStats){var c=a.prototype.getStats;a.prototype.getStats=function(){return c.apply(this).then(function(a){var b=new Map;
Object.keys(a).forEach(function(c){var d=a[c];a[c].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type;b.set(c,a[c])});return b})}}});var q=["createOffer","createAnswer"];q.forEach(function(a){var b=n.prototype[a];n.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&
a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,[b])}):b.apply(this,arguments)}});q=["setLocalDescription","setRemoteDescription","addIceCandidate"];q.forEach(function(a){var b=n.prototype[a];n.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=
n.prototype[a];n.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return n}},{sdp:17}],17:[function(f,g,h){var a={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};a.localCName=a.generateIdentifier();a.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};a.splitSections=function(a){return a.split("\nm\x3d").map(function(a,
e){return(0<e?"m\x3d"+a:a).trim()+"\r\n"})};a.getDescription=function(e){return(e=a.splitSections(e))&&e[0]};a.getMediaSections=function(e){e=a.splitSections(e);e.shift();return e};a.matchPrefix=function(e,f){return a.splitLines(e).filter(function(a){return 0===a.indexOf(f)})};a.parseCandidate=function(a){a=0===a.indexOf("a\x3dcandidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var e={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],
10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]},f=8;f<a.length;f+=2)switch(a[f]){case "raddr":e.relatedAddress=a[f+1];break;case "rport":e.relatedPort=parseInt(a[f+1],10);break;case "tcptype":e.tcpType=a[f+1];break;case "ufrag":e.ufrag=a[f+1];e.usernameFragment=a[f+1];break;default:e[a[f]]=a[f+1]}return e};a.writeCandidate=function(a){var e=[];e.push(a.foundation);e.push(a.component);e.push(a.protocol.toUpperCase());e.push(a.priority);e.push(a.address||a.ip);e.push(a.port);var f=a.type;
e.push("typ");e.push(f);"host"!==f&&a.relatedAddress&&a.relatedPort&&(e.push("raddr"),e.push(a.relatedAddress),e.push("rport"),e.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(e.push("tcptype"),e.push(a.tcpType));if(a.usernameFragment||a.ufrag)e.push("ufrag"),e.push(a.usernameFragment||a.ufrag);return"candidate:"+e.join(" ")};a.parseIceOptions=function(a){return a.substr(14).split(" ")};a.parseRtpMap=function(a){a=a.substr(9).split(" ");var e={payloadType:parseInt(a.shift(),10)};
a=a[0].split("/");e.name=a[0];e.clockRate=parseInt(a[1],10);e.channels=3===a.length?parseInt(a[2],10):1;e.numChannels=e.channels;return e};a.writeRtpMap=function(a){var e=a.payloadType;void 0!==a.preferredPayloadType&&(e=a.preferredPayloadType);var f=a.channels||a.numChannels||1;return"a\x3drtpmap:"+e+" "+a.name+"/"+a.clockRate+(1!==f?"/"+f:"")+"\r\n"};a.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};
a.writeExtmap=function(a){return"a\x3dextmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};a.parseFmtp=function(a){for(var e={},f=a.substr(a.indexOf(" ")+1).split(";"),d=0;d<f.length;d++)a=f[d].trim().split("\x3d"),e[a[0].trim()]=a[1];return e};a.writeFmtp=function(a){var e="",f=a.payloadType;void 0!==a.preferredPayloadType&&(f=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var d=[];Object.keys(a.parameters).forEach(function(c){a.parameters[c]?
d.push(c+"\x3d"+a.parameters[c]):d.push(c)});e+="a\x3dfmtp:"+f+" "+d.join(";")+"\r\n"}return e};a.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};a.writeRtcpFb=function(a){var e="",f=a.payloadType;void 0!==a.preferredPayloadType&&(f=a.preferredPayloadType);a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){e+="a\x3drtcp-fb:"+f+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return e};a.parseSsrcMedia=
function(a){var e=a.indexOf(" "),f={ssrc:parseInt(a.substr(7,e-7),10)},d=a.indexOf(":",e);-1<d?(f.attribute=a.substr(e+1,d-e-1),f.value=a.substr(d+1)):f.attribute=a.substr(e+1);return f};a.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};a.getMid=function(e){if(e=a.matchPrefix(e,"a\x3dmid:")[0])return e.substr(6)};a.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};
a.getDtlsParameters=function(e,f){return{role:"auto",fingerprints:a.matchPrefix(e+f,"a\x3dfingerprint:").map(a.parseFingerprint)}};a.writeDtlsParameters=function(a,f){var e="a\x3dsetup:"+f+"\r\n";a.fingerprints.forEach(function(a){e+="a\x3dfingerprint:"+a.algorithm+" "+a.value+"\r\n"});return e};a.getIceParameters=function(e,f){e=a.splitLines(e);e=e.concat(a.splitLines(f));return{usernameFragment:e.filter(function(a){return 0===a.indexOf("a\x3dice-ufrag:")})[0].substr(12),password:e.filter(function(a){return 0===
a.indexOf("a\x3dice-pwd:")})[0].substr(10)}};a.writeIceParameters=function(a){return"a\x3dice-ufrag:"+a.usernameFragment+"\r\na\x3dice-pwd:"+a.password+"\r\n"};a.parseRtpParameters=function(e){for(var f={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},g=a.splitLines(e)[0].split(" "),d=3;d<g.length;d++){var c=g[d],h=a.matchPrefix(e,"a\x3drtpmap:"+c+" ")[0];if(h){var h=a.parseRtpMap(h),b=a.matchPrefix(e,"a\x3dfmtp:"+c+" ");h.parameters=b.length?a.parseFmtp(b[0]):{};h.rtcpFeedback=a.matchPrefix(e,
"a\x3drtcp-fb:"+c+" ").map(a.parseRtcpFb);f.codecs.push(h);switch(h.name.toUpperCase()){case "RED":case "ULPFEC":f.fecMechanisms.push(h.name.toUpperCase())}}}a.matchPrefix(e,"a\x3dextmap:").forEach(function(b){f.headerExtensions.push(a.parseExtmap(b))});return f};a.writeRtpDescription=function(e,f){var g="",g=g+("m\x3d"+e+" "),g=g+(0<f.codecs.length?"9":"0"),g=g+" UDP/TLS/RTP/SAVPF ",g=g+(f.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+
"\r\n"),g=g+"c\x3dIN IP4 0.0.0.0\r\n",g=g+"a\x3drtcp:9 IN IP4 0.0.0.0\r\n";f.codecs.forEach(function(c){g+=a.writeRtpMap(c);g+=a.writeFmtp(c);g+=a.writeRtcpFb(c)});var d=0;f.codecs.forEach(function(a){a.maxptime>d&&(d=a.maxptime)});0<d&&(g+="a\x3dmaxptime:"+d+"\r\n");g+="a\x3drtcp-mux\r\n";f.headerExtensions&&f.headerExtensions.forEach(function(c){g+=a.writeExtmap(c)});return g};a.parseRtpEncodingParameters=function(e){var f=[],g=a.parseRtpParameters(e),d=-1!==g.fecMechanisms.indexOf("RED"),c=-1!==
g.fecMechanisms.indexOf("ULPFEC"),h=a.matchPrefix(e,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"cname"===a.attribute}),b=0<h.length&&h[0].ssrc,k,h=a.matchPrefix(e,"a\x3dssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,10)})});0<h.length&&1<h[0].length&&h[0][0]===b&&(k=h[0][1]);g.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:b,codecPayloadType:parseInt(a.parameters.apt,10)},
b&&k&&(a.rtx={ssrc:k}),f.push(a),d&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:b,mechanism:c?"red+ulpfec":"red"},f.push(a)))});0===f.length&&b&&f.push({ssrc:b});var n=a.matchPrefix(e,"b\x3d");n.length&&(n=0===n[0].indexOf("b\x3dTIAS:")?parseInt(n[0].substr(7),10):0===n[0].indexOf("b\x3dAS:")?950*parseInt(n[0].substr(5),10)-16E3:void 0,f.forEach(function(a){a.maxBitrate=n}));return f};a.parseRtcpParameters=function(e){var f={},g=a.matchPrefix(e,"a\x3dssrc:").map(function(d){return a.parseSsrcMedia(d)}).filter(function(a){return"cname"===
a.attribute})[0];g&&(f.cname=g.value,f.ssrc=g.ssrc);g=a.matchPrefix(e,"a\x3drtcp-rsize");f.reducedSize=0<g.length;f.compound=0===g.length;e=a.matchPrefix(e,"a\x3drtcp-mux");f.mux=0<e.length;return f};a.parseMsid=function(e){var f=a.matchPrefix(e,"a\x3dmsid:");if(1===f.length)return e=f[0].substr(7).split(" "),{stream:e[0],track:e[1]};e=a.matchPrefix(e,"a\x3dssrc:").map(function(e){return a.parseSsrcMedia(e)}).filter(function(a){return"msid"===a.attribute});if(0<e.length)return e=e[0].value.split(" "),
{stream:e[0],track:e[1]}};a.generateSessionId=function(){return Math.random().toString().substr(2,21)};a.writeSessionBoilerplate=function(e,f,g){f=void 0!==f?f:2;e=e?e:a.generateSessionId();return"v\x3d0\r\no\x3d"+(g||"thisisadapterortc")+" "+e+" "+f+" IN IP4 127.0.0.1\r\ns\x3d-\r\nt\x3d0 0\r\n"};a.writeMediaSection=function(e,f,g,d){f=a.writeRtpDescription(e.kind,f);f+=a.writeIceParameters(e.iceGatherer.getLocalParameters());f+=a.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===
g?"actpass":"active");f+="a\x3dmid:"+e.mid+"\r\n";f=e.direction?f+("a\x3d"+e.direction+"\r\n"):e.rtpSender&&e.rtpReceiver?f+"a\x3dsendrecv\r\n":e.rtpSender?f+"a\x3dsendonly\r\n":e.rtpReceiver?f+"a\x3drecvonly\r\n":f+"a\x3dinactive\r\n";e.rtpSender&&(g="msid:"+d.id+" "+e.rtpSender.track.id+"\r\n",f=f+("a\x3d"+g)+("a\x3dssrc:"+e.sendEncodingParameters[0].ssrc+" "+g),e.sendEncodingParameters[0].rtx&&(f+="a\x3dssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+g,f+="a\x3dssrc-group:FID "+e.sendEncodingParameters[0].ssrc+
" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"));f+="a\x3dssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+a.localCName+"\r\n";e.rtpSender&&e.sendEncodingParameters[0].rtx&&(f+="a\x3dssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+a.localCName+"\r\n");return f};a.getDirection=function(e,f){e=a.splitLines(e);for(var g=0;g<e.length;g++)switch(e[g]){case "a\x3dsendrecv":case "a\x3dsendonly":case "a\x3drecvonly":case "a\x3dinactive":return e[g].substr(2)}return f?a.getDirection(f):"sendrecv"};
a.getKind=function(e){return a.splitLines(e)[0].split(" ")[0].substr(2)};a.isRejected=function(a){return"0"===a.split(" ",2)[1]};a.parseMLine=function(e){e=a.splitLines(e)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}};a.parseOLine=function(e){e=a.matchPrefix(e,"o\x3d")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}};a.isValidSDP=function(e){if("string"!==
typeof e||0===e.length)return!1;e=a.splitLines(e);for(var f=0;f<e.length;f++)if(2>e[f].length||"\x3d"!==e[f].charAt(1))return!1;return!0};"object"===typeof g&&(g.exports=a)},{}]},{},[1])(1)}()}])["default"];
//# sourceMappingURL=erizo.js.map
export default Erizo